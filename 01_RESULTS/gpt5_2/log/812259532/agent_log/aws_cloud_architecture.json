{
  "aws_architecture_description": "### Proposed high-level AWS architecture (ECS + ECR + Terraform)\n\n#### 1) Networking foundation\n- Create a dedicated **VPC** spanning **2+ Availability Zones** for high availability.\n- Use **public subnets** for internet-facing load balancers and **private subnets** for ECS tasks.\n- Add an **Internet Gateway** for inbound/outbound internet access to public subnets.\n- Add **NAT Gateway(s)** (one per AZ if you want AZ resilience) so ECS tasks in private subnets can reach the internet (e.g., to pull from ECR, call external APIs).\n- Use **VPC endpoints** (Interface endpoints) for **ECR (api + dkr)** and **CloudWatch Logs** to reduce NAT dependency and keep traffic private where possible.\n\n#### 2) Container registry (ECR)\n- Store the built Docker image in a **private Amazon ECR repository**.\n- Enable **image scanning** and configure **tag immutability** and an **ECR lifecycle policy** to reduce risk from stale images and control storage growth. ([docs.aws.amazon.com](https://docs.aws.amazon.com/securityhub/latest/userguide/ecr-controls.html?utm_source=openai))\n\n#### 3) Compute/runtime (ECS on Fargate)\n- Run the Node.js container as an **ECS Service** on **AWS Fargate** (recommended here because the app is simple and you don’t need to manage EC2 capacity).\n- Define an **ECS Task Definition** exposing **container port 3000**.\n- Configure the service with:\n  - **Desired count >= 2** across multiple AZs\n  - **Auto Scaling** based on CPU/Memory (and optionally ALB request count)\n  - **Rolling deployments** (or blue/green via CodeDeploy if you later want safer cutovers)\n\n#### 4) Ingress (public HTTP endpoint)\n- Put an **Application Load Balancer (ALB)** in public subnets.\n- ALB forwards traffic to the ECS service target group on **port 3000**.\n- Terminate TLS at the ALB using **ACM** certificates (HTTPS only), optionally redirect HTTP→HTTPS.\n- Use **Route 53** to map a domain name to the ALB.\n\n#### 5) Observability\n- Configure ECS task logging to **CloudWatch Logs** using the `awslogs` log driver. ([docs.aws.amazon.com](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/using_awslogs.html?utm_source=openai))\n- Add **CloudWatch Alarms** (e.g., 5xx from ALB, high latency, CPU/memory, task restarts) and optionally notify via **SNS**.\n\n#### 6) CI/CD and AWS access (GitHub Actions)\n- Keep the current flow: GitHub Actions builds the Docker image, pushes to ECR, then runs Terraform to update infrastructure and the ECS service.\n- Security improvement: replace long-lived IAM access keys in GitHub Secrets with **GitHub OIDC → AWS IAM Role** (short-lived credentials, least privilege). ([github.com](https://github.com/aws-actions/configure-aws-credentials?utm_source=openai))\n\n#### 7) State management for Terraform (recommended)\n- Store Terraform state in an **S3 bucket** with **DynamoDB** state locking to prevent concurrent apply corruption.\n\n---\n\n## AWS resources to provision\n\n### Core networking\n- Amazon VPC\n- Subnets (public x2+, private x2+ across AZs)\n- Internet Gateway\n- NAT Gateway(s) + Elastic IP(s)\n- Route tables (public + private) and route associations\n- Security Groups (ALB SG, ECS tasks SG)\n- (Recommended) VPC Interface Endpoints:\n  - com.amazonaws.<region>.ecr.api\n  - com.amazonaws.<region>.ecr.dkr\n  - com.amazonaws.<region>.logs\n  - (Optional) com.amazonaws.<region>.sts\n\n### Container registry\n- Amazon ECR private repository\n- ECR lifecycle policy\n- ECR image scanning configuration (basic/enhanced)\n- (Optional) KMS key for ECR encryption (if you require CMK)\n\n### Compute / orchestration\n- Amazon ECS Cluster\n- ECS Task Definition\n- ECS Service (Fargate launch type)\n- IAM Role: ECS Task Execution Role (pull from ECR, write logs)\n- IAM Role: ECS Task Role (app permissions; likely minimal/none for this app)\n- Application Auto Scaling target + scaling policies for ECS service\n\n### Load balancing / DNS / TLS\n- Application Load Balancer\n- ALB Target Group\n- ALB Listener(s) (HTTPS 443; optional HTTP 80 redirect)\n- AWS Certificate Manager (ACM) certificate\n- Amazon Route 53 hosted zone + DNS record (A/AAAA alias to ALB)\n\n### Logging / monitoring\n- CloudWatch Log Group(s) for ECS container logs\n- CloudWatch Alarms (ALB 5xx, latency, ECS CPU/memory, unhealthy hosts)\n- (Optional) SNS Topic + subscriptions for alarm notifications\n\n### CI/CD access + IaC state\n- IAM OIDC Identity Provider for GitHub (in IAM)\n- IAM Role for GitHub Actions (assume-role via OIDC) + least-privilege policy for ECR/ECS/Terraform needs\n- S3 bucket for Terraform remote state\n- DynamoDB table for Terraform state locking\n- (Optional) S3 bucket policy / KMS key for state encryption (if CMK required)\n\n### Optional hardening (only if needed)\n- AWS WAFv2 Web ACL associated to the ALB\n- AWS Secrets Manager / SSM Parameter Store (if you later add config/secrets)\n- AWS CloudTrail (if not already enabled at the account level)\n- AWS Config / Security Hub (if you have compliance requirements)",
  "aws_resources": [
    "Amazon VPC",
    "Public subnets (2+ AZs)",
    "Private subnets (2+ AZs)",
    "Internet Gateway",
    "NAT Gateway(s)",
    "Elastic IP(s) for NAT",
    "Public route table + routes + associations",
    "Private route table + routes + associations",
    "Security Group: ALB",
    "Security Group: ECS tasks",
    "VPC Interface Endpoint: ECR API",
    "VPC Interface Endpoint: ECR DKR",
    "VPC Interface Endpoint: CloudWatch Logs",
    "(Optional) VPC Interface Endpoint: STS",
    "Amazon ECR private repository",
    "ECR lifecycle policy",
    "ECR image scanning configuration",
    "(Optional) AWS KMS key for ECR encryption",
    "Amazon ECS Cluster",
    "ECS Task Definition",
    "ECS Service (Fargate)",
    "IAM Role: ECS Task Execution Role",
    "IAM Role: ECS Task Role",
    "Application Auto Scaling target (ECS service)",
    "Auto Scaling policies (CPU/Memory/ALB request count)",
    "Application Load Balancer (ALB)",
    "ALB Target Group",
    "ALB Listener: HTTPS 443",
    "(Optional) ALB Listener: HTTP 80 redirect to 443",
    "AWS Certificate Manager (ACM) certificate",
    "Amazon Route 53 hosted zone",
    "Route 53 record (ALIAS to ALB)",
    "CloudWatch Log Group(s)",
    "CloudWatch Alarms",
    "(Optional) SNS Topic + subscriptions",
    "IAM OIDC Provider (GitHub)",
    "IAM Role for GitHub Actions (OIDC assume role)",
    "IAM Policy for GitHub Actions role (least privilege)",
    "S3 bucket for Terraform remote state",
    "DynamoDB table for Terraform state locking",
    "(Optional) S3 bucket policy for state",
    "(Optional) AWS KMS key for Terraform state encryption",
    "(Optional) AWS WAFv2 Web ACL (ALB association)",
    "(Optional) AWS Secrets Manager / SSM Parameter Store",
    "(Optional) AWS CloudTrail",
    "(Optional) AWS Config",
    "(Optional) AWS Security Hub"
  ]
}