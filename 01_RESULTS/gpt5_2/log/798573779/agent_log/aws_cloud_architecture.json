{
  "aws_architecture_description": "## Proposed high-level AWS architecture (Static site in Nginx container on ECS Fargate with CI/CD)\n\n### 1) Networking & edge\n- **VPC across 2 Availability Zones** for high availability.\n- **Public subnets (2 AZs)** host the **internet-facing Application Load Balancer (ALB)**.\n- **Private subnets (2 AZs)** host **ECS Fargate tasks** (no public IPs).\n- **NAT Gateways** (one per AZ, or one to reduce cost) allow private tasks to reach **ECR** and other AWS APIs.\n- **VPC endpoints** (recommended) reduce NAT traffic and improve security:\n  - **ECR (api + dkr)**, **S3 (gateway endpoint)** (for ECR image layers), **CloudWatch Logs**, and optionally **Secrets Manager/SSM**.\n\n### 2) Runtime (serving the static site)\n- **Route 53** provides DNS (e.g., `www.example.com`) pointing to the ALB.\n- **ACM certificate** is attached to the ALB listener for **HTTPS**.\n- **ALB** terminates TLS and forwards to an **ALB Target Group**.\n- **ECS Cluster (Fargate)** runs an **ECS Service** with desired count (e.g., 2 tasks across AZs).\n- **ECS Task Definition** references the container image in **Amazon ECR** (built from `public.ecr.aws/nginx/nginx:latest` plus your static HTML).\n- **Security groups** enforce least privilege:\n  - ALB SG: allow inbound 443 from the internet; egress to ECS tasks on container port.\n  - ECS SG: allow inbound only from ALB SG on container port; egress to VPC endpoints/NAT.\n- **Auto Scaling**:\n  - ECS Service Auto Scaling based on CPU/Memory (and optionally ALB request count).\n\n### 3) Observability & operations\n- **CloudWatch Logs**: ECS task logs (nginx access/error) shipped to log groups.\n- **CloudWatch metrics/alarms**:\n  - ALB 5XX, target 5XX, unhealthy host count, latency.\n  - ECS service CPU/memory, task count.\n- **AWS CloudTrail** for audit logging of API activity.\n\n### 4) CI/CD (build and deploy)\n- **CodeCommit** hosts the source (HTML + Dockerfile + `buildspec.yml`).\n- **CodePipeline** stages:\n  1. **Source**: trigger on CodeCommit changes.\n  2. **Build**: **CodeBuild** builds the Docker image, tags it (e.g., commit SHA), and pushes to **ECR**.\n  3. **Deploy**: deploy to ECS by updating the task definition and forcing a new deployment (rolling update).\n- **Artifact store**: an **S3 bucket** for CodePipeline artifacts.\n- **IAM roles**:\n  - CodePipeline service role (access to CodeCommit, CodeBuild, ECS deploy actions, S3 artifacts).\n  - CodeBuild service role (push/pull to ECR, write logs, read source/artifacts).\n  - ECS task execution role (pull from ECR, write logs to CloudWatch).\n\n### 5) Security hardening (lean but best-practice)\n- **ECR image scanning** enabled (basic scanning) and lifecycle policy to expire old images.\n- **AWS WAF** (optional but recommended for internet-facing ALB) with managed rules.\n- **KMS** keys (optional) for encrypting S3 artifact bucket and ECR (if you require CMKs).\n\n---\n\n## Deployment strategy\n- **Rolling deployments** via ECS service (minimum healthy percent / maximum percent) so the site stays available during updates.\n- **Multi-AZ** ALB + ECS tasks for resilience.\n- **Private tasks** with controlled egress via endpoints/NAT.\n",
  "aws_resources": [
    "Amazon VPC",
    "VPC subnets (2 public, 2 private across 2 AZs)",
    "Internet Gateway (IGW)",
    "NAT Gateway(s)",
    "Route tables (public/private)",
    "Security Groups (ALB SG, ECS tasks SG)",
    "VPC Endpoints: Amazon S3 (Gateway Endpoint)",
    "VPC Endpoints: Amazon ECR (Interface Endpoint - api)",
    "VPC Endpoints: Amazon ECR (Interface Endpoint - dkr)",
    "VPC Endpoints: Amazon CloudWatch Logs (Interface Endpoint)",
    "(Optional) VPC Endpoints: AWS Secrets Manager / AWS Systems Manager",
    "Elastic Load Balancing: Application Load Balancer (internet-facing)",
    "ALB Listener (HTTPS :443)",
    "ALB Target Group",
    "AWS Certificate Manager (ACM) certificate",
    "Amazon Route 53 Hosted Zone + DNS record (Alias to ALB)",
    "Amazon ECS Cluster",
    "Amazon ECS Service (Fargate)",
    "Amazon ECS Task Definition",
    "AWS Fargate capacity (serverless compute for tasks)",
    "Amazon Elastic Container Registry (ECR) repository",
    "ECR lifecycle policy",
    "(Optional) ECR enhanced scanning / basic scanning configuration",
    "Amazon CloudWatch Log Group(s) for ECS task logs",
    "Amazon CloudWatch Alarms + Dashboards",
    "AWS Application Auto Scaling (ECS Service scaling policies/targets)",
    "AWS CodeCommit repository",
    "AWS CodeBuild project",
    "AWS CodePipeline pipeline",
    "Amazon S3 bucket for CodePipeline artifact store",
    "IAM Role: CodePipeline service role",
    "IAM Role: CodeBuild service role",
    "IAM Role: ECS task execution role",
    "IAM policies for least-privilege access (ECR, S3, logs, ECS deploy)",
    "AWS CloudTrail trail",
    "(Optional) AWS WAFv2 Web ACL associated to ALB",
    "(Optional) AWS KMS key(s) for S3/ECR encryption (CMK)"
  ]
}