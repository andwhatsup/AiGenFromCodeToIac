{
  "aws_architecture_description": "### Target AWS architecture (lean, secure, scalable)\n\n#### 1) Networking foundation\n- Deploy into a dedicated **VPC** spanning **2 Availability Zones** for high availability.\n- Create **public subnets** (for internet-facing load balancers and NAT) and **private subnets** (for EKS worker nodes and CI/CD compute).\n- Use an **Internet Gateway** for inbound/outbound public traffic and **NAT Gateways** (one per AZ, or one to be lean) so private subnets can reach the internet for patching and pulling images.\n\n#### 2) Container runtime: Amazon EKS (Kubernetes)\n- Replace the existing “Kubernetes cluster + NodePort” runtime with **Amazon EKS**.\n- Run the Tomcat-based container as a **Kubernetes Deployment** on EKS.\n- Replace the NodePort exposure with an **Application Load Balancer (ALB)** using the **AWS Load Balancer Controller**:\n  - End users access the app via **ALB (HTTP/HTTPS)**.\n  - ALB routes to a Kubernetes **Service (ClusterIP)** / **Ingress** which forwards to Pods.\n- Use **Managed Node Groups** (EC2) in private subnets.\n- Enable **Cluster Autoscaler / Karpenter** (optional) and **Horizontal Pod Autoscaler** for scaling.\n\n#### 3) Container registry: Amazon ECR\n- Replace Docker Hub with **Amazon ECR**.\n- Jenkins (or a managed pipeline) builds the image and pushes to ECR.\n- EKS pulls images from ECR using **IRSA** (IAM Roles for Service Accounts) and node IAM permissions.\n\n#### 4) CI/CD: keep Jenkins, but run it on AWS\nTwo lean options; pick one:\n\n**Option A (simplest lift-and-shift): Jenkins on EC2**\n- Run a small **Jenkins controller** on an EC2 instance in a private subnet.\n- Use either:\n  - Jenkins agents on the same instance (small workloads), or\n  - **ephemeral agents** (EC2 or Kubernetes-based agents in EKS) for builds.\n- Store Jenkins state on **EBS** (or EFS if you want multi-AZ later).\n\n**Option B (more managed): AWS CodePipeline/CodeBuild**\n- Replace Jenkins with **CodePipeline + CodeBuild**:\n  - Source: GitHub connection\n  - Build: Maven build + Docker build\n  - Push: ECR\n  - Deploy: kubectl/Helm to EKS\n\nGiven your repo already has a Jenkinsfile and webhook, **Option A** is the most direct migration.\n\n#### 5) Secrets, configuration, and logging/monitoring\n- Store sensitive values (registry creds if needed, app secrets) in **AWS Secrets Manager**.\n- Store non-secret config in **SSM Parameter Store** or Kubernetes ConfigMaps.\n- Send container logs to **CloudWatch Logs** via Fluent Bit/Container Insights.\n- Use **CloudWatch metrics/alarms** for ALB, EKS nodes, and application health.\n- Enable **AWS CloudTrail** for audit logging.\n\n#### 6) TLS and DNS (recommended)\n- Use **ACM** to issue TLS certificates.\n- Use **Route 53** to map a domain (e.g., app.example.com) to the ALB.\n\n#### 7) Security posture\n- Private subnets for compute; only ALB is public.\n- Security groups:\n  - ALB SG allows inbound 80/443 from the internet.\n  - EKS node SG allows inbound only from ALB SG to the app port.\n  - Jenkins SG allows inbound only from your corporate IP/VPN (or via SSM Session Manager).\n- Use **IAM least privilege** and **IRSA** for Kubernetes workloads.\n\n---\n\n### Request flow (runtime)\n1. End user → Route 53 DNS → ALB (HTTPS)\n2. ALB → EKS Ingress/Service → Tomcat Pods\n3. Pods pull image from ECR; logs/metrics go to CloudWatch\n\n### Delivery flow (CI/CD)\n1. Developer pushes to GitHub\n2. GitHub webhook triggers Jenkins (on EC2)\n3. Jenkins runs Maven tests/package → builds Docker image → pushes to ECR\n4. Jenkins deploys to EKS (kubectl apply / Helm upgrade)\n\n---\n\n### Notes specific to your codebase\n- Your dependencies include **Log4j 2.5**, which is very old; plan to upgrade as part of hardening.\n- Tomcat 8.0 is also old; consider moving to a supported Tomcat/JDK baseline when feasible.\n",
  "aws_resources": [
    "VPC",
    "Public subnets (2 AZs)",
    "Private subnets (2 AZs)",
    "Internet Gateway",
    "NAT Gateway(s)",
    "Route tables (public/private)",
    "Security Groups (ALB, EKS nodes, Jenkins)",
    "Network ACLs (optional)",
    "VPC Endpoints (recommended: ECR api, ECR dkr, S3, CloudWatch Logs, SSM)",
    "Amazon EKS Cluster",
    "EKS Managed Node Group(s) (EC2)",
    "IAM Role for EKS Cluster",
    "IAM Role(s) for EKS Node Group(s)",
    "IAM OIDC Provider for EKS (for IRSA)",
    "Kubernetes Namespace(s)",
    "Kubernetes Deployment (Tomcat app)",
    "Kubernetes Service (ClusterIP)",
    "Kubernetes Ingress",
    "AWS Load Balancer Controller (EKS add-on/Helm)",
    "Application Load Balancer (created by controller)",
    "Target Group(s) (created by controller)",
    "ACM Certificate (TLS)",
    "Amazon Route 53 Hosted Zone and Record (A/ALIAS to ALB)",
    "Amazon ECR Repository",
    "IAM roles/policies for CI to push to ECR",
    "EC2 Instance for Jenkins controller (Option A)",
    "EBS Volume for Jenkins home (Option A)",
    "IAM Instance Profile/Role for Jenkins EC2 (ECR push, EKS deploy, SSM)",
    "AWS Systems Manager (SSM) Managed Instance + Session Manager access",
    "AWS Secrets Manager (store GitHub token/webhook secret, any app secrets)",
    "SSM Parameter Store (non-secret config)",
    "Amazon CloudWatch Log Groups (EKS workloads, Jenkins)",
    "CloudWatch Alarms (ALB 5xx, target health, node CPU/mem, etc.)",
    "AWS CloudTrail",
    "AWS KMS Key(s) (encrypt EBS, Secrets Manager, ECR, CloudWatch Logs as needed)"
  ]
}