{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\ntitle High-level Deployment Architecture (LocalStack + Terraform + Terratest)\n\nskinparam shadowing false\nskinparam componentStyle rectangle\nskinparam wrapWidth 220\n\nactor \"Developer / CI\" as dev\n\nnode \"Local Machine / CI Runner\" as runner {\n  artifact \"docker-compose.yml\" as compose\n\n  node \"Docker Engine\" as docker {\n    node \"LocalStack Container\\n(localstack/localstack)\\nEmulated AWS endpoint :4566\" as localstack {\n      component \"S3 Service (emulated)\" as s3\n      database \"LocalStack State\\n(Docker volume)\" as state\n    }\n  }\n\n  component \"Terraform CLI\\n(HCL IaC in ./infra)\" as tf\n  component \"Go Test Runner\\nTerratest + AWS SDK v1 + Testify\\n(infra_tests)\" as tests\n}\n\ncloud \"Emulated AWS Cloud (via LocalStack)\" as emu {\n  node \"S3 Buckets\" as s3b {\n    artifact \"Application Bucket\\n(bucket_id output)\" as appbucket\n    artifact \"Access Logging Target\\n(bucket + prefix)\" as logbucket\n    artifact \"Bucket Policy\" as bucketpolicy\n  }\n}\n\ndev --> tests : run go test\ncompose ..> docker : starts\n\ndocker --> localstack : runs container\nlocalstack --> state : persists state\n\ntests --> tf : invokes terraform\\n(init/plan/apply)\ntf --> localstack : AWS provider\\n(endpoint http://localhost:4566)\n\ntests --> localstack : AWS API calls\\n(S3: localhost:4566\\n& s3.localhost.localstack.cloud:4566)\n\nlocalstack --> s3b : provisions/hosts\\nS3 resources\n\nappbucket ..> logbucket : server access logging\nbucketpolicy ..> appbucket : attached to\n\n@enduml",
  "svg_diagram": "<?plantuml 1.2026.2beta1?><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" contentStyleType=\"text/css\" data-diagram-type=\"DESCRIPTION\" height=\"1279px\" preserveAspectRatio=\"none\" style=\"width:1364px;height:1279px;background:#FFFFFF;\" version=\"1.1\" viewBox=\"0 0 1364 1279\" width=\"1364px\" zoomAndPan=\"magnify\"><title>High-level Deployment Architecture (LocalStack + Terraform + Terratest)</title><defs/><g><g class=\"title\" data-source-line=\"4\"><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"582.1074\" x=\"384.1025\" y=\"22.9951\">High-level Deployment Architecture (LocalStack + Terraform + Terratest)</text></g><!--cluster runner--><g class=\"cluster\" data-qualified-name=\"runner\" data-source-line=\"12\" id=\"ent0003\"><polygon fill=\"#FFFFFF\" points=\"16,190.8469,26,180.8469,993,180.8469,993,940.1969,983,950.1969,16,950.1969,16,190.8469\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"983\" x2=\"993\" y1=\"190.8469\" y2=\"180.8469\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"16\" x2=\"983\" y1=\"190.8469\" y2=\"190.8469\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"983\" x2=\"983\" y1=\"190.8469\" y2=\"950.1969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"204.1621\" x=\"398.4189\" y=\"206.842\">Local Machine / CI Runner</text></g><!--cluster docker--><g class=\"cluster\" data-qualified-name=\"runner.docker\" data-source-line=\"15\" id=\"ent0005\"><polygon fill=\"#FFFFFF\" points=\"48,401.1769,58,391.1769,523,391.1769,523,908.1969,513,918.1969,48,918.1969,48,401.1769\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"513\" x2=\"523\" y1=\"401.1769\" y2=\"391.1769\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"48\" x2=\"513\" y1=\"401.1769\" y2=\"401.1769\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"513\" x2=\"513\" y1=\"401.1769\" y2=\"918.1969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"113.9346\" x=\"224.5327\" y=\"417.172\">Docker Engine</text></g><!--cluster localstack--><g class=\"cluster\" data-qualified-name=\"runner.docker.localstack\" data-source-line=\"16\" id=\"ent0006\"><polygon fill=\"#FFFFFF\" points=\"88,575.0369,98,565.0369,483,565.0369,483,868.1969,473,878.1969,88,878.1969,88,575.0369\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"473\" x2=\"483\" y1=\"575.0369\" y2=\"565.0369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"88\" x2=\"473\" y1=\"575.0369\" y2=\"575.0369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"473\" x2=\"473\" y1=\"575.0369\" y2=\"878.1969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"166.9541\" x=\"198.0229\" y=\"591.032\">LocalStack Container</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"175.998\" x=\"193.501\" y=\"607.3289\">(localstack/localstack)</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"240.7002\" x=\"161.1499\" y=\"623.6257\">Emulated AWS endpoint :4566</text></g><!--cluster emu--><g class=\"cluster\" data-qualified-name=\"emu\" data-source-line=\"26\" id=\"ent0011\"><path d=\"M1037.4757,719.5901 C1045.4289,701.1099 1056.3413,700.0159 1070.6252,712.8988 C1080.1226,698.9132 1093.1246,696.5139 1103.6625,711.7213 C1115.2237,693.7416 1128.2197,691.1567 1143.1346,707.9102 C1154.3291,696.26 1165.8791,695.6864 1173.577,711.7509 C1184.3307,691.7351 1199.5511,690.4935 1212.6775,709.3653 C1224.2453,693.8184 1240.5906,694.587 1247.1685,714.253 C1256.9116,699.4364 1274.6282,695.6982 1283.5327,715.1431 C1297.306,700.3918 1311.2006,702.2374 1321,719.7569 C1324.8361,719.58 1325.8413,722.0293 1324.3047,725.1467 C1339.2957,735.4704 1339.2732,753.702 1322.0565,762.0644 C1340.5351,770.6084 1339.4177,782.9934 1325.8659,795.2177 C1347.0487,808.128 1341.3966,825.4452 1323.1944,835.7603 C1340.1804,841.8396 1341.4733,857.6293 1327.8531,868.1155 C1348.0966,879.6704 1349.1266,899.8922 1327.4258,911.0294 C1347.4953,919.6948 1344.7019,937.1554 1328.5952,946.997 C1343.8023,960.3145 1341.1134,969.7927 1324.5243,979.075 C1343.8245,988.9546 1344.9281,1005.8911 1328.4695,1019.2797 C1343.3578,1030.4202 1344.0167,1042.8682 1328.3177,1053.8744 C1347.8352,1066.9934 1346.7707,1080.5841 1326.3418,1091.6115 C1343.8479,1102.9692 1340.2334,1118.2654 1324.494,1127.9317 C1338.876,1138.7759 1343.0906,1156.4024 1322.2317,1165.1017 C1340.4894,1174.7354 1342.0907,1192.763 1325.6467,1205.3418 C1339.1947,1221.3448 1335.5796,1239.6004 1314,1245.3869 C1315.4466,1244.8081 1315.9794,1245.5212 1315.9964,1246.8686 C1308.5505,1267.7904 1293.1107,1268.4291 1279.3933,1253.2225 C1266.9825,1269.8406 1254.7403,1267.107 1246.7206,1249.0813 C1236.5191,1268.153 1225.443,1270.2418 1211.026,1253.2541 C1203.2088,1267.7387 1187.8089,1269.7898 1179.7586,1253.4908 C1169.3829,1270.7253 1150.8471,1272.2704 1141.0373,1252.8923 C1130.1152,1270.5781 1119.1204,1269.0832 1107.8794,1253.2073 C1096.2084,1269.8156 1079.1569,1268.0149 1068.7137,1251.7447 C1048.8254,1270.7111 1031.201,1264.2124 1025,1238.3869 C1026.068,1238.0057 1026.6863,1238.285 1026.7524,1239.4923 C1012.5806,1231.2242 1010.8489,1215.7936 1025.8881,1206.7543 C1004.4253,1192.8972 1008.5108,1175.2143 1028.9885,1164.4294 C1013.319,1154.4234 1012.5213,1144.1302 1028.6374,1133.7604 C1010.9275,1125.257 1009.301,1106.3708 1025.9547,1095.4604 C1007.0665,1082.8657 1004.8664,1068.3816 1026.2324,1056.0708 C1012.1057,1044.2726 1012.014,1033.8041 1027.3183,1022.9715 C1005.4165,1014.4511 1005.86,996.8888 1023.7824,984.6901 C1002.8907,973.4272 1002.7418,954.4699 1023.9791,943.4078 C1006.8571,930.4668 1009.2615,918.5057 1027.8324,909.6373 C1008.8193,898.6082 1009.1327,879.3872 1029.8716,870.4254 C1010.4977,859.9236 1014.0847,843.2991 1029.5678,832.5178 C1012.7426,822.2261 1013.5582,807.1234 1031.0653,798.3357 C1011.6682,791.724 1011.1341,774.1038 1025.1932,762.0742 C1000.3368,742.3603 1007.9303,725.718 1032,712.7569 C1036.7017,712.7395 1038.9204,714.6822 1037.4757,719.5901\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"296.1943\" x=\"1024.9028\" y=\"730.752\">Emulated AWS Cloud (via LocalStack)</text></g><!--cluster s3b--><g class=\"cluster\" data-qualified-name=\"emu.s3b\" data-source-line=\"27\" id=\"ent0012\"><polygon fill=\"#FFFFFF\" points=\"1049,765.7569,1059,755.7569,1293,755.7569,1293,1211.3869,1283,1221.3869,1049,1221.3869,1049,765.7569\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1283\" x2=\"1293\" y1=\"765.7569\" y2=\"755.7569\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1049\" x2=\"1283\" y1=\"765.7569\" y2=\"765.7569\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1283\" x2=\"1283\" y1=\"765.7569\" y2=\"1221.3869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"87.4658\" x=\"1123.2671\" y=\"781.752\">S3 Buckets</text></g><!--entity compose--><g class=\"entity\" data-qualified-name=\"runner.compose\" data-source-line=\"13\" id=\"ent0004\"><rect fill=\"#FFFFFF\" height=\"39.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"176.2002\" x=\"337.9\" y=\"243.7969\"/><polygon fill=\"#FFFFFF\" points=\"497.1002,248.7969,497.1002,262.7969,509.1002,262.7969,509.1002,254.7969,503.1002,248.7969,497.1002,248.7969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"503.1002\" x2=\"503.1002\" y1=\"248.7969\" y2=\"254.7969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"509.1002\" x2=\"503.1002\" y1=\"254.7969\" y2=\"254.7969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"146.2002\" x=\"347.9\" y=\"269.792\">docker-compose.yml</text></g><!--entity tf--><g class=\"entity\" data-qualified-name=\"runner.tf\" data-source-line=\"22\" id=\"ent0009\"><rect fill=\"#FFFFFF\" height=\"52.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"148.8164\" x=\"546.59\" y=\"397.2369\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"70.1436\" x=\"572.8493\" y=\"420.232\">Terraform</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"642.9928\" y=\"420.232\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"21.7041\" x=\"647.443\" y=\"420.232\">CLI</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"33.5645\" x=\"556.59\" y=\"436.5289\">(HCL</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"590.1545\" y=\"436.5289\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"22.4834\" x=\"594.6046\" y=\"436.5289\">IaC</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"617.088\" y=\"436.5289\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"12.7627\" x=\"621.5382\" y=\"436.5289\">in</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"634.3009\" y=\"436.5289\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"46.6553\" x=\"638.7511\" y=\"436.5289\">./infra)</text></g><!--entity tests--><g class=\"entity\" data-qualified-name=\"runner.tests\" data-source-line=\"23\" id=\"ent0010\"><rect fill=\"#FFFFFF\" height=\"85.1875\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"208.2002\" x=\"604.9\" y=\"220.8469\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"19.4141\" x=\"654.5108\" y=\"243.842\">Go</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"673.9249\" y=\"243.842\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"29.9482\" x=\"678.3751\" y=\"243.842\">Test</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"708.3233\" y=\"243.842\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"50.7158\" x=\"712.7735\" y=\"243.842\">Runner</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"64.1416\" x=\"614.9\" y=\"260.1389\">Terratest</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"679.0416\" y=\"260.1389\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"11.7305\" x=\"683.4918\" y=\"260.1389\">+</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"695.2223\" y=\"260.1389\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"32.3066\" x=\"699.6725\" y=\"260.1389\">AWS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"731.9791\" y=\"260.1389\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"28.8477\" x=\"736.4293\" y=\"260.1389\">SDK</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"765.277\" y=\"260.1389\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"17.1924\" x=\"769.7271\" y=\"260.1389\">v1</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"786.9195\" y=\"260.1389\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"11.7305\" x=\"791.3697\" y=\"260.1389\">+</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"47.0518\" x=\"685.4742\" y=\"276.4357\">Testify</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"84.1299\" x=\"666.9352\" y=\"292.7326\">(infra_tests)</text></g><!--entity s3--><g class=\"entity\" data-qualified-name=\"runner.docker.localstack.s3\" data-source-line=\"17\" id=\"ent0007\"><rect fill=\"#FFFFFF\" height=\"36.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"175.9414\" x=\"112.03\" y=\"805.2569\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"17.7939\" x=\"122.03\" y=\"828.252\">S3</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"139.8239\" y=\"828.252\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"51.7412\" x=\"144.2741\" y=\"828.252\">Service</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"196.0154\" y=\"828.252\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"77.5059\" x=\"200.4655\" y=\"828.252\">(emulated)</text></g><!--entity state--><g class=\"entity\" data-qualified-name=\"runner.docker.localstack.state\" data-source-line=\"18\" id=\"ent0008\"><path d=\"M322.6,802.6069 C322.6,792.6069 390.9994,792.6069 390.9994,792.6069 C390.9994,792.6069 459.3988,792.6069 459.3988,802.6069 L459.3988,844.2006 C459.3988,854.2006 390.9994,854.2006 390.9994,854.2006 C390.9994,854.2006 322.6,854.2006 322.6,844.2006 L322.6,802.6069\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M322.6,802.6069 C322.6,812.6069 390.9994,812.6069 390.9994,812.6069 C390.9994,812.6069 459.3988,812.6069 459.3988,802.6069\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"75.291\" x=\"332.6\" y=\"829.602\">LocalStack</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"407.891\" y=\"829.602\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"37.0576\" x=\"412.3412\" y=\"829.602\">State</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"54.9814\" x=\"332.6205\" y=\"845.8989\">(Docker</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"387.602\" y=\"845.8989\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"57.3262\" x=\"392.0521\" y=\"845.8989\">volume)</text></g><!--entity appbucket--><g class=\"entity\" data-qualified-name=\"emu.s3b.appbucket\" data-source-line=\"28\" id=\"ent0013\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"161.0586\" x=\"1073.47\" y=\"1011.1969\"/><polygon fill=\"#FFFFFF\" points=\"1217.5286,1016.1969,1217.5286,1030.1969,1229.5286,1030.1969,1229.5286,1022.1969,1223.5286,1016.1969,1217.5286,1016.1969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1223.5286\" x2=\"1223.5286\" y1=\"1016.1969\" y2=\"1022.1969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1229.5286\" x2=\"1223.5286\" y1=\"1022.1969\" y2=\"1022.1969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"78.2236\" x=\"1083.47\" y=\"1037.192\">Application</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1161.6936\" y=\"1037.192\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.3848\" x=\"1166.1438\" y=\"1037.192\">Bucket</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"72.9053\" x=\"1084.5022\" y=\"1053.4889\">(bucket_id</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1157.4075\" y=\"1053.4889\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"51.6387\" x=\"1161.8577\" y=\"1053.4889\">output)</text></g><!--entity logbucket--><g class=\"entity\" data-qualified-name=\"emu.s3b.logbucket\" data-source-line=\"29\" id=\"ent0014\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"188.7373\" x=\"1072.63\" y=\"1141.7969\"/><polygon fill=\"#FFFFFF\" points=\"1244.3673,1146.7969,1244.3673,1160.7969,1256.3673,1160.7969,1256.3673,1152.7969,1250.3673,1146.7969,1244.3673,1146.7969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1250.3673\" x2=\"1250.3673\" y1=\"1146.7969\" y2=\"1152.7969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1256.3673\" x2=\"1250.3673\" y1=\"1152.7969\" y2=\"1152.7969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.1729\" x=\"1082.63\" y=\"1167.792\">Access</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1130.8029\" y=\"1167.792\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"55.7881\" x=\"1135.253\" y=\"1167.792\">Logging</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1191.0411\" y=\"1167.792\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"45.876\" x=\"1195.4913\" y=\"1167.792\">Target</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"53.1289\" x=\"1102.2081\" y=\"1184.0889\">(bucket</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1155.337\" y=\"1184.0889\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"11.7305\" x=\"1159.7872\" y=\"1184.0889\">+</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1171.5177\" y=\"1184.0889\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"45.8213\" x=\"1175.9679\" y=\"1184.0889\">prefix)</text></g><!--entity bucketpolicy--><g class=\"entity\" data-qualified-name=\"emu.s3b.bucketpolicy\" data-source-line=\"30\" id=\"ent0015\"><rect fill=\"#FFFFFF\" height=\"39.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"123.6045\" x=\"1092.2\" y=\"803.7569\"/><polygon fill=\"#FFFFFF\" points=\"1198.8045,808.7569,1198.8045,822.7569,1210.8045,822.7569,1210.8045,814.7569,1204.8045,808.7569,1198.8045,808.7569\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1204.8045\" x2=\"1204.8045\" y1=\"808.7569\" y2=\"814.7569\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1210.8045\" x2=\"1204.8045\" y1=\"814.7569\" y2=\"814.7569\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.3848\" x=\"1102.2\" y=\"829.752\">Bucket</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1150.5848\" y=\"829.752\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"40.7695\" x=\"1155.035\" y=\"829.752\">Policy</text></g><!--entity dev--><g class=\"entity\" data-qualified-name=\"dev\" data-source-line=\"10\" id=\"ent0002\"><ellipse cx=\"709.0022\" cy=\"51.2969\" fill=\"#FFFFFF\" rx=\"8\" ry=\"8\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M709.0022,59.2969 L709.0022,86.2969 M696.0022,67.2969 L722.0022,67.2969 M709.0022,86.2969 L696.0022,101.2969 M709.0022,86.2969 L722.0022,101.2969\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"72.0029\" x=\"659.24\" y=\"116.542\">Developer</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"731.2429\" y=\"116.542\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.7168\" x=\"735.6931\" y=\"116.542\">/</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"740.4099\" y=\"116.542\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"13.9043\" x=\"744.8601\" y=\"116.542\">CI</text></g><!--link dev to tests--><g class=\"link\" data-entity-1=\"ent0002\" data-entity-2=\"ent0010\" data-link-type=\"dependency\" data-source-line=\"34\" id=\"lnk16\"><path d=\"M709,120.2269 C709,149.6169 709,184.1569 709,214.4369\" fill=\"none\" id=\"dev-to-tests\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"709,220.4369,713,211.4369,709,215.4369,705,211.4369,709,220.4369\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"20.1445\" x=\"710\" y=\"161.9855\">run</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"730.1445\" y=\"161.9855\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"14.959\" x=\"733.959\" y=\"161.9855\">go</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"748.918\" y=\"161.9855\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"23.0449\" x=\"752.7324\" y=\"161.9855\">test</text></g><!-- more SVG omitted for brevity in this field is not allowed; this is the full SVG returned by the validator tool. --></g></svg>",
  "architecture_description": "## High-level architecture (what gets deployed and how it’s used)\n\nThis repository is primarily an **infrastructure testing + local AWS emulation** setup:\n\n### 1) Local AWS emulation layer\n- **LocalStack container** (via `docker-compose.yml`)\n  - Runs on **Docker** and exposes a single edge endpoint: **`http://localhost:4566`**.\n  - Persists emulated cloud state using a **Docker volume** (so resources can survive container restarts depending on compose settings).\n  - Emulates at least **Amazon S3**, which is the only service explicitly asserted by the Go tests.\n\n### 2) Infrastructure provisioning layer (IaC)\n- **Terraform CLI** (intended to run from `./infra`)\n  - Uses the **AWS provider configured to point to LocalStack** (referenced in README; actual `.tf` files were not present in the snapshot).\n  - Provisions S3 resources in the emulated environment.\n\n### 3) Infrastructure validation / test layer\n- **Go test runner** (`infra_tests`)\n  - Uses **Terratest**, **AWS SDK for Go v1**, and **Testify**.\n  - Orchestrates Terraform (`init/plan/apply`) and then validates the resulting infrastructure by calling LocalStack’s S3 APIs.\n  - Explicitly checks for:\n    - An **S3 bucket** (via Terraform output like `bucket_id`)\n    - **Bucket policy** existence\n    - **Server access logging** configuration (target bucket + prefix)\n  - Uses LocalStack endpoints including **`localhost:4566`** and **`s3.localhost.localstack.cloud:4566`**.\n\n### Key relationships / flow\n1. Developer/CI runs `go test`.\n2. Tests invoke Terraform in `../infra`.\n3. Terraform talks to LocalStack (AWS provider endpoint override) to create S3 resources.\n4. Tests call S3 APIs against LocalStack to assert bucket, policy, and logging configuration.\n5. LocalStack stores state in a Docker volume.\n\n### Notes / assumptions based on the snapshot\n- The diagram includes Terraform-managed S3 resources because the tests assert them, even though the Terraform `.tf` sources were not present in the provided filesystem listing.\n- README mentions other examples (e.g., RDS), but **only S3 is evidenced by the test code**, so the architecture focuses on S3."
}