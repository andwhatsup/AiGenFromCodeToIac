{
  "aws_architecture_description": "### What this repo is (and what “deploying it” means)\nThis repository is not an application runtime; it’s an **infrastructure-as-code + infrastructure test harness**. In LocalStack, Terraform creates S3 resources and Go/Terratest validates them. In real AWS, the equivalent “deployment” is:\n1) **Provision real AWS S3 infrastructure with Terraform** (instead of LocalStack endpoints).\n2) **Run Terratest in CI** against an AWS account to validate the infrastructure.\n\nSo the AWS architecture is primarily:\n- **A CI runner** (e.g., GitHub Actions / CodeBuild) that runs Terraform and Go tests.\n- **An S3 “application bucket”** with **bucket policy** and **server access logging enabled**.\n- **A separate S3 “log bucket”** that receives access logs.\n- **IAM roles/policies** for Terraform and for the test runner.\n- **State management for Terraform** (S3 backend + DynamoDB lock table) so the infrastructure can be safely managed in a team/CI environment.\n\n---\n\n## High-level AWS architecture (production AWS)\n\n### 1) CI / execution layer\n- A CI job (recommended: **AWS CodeBuild** for tight AWS integration, or GitHub Actions with OIDC) runs:\n  - `terraform init/plan/apply` in `./infra`\n  - `go test ./...` in `./infra_tests`\n- The CI job assumes an **IAM role** with least-privilege permissions to:\n  - manage the S3 buckets/policies/logging\n  - read/write Terraform state\n  - (optionally) write test artifacts/logs\n\n### 2) Terraform state layer (recommended best practice)\n- Terraform uses a **remote backend**:\n  - **S3 bucket** for state files\n  - **DynamoDB table** for state locking\n- This prevents concurrent applies and avoids local state drift.\n\n### 3) S3 infrastructure under test (what Terratest validates)\n- **Application S3 bucket**\n  - Versioning enabled (recommended)\n  - Default encryption enabled (SSE-S3 or SSE-KMS)\n  - Public access blocked\n  - Bucket policy attached (as required by your tests)\n  - **Server access logging enabled** pointing to the log bucket + prefix\n\n- **Access log target S3 bucket**\n  - Dedicated bucket to receive access logs\n  - Bucket policy allowing the S3 logging delivery mechanism to write logs\n  - Lifecycle policy (recommended) to expire/transition old logs\n\n### 4) Observability / audit\n- **CloudTrail** (recommended) to record S3 API activity at the account level.\n- **CloudWatch Logs** for CI job logs (if using CodeBuild).\n\n---\n\n## AWS resources to provision\n\n### Core S3 resources (the “system” being validated)\n- **AWS::S3::Bucket** – Application bucket\n- **AWS::S3::BucketPolicy** – Application bucket policy\n- **AWS::S3::Bucket** – Access logging target bucket\n- **AWS::S3::BucketPolicy** – Log bucket policy (allow log delivery)\n- **AWS::S3::BucketLifecycleConfiguration** – Log retention/transition (recommended)\n- **AWS::S3::PublicAccessBlock** – For both buckets (recommended)\n- **AWS::S3::BucketEncryption** – For both buckets (recommended)\n- **AWS::S3::BucketVersioning** – For both buckets (recommended)\n\n### Terraform state (recommended for real AWS)\n- **AWS::S3::Bucket** – Terraform state bucket\n- **AWS::S3::PublicAccessBlock** – State bucket\n- **AWS::S3::BucketEncryption** – State bucket\n- **AWS::S3::BucketVersioning** – State bucket\n- **AWS::DynamoDB::Table** – Terraform state lock table\n\n### IAM / security\n- **AWS::IAM::Role** – CI/Terraform execution role\n- **AWS::IAM::Policy** (or inline policies) – Permissions for:\n  - s3:CreateBucket/DeleteBucket/PutBucketPolicy/PutBucketLogging/GetBucketLogging/etc.\n  - dynamodb:* (limited to lock table operations)\n  - sts:AssumeRole (if using role chaining)\n- **AWS::KMS::Key** – (optional) if you choose SSE-KMS instead of SSE-S3\n- **AWS::KMS::Alias** – (optional) for the KMS key\n\n### CI runner (choose one)\n**Option A (AWS-native):**\n- **AWS::CodeBuild::Project** – Runs Terraform + Go tests\n- **AWS::CodeBuild::SourceCredential / Webhook** – (as needed)\n- **AWS::S3::Bucket** – (optional) build artifacts bucket\n- **AWS::CloudWatch::LogGroup** – Build logs\n\n**Option B (GitHub Actions):**\n- **AWS::IAM::OpenIDConnectProvider** – GitHub OIDC provider\n- **AWS::IAM::Role** – Role assumable by GitHub Actions via OIDC\n\n### Audit / monitoring (recommended)\n- **AWS::CloudTrail::Trail** – Account audit trail (often centralized)\n- **AWS::S3::Bucket** – CloudTrail log bucket (if not already existing centrally)\n\n---\n\n### Notes / assumptions\n- No VPC/EC2/RDS is required for what’s evidenced in the tests (S3-only). If you later add the README’s RDS example for real, you’d introduce VPC subnets, security groups, RDS, Secrets Manager, etc.\n- The “LocalStack container” is not part of the AWS deployment; it’s replaced by real AWS services, and the tests run from CI against AWS endpoints.",
  "aws_resources": [
    "AWS::S3::Bucket – Application bucket",
    "AWS::S3::BucketPolicy – Application bucket policy",
    "AWS::S3::Bucket – Access logging target bucket",
    "AWS::S3::BucketPolicy – Log bucket policy (allow log delivery)",
    "AWS::S3::BucketLifecycleConfiguration – Log retention/transition (recommended)",
    "AWS::S3::PublicAccessBlock – For application and log buckets (recommended)",
    "AWS::S3::BucketEncryption – For application and log buckets (recommended)",
    "AWS::S3::BucketVersioning – For application and log buckets (recommended)",
    "AWS::S3::Bucket – Terraform state bucket (recommended)",
    "AWS::S3::PublicAccessBlock – Terraform state bucket",
    "AWS::S3::BucketEncryption – Terraform state bucket",
    "AWS::S3::BucketVersioning – Terraform state bucket",
    "AWS::DynamoDB::Table – Terraform state lock table (recommended)",
    "AWS::IAM::Role – CI/Terraform execution role",
    "AWS::IAM::Policy – Least-privilege permissions for S3 + state backend",
    "AWS::KMS::Key – Optional (if using SSE-KMS)",
    "AWS::KMS::Alias – Optional (if using SSE-KMS)",
    "AWS::CodeBuild::Project – Optional (if using AWS-native CI)",
    "AWS::CloudWatch::LogGroup – Optional (for CodeBuild logs)",
    "AWS::S3::Bucket – Optional (CodeBuild artifacts bucket)",
    "AWS::IAM::OpenIDConnectProvider – Optional (if using GitHub Actions OIDC)",
    "AWS::IAM::Role – Optional (GitHub Actions assumable role)",
    "AWS::CloudTrail::Trail – Recommended audit logging",
    "AWS::S3::Bucket – Optional (CloudTrail log bucket, if not centralized)"
  ]
}