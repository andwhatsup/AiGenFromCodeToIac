{"format_version":"1.2","terraform_version":"1.13.5","variables":{"access_logs_prefix":{"value":"TFStateLogs/"},"aws_access_key_id":{"value":"test"},"aws_secret_access_key":{"value":"test"},"bucket_name":{"value":"terratest-aws-s3-example-placeholder"},"force_destroy":{"value":true},"localstack_endpoint":{"value":"http://localhost:4566"},"project":{"value":"terratest-localstack"},"region":{"value":"us-east-1"},"s3_use_path_style":{"value":false},"tag_bucket_environment":{"value":"Automated Testing"},"tag_bucket_name":{"value":"terratest-aws-s3-example-placeholder"},"tags":{"value":{}},"use_localstack":{"value":true},"with_policy":{"value":true}},"planned_values":{"outputs":{"bucket_id":{"sensitive":false},"logs_bucket_id":{"sensitive":false},"logs_prefix":{"sensitive":false,"type":"string","value":"TFStateLogs/"}},"root_module":{"resources":[{"address":"aws_s3_bucket.app","mode":"managed","type":"aws_s3_bucket","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"terratest-aws-s3-example-placeholder","force_destroy":true,"region":"us-east-1","tags":{"Environment":"Automated Testing","Name":"terratest-aws-s3-example-placeholder"},"tags_all":{"Environment":"Automated Testing","Name":"terratest-aws-s3-example-placeholder","Project":"terratest-localstack"},"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"region":null}},{"address":"aws_s3_bucket.logs","mode":"managed","type":"aws_s3_bucket","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"terratest-aws-s3-example-placeholder-logs","force_destroy":true,"region":"us-east-1","tags":{"Environment":"Automated Testing","Name":"terratest-aws-s3-example-placeholder-logs"},"tags_all":{"Environment":"Automated Testing","Name":"terratest-aws-s3-example-placeholder-logs","Project":"terratest-localstack"},"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"region":null}},{"address":"aws_s3_bucket_logging.app","mode":"managed","type":"aws_s3_bucket_logging","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"region":"us-east-1","target_grant":[],"target_object_key_format":[],"target_prefix":"TFStateLogs/"},"sensitive_values":{"target_grant":[],"target_object_key_format":[]},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"expected_bucket_owner":null,"region":null}},{"address":"aws_s3_bucket_policy.app[0]","mode":"managed","type":"aws_s3_bucket_policy","name":"app","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-east-1"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"region":null}},{"address":"aws_s3_bucket_policy.logs","mode":"managed","type":"aws_s3_bucket_policy","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-east-1"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"region":null}},{"address":"aws_s3_bucket_public_access_block.app","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"region":"us-east-1","restrict_public_buckets":true,"skip_destroy":null},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"region":null}},{"address":"aws_s3_bucket_public_access_block.logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"region":"us-east-1","restrict_public_buckets":true,"skip_destroy":null},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"region":null}},{"address":"aws_s3_bucket_server_side_encryption_configuration.app","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"region":"us-east-1","rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"blocked_encryption_types":[],"bucket_key_enabled":null}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}],"blocked_encryption_types":[]}]},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"expected_bucket_owner":null,"region":null}},{"address":"aws_s3_bucket_server_side_encryption_configuration.logs","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"region":"us-east-1","rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"blocked_encryption_types":[],"bucket_key_enabled":null}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}],"blocked_encryption_types":[]}]},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"expected_bucket_owner":null,"region":null}},{"address":"aws_s3_bucket_versioning.app","mode":"managed","type":"aws_s3_bucket_versioning","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"mfa":null,"region":"us-east-1","versioning_configuration":[{"status":"Enabled"}]},"sensitive_values":{"versioning_configuration":[{}]},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"expected_bucket_owner":null,"region":null}},{"address":"aws_s3_bucket_versioning.logs","mode":"managed","type":"aws_s3_bucket_versioning","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"mfa":null,"region":"us-east-1","versioning_configuration":[{"status":"Enabled"}]},"sensitive_values":{"versioning_configuration":[{}]},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"expected_bucket_owner":null,"region":null}},{"address":"data.aws_iam_policy_document.app_bucket_policy[0]","mode":"data","type":"aws_iam_policy_document","name":"app_bucket_policy","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["s3:*"],"condition":[{"test":"Bool","values":["false"],"variable":"aws:SecureTransport"}],"effect":"Deny","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["*"],"type":"*"}],"resources":[null,null],"sid":"DenyInsecureTransport"}],"version":null},"sensitive_values":{"statement":[{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false,false]}]}}]}},"resource_changes":[{"address":"data.aws_iam_policy_document.app_bucket_policy[0]","mode":"data","type":"aws_iam_policy_document","name":"app_bucket_policy","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["s3:*"],"condition":[{"test":"Bool","values":["false"],"variable":"aws:SecureTransport"}],"effect":"Deny","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["*"],"type":"*"}],"resources":[null,null],"sid":"DenyInsecureTransport"}],"version":null},"after_unknown":{"id":true,"json":true,"minified_json":true,"statement":[{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[true,true]}]},"before_sensitive":false,"after_sensitive":{"statement":[{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false,false]}]}},"action_reason":"read_because_config_unknown"},{"address":"aws_s3_bucket.app","mode":"managed","type":"aws_s3_bucket","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"terratest-aws-s3-example-placeholder","force_destroy":true,"region":"us-east-1","tags":{"Environment":"Automated Testing","Name":"terratest-aws-s3-example-placeholder"},"tags_all":{"Environment":"Automated Testing","Name":"terratest-aws-s3-example-placeholder","Project":"terratest-localstack"},"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_region":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":{},"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]},"after_identity":{"account_id":null,"bucket":null,"region":null}}},{"address":"aws_s3_bucket.logs","mode":"managed","type":"aws_s3_bucket","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"terratest-aws-s3-example-placeholder-logs","force_destroy":true,"region":"us-east-1","tags":{"Environment":"Automated Testing","Name":"terratest-aws-s3-example-placeholder-logs"},"tags_all":{"Environment":"Automated Testing","Name":"terratest-aws-s3-example-placeholder-logs","Project":"terratest-localstack"},"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_region":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":{},"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]},"after_identity":{"account_id":null,"bucket":null,"region":null}}},{"address":"aws_s3_bucket_logging.app","mode":"managed","type":"aws_s3_bucket_logging","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"region":"us-east-1","target_grant":[],"target_object_key_format":[],"target_prefix":"TFStateLogs/"},"after_unknown":{"bucket":true,"id":true,"target_bucket":true,"target_grant":[],"target_object_key_format":[]},"before_sensitive":false,"after_sensitive":{"target_grant":[],"target_object_key_format":[]},"after_identity":{"account_id":null,"bucket":null,"expected_bucket_owner":null,"region":null}}},{"address":"aws_s3_bucket_policy.app[0]","mode":"managed","type":"aws_s3_bucket_policy","name":"app","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-east-1"},"after_unknown":{"bucket":true,"id":true,"policy":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"bucket":null,"region":null}}},{"address":"aws_s3_bucket_policy.logs","mode":"managed","type":"aws_s3_bucket_policy","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-east-1"},"after_unknown":{"bucket":true,"id":true,"policy":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"bucket":null,"region":null}}},{"address":"aws_s3_bucket_public_access_block.app","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"region":"us-east-1","restrict_public_buckets":true,"skip_destroy":null},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"bucket":null,"region":null}}},{"address":"aws_s3_bucket_public_access_block.logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"region":"us-east-1","restrict_public_buckets":true,"skip_destroy":null},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"bucket":null,"region":null}}},{"address":"aws_s3_bucket_server_side_encryption_configuration.app","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"region":"us-east-1","rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"blocked_encryption_types":[],"bucket_key_enabled":null}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{}],"blocked_encryption_types":[]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}],"blocked_encryption_types":[]}]},"after_identity":{"account_id":null,"bucket":null,"expected_bucket_owner":null,"region":null}}},{"address":"aws_s3_bucket_server_side_encryption_configuration.logs","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"region":"us-east-1","rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"blocked_encryption_types":[],"bucket_key_enabled":null}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{}],"blocked_encryption_types":[]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}],"blocked_encryption_types":[]}]},"after_identity":{"account_id":null,"bucket":null,"expected_bucket_owner":null,"region":null}}},{"address":"aws_s3_bucket_versioning.app","mode":"managed","type":"aws_s3_bucket_versioning","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"mfa":null,"region":"us-east-1","versioning_configuration":[{"status":"Enabled"}]},"after_unknown":{"bucket":true,"id":true,"versioning_configuration":[{"mfa_delete":true}]},"before_sensitive":false,"after_sensitive":{"versioning_configuration":[{}]},"after_identity":{"account_id":null,"bucket":null,"expected_bucket_owner":null,"region":null}}},{"address":"aws_s3_bucket_versioning.logs","mode":"managed","type":"aws_s3_bucket_versioning","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"mfa":null,"region":"us-east-1","versioning_configuration":[{"status":"Enabled"}]},"after_unknown":{"bucket":true,"id":true,"versioning_configuration":[{"mfa_delete":true}]},"before_sensitive":false,"after_sensitive":{"versioning_configuration":[{}]},"after_identity":{"account_id":null,"bucket":null,"expected_bucket_owner":null,"region":null}}}],"output_changes":{"bucket_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"logs_bucket_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"logs_prefix":{"actions":["create"],"before":null,"after":"TFStateLogs/","after_unknown":false,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.13.5","values":{"outputs":{"logs_prefix":{"sensitive":false,"value":"TFStateLogs/","type":"string"}},"root_module":{}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"\u003e= 5.0.0","expressions":{"access_key":{"references":["var.aws_access_key_id"]},"default_tags":[{"tags":{"references":["var.project","var.tags"]}}],"region":{"references":["var.region"]},"s3_use_path_style":{"references":["var.s3_use_path_style"]},"secret_key":{"references":["var.aws_secret_access_key"]},"skip_credentials_validation":{"references":["var.use_localstack"]},"skip_metadata_api_check":{"references":["var.use_localstack"]},"skip_requesting_account_id":{"references":["var.use_localstack"]}}}},"root_module":{"outputs":{"bucket_id":{"expression":{"references":["aws_s3_bucket.app.id","aws_s3_bucket.app"]},"description":"ID (name) of the application bucket. Terratest reads this output."},"logs_bucket_id":{"expression":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"description":"ID (name) of the access logs bucket."},"logs_prefix":{"expression":{"references":["var.access_logs_prefix"]},"description":"Prefix used for server access logs."}},"resources":[{"address":"aws_s3_bucket.app","mode":"managed","type":"aws_s3_bucket","name":"app","provider_config_key":"aws","expressions":{"bucket":{"references":["var.bucket_name"]},"force_destroy":{"references":["var.force_destroy"]},"tags":{"references":["var.tag_bucket_name","var.tag_bucket_environment"]}},"schema_version":0},{"address":"aws_s3_bucket.logs","mode":"managed","type":"aws_s3_bucket","name":"logs","provider_config_key":"aws","expressions":{"bucket":{"references":["local.logs_bucket_name"]},"force_destroy":{"references":["var.force_destroy"]},"tags":{"references":["local.logs_bucket_name","var.tag_bucket_environment"]}},"schema_version":0},{"address":"aws_s3_bucket_logging.app","mode":"managed","type":"aws_s3_bucket_logging","name":"app","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.app.id","aws_s3_bucket.app"]},"target_bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"target_prefix":{"references":["var.access_logs_prefix"]}},"schema_version":0},{"address":"aws_s3_bucket_policy.app","mode":"managed","type":"aws_s3_bucket_policy","name":"app","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.app.id","aws_s3_bucket.app"]},"policy":{"references":["data.aws_iam_policy_document.app_bucket_policy[0].json","data.aws_iam_policy_document.app_bucket_policy[0]","data.aws_iam_policy_document.app_bucket_policy"]}},"schema_version":0,"count_expression":{"references":["var.with_policy"]},"depends_on":["aws_s3_bucket_public_access_block.app"]},{"address":"aws_s3_bucket_policy.logs","mode":"managed","type":"aws_s3_bucket_policy","name":"logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"policy":{"references":["aws_s3_bucket.logs.arn","aws_s3_bucket.logs","var.access_logs_prefix"]}},"schema_version":0,"depends_on":["aws_s3_bucket_public_access_block.logs"]},{"address":"aws_s3_bucket_public_access_block.app","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"app","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.app.id","aws_s3_bucket.app"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"logs","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.app","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"app","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.app.id","aws_s3_bucket.app"]},"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":{"constant_value":"AES256"}}]}]},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.logs","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":{"constant_value":"AES256"}}]}]},"schema_version":0},{"address":"aws_s3_bucket_versioning.app","mode":"managed","type":"aws_s3_bucket_versioning","name":"app","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.app.id","aws_s3_bucket.app"]},"versioning_configuration":[{"status":{"constant_value":"Enabled"}}]},"schema_version":0},{"address":"aws_s3_bucket_versioning.logs","mode":"managed","type":"aws_s3_bucket_versioning","name":"logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"versioning_configuration":[{"status":{"constant_value":"Enabled"}}]},"schema_version":0},{"address":"data.aws_iam_policy_document.app_bucket_policy","mode":"data","type":"aws_iam_policy_document","name":"app_bucket_policy","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["s3:*"]},"condition":[{"test":{"constant_value":"Bool"},"values":{"constant_value":["false"]},"variable":{"constant_value":"aws:SecureTransport"}}],"effect":{"constant_value":"Deny"},"principals":[{"identifiers":{"constant_value":["*"]},"type":{"constant_value":"*"}}],"resources":{"references":["aws_s3_bucket.app.arn","aws_s3_bucket.app","aws_s3_bucket.app.arn","aws_s3_bucket.app"]},"sid":{"constant_value":"DenyInsecureTransport"}}]},"schema_version":0,"count_expression":{"references":["var.with_policy"]}}],"variables":{"access_logs_prefix":{"default":"TFStateLogs/","description":"Prefix for S3 server access logs. Terratest expects TFStateLogs/."},"aws_access_key_id":{"default":"test","description":"AWS access key (LocalStack default is 'test').","sensitive":true},"aws_secret_access_key":{"default":"test","description":"AWS secret key (LocalStack default is 'test').","sensitive":true},"bucket_name":{"description":"Name of the application S3 bucket."},"force_destroy":{"default":true,"description":"Whether to force-destroy buckets (useful for tests)."},"localstack_endpoint":{"default":"http://localhost:4566","description":"LocalStack edge endpoint."},"project":{"default":"terratest-localstack","description":"Project tag applied via provider default_tags."},"region":{"description":"AWS region to use. Terratest passes this in."},"s3_use_path_style":{"default":false,"description":"Set true when using http://localhost:4566 for S3 to avoid DNS-style bucket addressing issues."},"tag_bucket_environment":{"description":"Value for the Environment tag on the buckets (Terratest passes this)."},"tag_bucket_name":{"description":"Value for the Name tag on the application bucket (Terratest passes this)."},"tags":{"default":{},"description":"Additional tags to apply via provider default_tags."},"use_localstack":{"default":true,"description":"If true, configure the AWS provider to use LocalStack endpoints and skip validations."},"with_policy":{"default":true,"description":"Whether to attach a bucket policy to the application bucket (Terratest expects true)."}}}},"relevant_attributes":[{"resource":"data.aws_iam_policy_document.app_bucket_policy[0]","attribute":["json"]},{"resource":"aws_s3_bucket.app","attribute":["id"]},{"resource":"aws_s3_bucket.logs","attribute":["id"]},{"resource":"aws_s3_bucket.app","attribute":["arn"]},{"resource":"aws_s3_bucket.logs","attribute":["arn"]}],"timestamp":"2026-01-27T10:19:59Z","applyable":true,"complete":true,"errored":false}
