{
  "aws_architecture_description": "### Target AWS architecture (lean, secure, EKS-based)\n\n#### 1) Networking foundation\n- Deploy into a dedicated **VPC** spanning **2–3 Availability Zones**.\n- Create **public subnets** (for internet-facing load balancers) and **private subnets** (for EKS worker nodes/pods).\n- Add **NAT Gateways** (one per AZ if you want higher availability; one total if you want lower cost) so private subnets can pull container images and reach AWS APIs without being publicly reachable.\n- Use **VPC endpoints** where it reduces NAT egress and improves security (notably ECR, S3, CloudWatch Logs).\n\n#### 2) Compute / Kubernetes runtime\n- Run the application on **Amazon EKS**.\n- Use an **EKS Managed Node Group** (EC2) sized for 6 replicas + headroom. (Fargate is possible, but EC2 node groups are the simplest default for this repo’s current manifests.)\n- Deploy the app as a Kubernetes **Deployment** (`notes-keeper`, replicas=6) running the existing **nginx:alpine**-based container.\n\n#### 3) Ingress / traffic path\n- Recommended: expose HTTP/HTTPS via an **Application Load Balancer (ALB)** using the **AWS Load Balancer Controller** and a Kubernetes **Ingress** resource (better L7 routing, TLS, redirects, WAF integration).\n  - The controller provisions ALBs from Ingress resources annotated with `kubernetes.io/ingress.class: alb`. ([docs.aws.amazon.com](https://docs.aws.amazon.com/eks/latest/userguide/alb-ingress.html?utm_source=openai))\n  - Ensure VPC subnets are tagged for controller auto-discovery (public/private tags), otherwise ALB provisioning can fail. ([docs.aws.amazon.com](https://docs.aws.amazon.com/eks/latest/userguide/alb-ingress.html?utm_source=openai))\n- If you keep the current pattern (Kubernetes **Service type LoadBalancer**):\n  - Use the AWS Load Balancer Controller’s Service annotations to explicitly select **NLB** behavior (for example `service.beta.kubernetes.io/aws-load-balancer-type: external` and target type `instance` or `ip`). ([kubernetes-sigs.github.io](https://kubernetes-sigs.github.io/aws-load-balancer-controller/latest/guide/service/annotations/?utm_source=openai))\n  - This is fine for a simple static site, but ALB+Ingress is typically the cleanest for HTTP/TLS.\n\n#### 4) Container image source\n- Today you publish to Docker Hub / GHCR. On AWS, the most operationally consistent option is **Amazon ECR**:\n  - CI builds the image and pushes to ECR.\n  - EKS nodes pull from ECR using node IAM permissions (no long-lived registry credentials in the cluster).\n- You can keep Docker Hub/GHCR, but you’ll manage credentials (K8s imagePullSecrets) and rate limits.\n\n#### 5) IAM and cluster security\n- Use separate IAM roles for:\n  - **EKS cluster role**\n  - **Node group role**\n  - **IRSA (IAM Roles for Service Accounts)** for controllers (AWS Load Balancer Controller, ExternalDNS, cert-manager, etc.).\n- Enable **OIDC provider** on the cluster to support IRSA.\n- Use **Security Groups** to:\n  - Allow inbound 80/443 to the ALB\n  - Allow ALB-to-node/pod traffic on the service port\n  - Restrict node inbound to only what’s required\n\n#### 6) Observability and audit\n- Send EKS control plane logs to **CloudWatch Logs**.\n- Enable **Container Insights** (CloudWatch) for cluster/node/pod metrics and dashboards.\n- Use **CloudTrail** for account audit logging.\n\n#### 7) CI/CD (minimal AWS-side additions)\n- Keep GitHub Actions/Jenkins, but store secrets in **AWS Secrets Manager** (or SSM Parameter Store) and use short-lived AWS credentials (OIDC federation from GitHub Actions is ideal).\n- Deployment remains `kubectl apply` (as you do now), or evolve to GitOps later.\n\n---\n\n## AWS resources to provision\n\n### Networking\n- Amazon VPC\n- VPC subnets (Public subnets in 2–3 AZs)\n- VPC subnets (Private subnets in 2–3 AZs)\n- Internet Gateway (IGW)\n- NAT Gateway(s)\n- Elastic IP(s) for NAT Gateway(s)\n- Route tables (public/private) + route table associations\n- Security Groups (ALB, EKS nodes, optional admin/bastion)\n- Network ACLs (optional; default is acceptable for lean setup)\n- VPC Endpoints (recommended):\n  - Interface endpoints: ECR (api, dkr), CloudWatch Logs, STS (optional)\n  - Gateway endpoint: S3\n\n### EKS / Compute\n- Amazon EKS cluster\n- EKS managed node group (EC2)\n- EC2 Launch Template (optional; if you need custom AMI/user-data/disk)\n- IAM role for EKS cluster\n- IAM role for EKS node group\n- EKS OIDC identity provider (for IRSA)\n\n### Load balancing / Edge\n- AWS Load Balancer Controller (installed in-cluster via Helm; AWS resources below are created/used by it)\n- IAM policy + IAM role for the AWS Load Balancer Controller (IRSA)\n- Application Load Balancer (recommended via Ingress) **or** Network Load Balancer (if sticking with Service type LoadBalancer)\n- Target Group(s)\n- Listener(s) (80/443)\n- AWS Certificate Manager (ACM) certificate (if using HTTPS)\n- Amazon Route 53 hosted zone + DNS record(s) (if you own a domain)\n- AWS WAFv2 Web ACL (optional but recommended for internet-facing ALB)\n\n### Container registry (recommended)\n- Amazon ECR repository\n- ECR lifecycle policy\n- (Optional) ECR pull-through cache rule(s) if you still depend on public images heavily\n\n### Secrets / Configuration\n- AWS Secrets Manager secrets (e.g., registry creds if not using ECR; webhook tokens; Jira/Sonar tokens if needed)\n- AWS Systems Manager Parameter Store parameters (optional alternative for non-sensitive config)\n- AWS KMS key(s) (optional; for Secrets Manager/CloudWatch Logs encryption beyond defaults)\n\n### Observability / Security logging\n- Amazon CloudWatch Log Groups (EKS control plane logs, application logs)\n- CloudWatch Container Insights (cluster add-on/config)\n- AWS CloudTrail trail\n- S3 bucket for CloudTrail logs (and optionally ALB access logs)\n- (Optional) AWS Config\n- (Optional) GuardDuty\n\n### CI/CD access (AWS-side)\n- IAM role for GitHub Actions OIDC federation (recommended)\n- IAM policy for CI role (push to ECR, update kubeconfig/describe cluster, etc.)\n\n### Kubernetes add-ons (EKS add-ons / in-cluster, but require AWS permissions)\n- Amazon VPC CNI add-on\n- CoreDNS add-on\n- kube-proxy add-on\n- (Optional) EBS CSI Driver + IAM role (only if you later add persistent volumes)\n\n---\n\n### Notes / key decision\n- For a static site, the *simplest* AWS-native option would be S3 + CloudFront, but your repo is already containerized and deployed to Kubernetes with 6 replicas. The architecture above keeps your current operational model while tightening AWS best practices (private nodes, ALB controller, IRSA, CloudWatch logging).",
  "aws_resources": [
    "Amazon VPC",
    "Public subnets (2–3 AZs)",
    "Private subnets (2–3 AZs)",
    "Internet Gateway (IGW)",
    "NAT Gateway(s)",
    "Elastic IP(s) for NAT Gateway(s)",
    "Public route table + routes + associations",
    "Private route table + routes + associations",
    "Security Groups (ALB, EKS nodes, admin)",
    "VPC Endpoint (Gateway): S3",
    "VPC Endpoint (Interface): ECR (api)",
    "VPC Endpoint (Interface): ECR (dkr)",
    "VPC Endpoint (Interface): CloudWatch Logs",
    "VPC Endpoint (Interface): STS (optional)",
    "Amazon EKS Cluster",
    "EKS Managed Node Group (EC2)",
    "EC2 Launch Template (optional)",
    "IAM Role: EKS Cluster Role",
    "IAM Role: EKS Node Group Role",
    "EKS OIDC Provider (for IRSA)",
    "AWS Load Balancer Controller (in-cluster)",
    "IAM Role (IRSA) + IAM Policy for AWS Load Balancer Controller",
    "Application Load Balancer (recommended) or Network Load Balancer (if using Service type LoadBalancer)",
    "Target Group(s)",
    "Listener(s) (HTTP/HTTPS)",
    "AWS Certificate Manager (ACM) Certificate (for TLS)",
    "Amazon Route 53 Hosted Zone + DNS Records (if domain used)",
    "AWS WAFv2 Web ACL (optional)",
    "Amazon ECR Repository (recommended)",
    "ECR Lifecycle Policy",
    "AWS Secrets Manager Secrets",
    "AWS KMS Key (optional)",
    "Amazon CloudWatch Log Groups",
    "CloudWatch Container Insights (EKS observability)",
    "AWS CloudTrail Trail",
    "S3 Bucket for CloudTrail logs (and optional ALB access logs)",
    "IAM Role for GitHub Actions OIDC federation (recommended)",
    "IAM Policy for CI/CD role",
    "EKS Add-ons: VPC CNI, CoreDNS, kube-proxy",
    "EKS Add-on (optional): EBS CSI Driver + IRSA role"
  ]
}