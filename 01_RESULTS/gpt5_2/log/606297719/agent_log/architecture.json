{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\nskinparam shadowing false\nskinparam componentStyle rectangle\nskinparam wrapWidth 220\nskinparam maxMessageSize 120\n\ntitle Prefect 2 Workflow Deployment on AWS ECS Fargate (High-level)\n\nactor \"Operator / CI\" as operator\n\ncloud \"AWS\" as aws {\n  node \"VPC\" as vpc {\n    node \"Private Subnets\" as subnets {\n      node \"ECS Cluster\" as ecs {\n        node \"ECS Service: Prefect Agent\\n(Fargate Task)\\nPython + Prefect 2\" as agent\n        node \"ECS Tasks: Flow Runs\\n(Fargate Tasks)\\nPython + Prefect 2\\n(pandas, s3fs, sqlalchemy)\" as flowtasks\n        node \"Optional: Dask Cluster\\n(ECS Tasks)\\nPython + dask/distributed\\n(via prefect-dask)\" as dask\n      }\n    }\n  }\n\n  node \"Amazon S3 Bucket\\nPrefect Storage Block\\n(flow code/artifacts)\" as s3\n\n  node \"Optional: Database\\n(via SQLAlchemy)\" as db\n}\n\nnode \"Prefect Orchestration\\n(Prefect Cloud or Prefect Server)\" as prefect {\n  component \"API / Orchestrator\" as prefect_api\n}\n\noperator --> prefect_api : Register deployments\\n(prefect deploy)\noperator --> s3 : Upload flow package\\n(storage block)\n\nprefect_api --> agent : Poll for work\\n(queues)\nagent --> prefect_api : Report status\\n& logs metadata\n\nagent --> flowtasks : Start flow run task\nflowtasks --> prefect_api : Heartbeats\\n& state updates\n\nflowtasks --> s3 : Read flow code\\n& write artifacts\nflowtasks --> db : Read/Write data\\n(if configured)\n\nflowtasks --> dask : Submit tasks\\n(optional)\ndask --> s3 : Read/Write data\\n(optional)\n\nnote right of s3\nEvidence: flows/log-flow-agent-ecs.yaml\nbucket_path and README mentions S3 storage block.\nend note\n\nnote right of db\nSQLAlchemy dependency present; actual DB not found in repo.\nModel as optional external DB (e.g., RDS/Postgres).\nend note\n\n@enduml",
  "svg_diagram": "<?plantuml 1.2026.2beta1?><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" contentStyleType=\"text/css\" data-diagram-type=\"DESCRIPTION\" height=\"1017px\" preserveAspectRatio=\"none\" style=\"width:1417px;height:1017px;background:#FFFFFF;\" version=\"1.1\" viewBox=\"0 0 1417 1017\" width=\"1417px\" zoomAndPan=\"magnify\"><title>Prefect 2 Workflow Deployment on AWS ECS Fargate (High-level)</title><defs/><g><g class=\"title\" data-source-line=\"9\"><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"516.373\" x=\"443.3918\" y=\"22.9951\">Prefect 2 Workflow Deployment on AWS ECS Fargate (High-level)</text></g><!--cluster aws--><g class=\"cluster\" data-qualified-name=\"aws\" data-source-line=\"13\" id=\"ent0003\"><path d=\"M57.6928,78.5328 C74.9106,46.0908 106.3635,43.2969 125.3787,76.6846 C147.6354,45.5974 172.6696,50.2529 193.393,78.4439 C212.6168,50.0449 240.2533,51.3773 259.6081,78.2871 C283.8224,55.4019 303.1107,53.5797 322.1093,84.3614 C342.4859,50.3786 366.4688,50.4766 388.7979,82.3853 C403.5474,43.6763 436.4417,47.9049 459.1296,73.7344 C481.9372,48.2598 504.6621,45.728 522.3939,79.1835 C547.1523,45.4269 573.8341,47.1243 592.2278,85.3577 C606.7963,53.513 641.1363,45.7968 663.5683,76.3702 C683.9327,50.993 716.6825,45.6982 730.604,83.2352 C735.7202,83.0086 738.4713,86.4989 736.3532,91.3793 C767.5183,113.7384 767.5901,137.1933 732.1826,155.2022 C756.5338,168.1427 756.0887,192.525 734.919,207.8324 C769.6364,222.0601 774.3523,251.9005 741.1835,272.6857 C771.3807,289.3511 772.0942,310.8316 747.2368,333.0205 C778.2548,352.9967 774.1935,383.9219 741.8437,398.6943 C774.1995,413.1128 777.5076,438.3015 746.6127,457.8215 C773.2669,478.624 773.9449,504.8548 742.2709,521.6922 C768.4151,539.6196 769.4219,565.4166 743.0687,584.016 C768.6399,604.458 770.5219,623.666 744.9792,645.6913 C780.0994,668.1702 774.9179,699.3395 737.7913,714.2431 C762.6798,726.2666 765.9923,752.5898 741.8847,768.3219 C769.9586,789.7981 772.8009,810.8056 742.6556,832.9759 C769.439,858.3977 764.8439,877.7119 732.2304,892.7793 C763.0865,920.411 762.4657,942.1361 723.604,960.9452 C728.5917,961.7577 729.0877,966.1462 726.2486,969.4053 C705.5381,1000.8488 682.865,1002.9337 661.9284,969.63 C641.6492,998.8222 608.9236,997.4709 592.3507,965.4193 C577.8951,1003.7812 547.3278,1006.0561 525.6833,972.0411 C503.0264,1002.579 479.5852,1000.7868 456.3772,972.6925 C433.8901,1010.0516 410.1871,1001.6754 386.7784,973.6738 C366.3975,998.7331 338.8148,1002.6899 322.024,969.6709 C307.1695,995.4052 277.8256,1003.0647 260.1803,972.7502 C241.2909,1010.2559 205.9238,1009.2807 189.0148,970.8932 C167.4184,1000.2583 143.6144,993.2117 126.7315,965.7292 C98.1317,1003.0988 59.0491,997.1569 41.604,953.9452 C49.4203,952.4597 52.841,955.4258 50.8149,963.4641 C24.4194,942.2338 22.1042,919.8919 50.3051,898.2348 C21.2719,876.6368 18.085,852.9737 51.4586,832.4703 C24.0092,820.0201 25.5821,795.8995 45.8466,778.4888 C10.9275,764.4759 12.9726,733.1977 40.4476,713.964 C6.7137,696.2432 6,670.7635 39.6712,652.1954 C9.8972,634.2833 8.0309,602.9279 39.0867,584.4906 C7.5567,562.4263 14.1507,536.6279 44.921,520.219 C18.2608,503.2811 14.5494,474.5779 45.7988,458.4631 C24.2766,444.4397 18.4328,417.4499 47.1611,404.6998 C20.8235,386.013 13.3807,360.8543 46.4811,341.5277 C13.6929,324.8928 7.5428,291.6729 43.3153,271.9199 C17.9088,253.5617 19.8762,229.8413 45.5545,213.439 C18.5151,196.5011 22.2728,171.7727 46.7027,155.8613 C6.9518,130.0605 10.5211,100.1774 48.604,76.2352 C52.4038,72.9606 56.1444,72.9018 57.6928,78.5328\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"36.3604\" x=\"367.9238\" y=\"94.2303\">AWS</text></g><!--cluster vpc--><g class=\"cluster\" data-qualified-name=\"aws.vpc\" data-source-line=\"14\" id=\"ent0004\"><polygon fill=\"#FFFFFF\" points=\"57.604,121.2352,67.604,111.2352,413.604,111.2352,413.604,789.0552,403.604,799.0552,57.604,799.0552,57.604,121.2352\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"403.604\" x2=\"413.604\" y1=\"121.2352\" y2=\"111.2352\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"57.604\" x2=\"403.604\" y1=\"121.2352\" y2=\"121.2352\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"403.604\" x2=\"403.604\" y1=\"121.2352\" y2=\"799.0552\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"31.3701\" x=\"215.919\" y=\"137.2303\">VPC</text></g><!--cluster subnets--><g class=\"cluster\" data-qualified-name=\"aws.vpc.subnets\" data-source-line=\"15\" id=\"ent0005\"><polygon fill=\"#FFFFFF\" points=\"81.604,169.2352,91.604,159.2352,389.604,159.2352,389.604,765.0552,379.604,775.0552,81.604,775.0552,81.604,169.2352\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"379.604\" x2=\"389.604\" y1=\"169.2352\" y2=\"159.2352\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"81.604\" x2=\"379.604\" y1=\"169.2352\" y2=\"169.2352\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"379.604\" x2=\"379.604\" y1=\"169.2352\" y2=\"775.0552\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"126.1572\" x=\"168.5254\" y=\"185.2303\">Private Subnets</text></g><!--cluster ecs--><g class=\"cluster\" data-qualified-name=\"aws.vpc.subnets.ecs\" data-source-line=\"16\" id=\"ent0006\"><polygon fill=\"#FFFFFF\" points=\"105.604,217.2352,115.604,207.2352,365.604,207.2352,365.604,741.0552,355.604,751.0552,105.604,751.0552,105.604,217.2352\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"355.604\" x2=\"365.604\" y1=\"217.2352\" y2=\"207.2352\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"105.604\" x2=\"355.604\" y1=\"217.2352\" y2=\"217.2352\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"355.604\" x2=\"355.604\" y1=\"217.2352\" y2=\"751.0552\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"91.2598\" x=\"185.9741\" y=\"233.2303\">ECS Cluster</text></g><!--cluster prefect--><g class=\"cluster\" data-qualified-name=\"prefect\" data-source-line=\"29\" id=\"ent0012\"><polygon fill=\"#FFFFFF\" points=\"762.604,425.1252,772.604,415.1252,1097.604,415.1252,1097.604,513.4252,1087.604,523.4252,762.604,523.4252,762.604,425.1252\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1087.604\" x2=\"1097.604\" y1=\"425.1252\" y2=\"415.1252\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"762.604\" x2=\"1087.604\" y1=\"425.1252\" y2=\"425.1252\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1087.604\" x2=\"1087.604\" y1=\"425.1252\" y2=\"523.4252\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"171.1309\" x=\"840.5386\" y=\"441.1203\">Prefect Orchestration</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"259.9775\" x=\"796.1153\" y=\"457.4172\">(Prefect Cloud or Prefect Server)</text></g><!--entity s3--><g class=\"entity\" data-qualified-name=\"aws.s3\" data-source-line=\"24\" id=\"ent0010\"><polygon fill=\"#FFFFFF\" points=\"423.064,884.0552,433.064,874.0552,614.1451,874.0552,614.1451,942.9458,604.1451,952.9458,423.064,952.9458,423.064,884.0552\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"604.1451\" x2=\"614.1451\" y1=\"884.0552\" y2=\"874.0552\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"423.064\" x2=\"604.1451\" y1=\"884.0552\" y2=\"884.0552\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"604.1451\" x2=\"604.1451\" y1=\"884.0552\" y2=\"952.9458\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.5811\" x=\"447.7745\" y=\"907.0503\">Amazon</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"504.3555\" y=\"907.0503\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"17.7939\" x=\"508.8057\" y=\"907.0503\">S3</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"526.5997\" y=\"907.0503\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.3848\" x=\"531.0499\" y=\"907.0503\">Bucket</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"49.54\" x=\"438.064\" y=\"923.3472\">Prefect</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"487.6041\" y=\"923.3472\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"54.7764\" x=\"492.0543\" y=\"923.3472\">Storage</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"546.8306\" y=\"923.3472\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"37.8643\" x=\"551.2808\" y=\"923.3472\">Block</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"34.2959\" x=\"443.4097\" y=\"939.644\">(flow</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"477.7056\" y=\"939.644\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"101.6436\" x=\"482.1558\" y=\"939.644\">code/artifacts)</text></g><!--entity db--><g class=\"entity\" data-qualified-name=\"aws.db\" data-source-line=\"26\" id=\"ent0011\"><polygon fill=\"#FFFFFF\" points=\"547.024,666.1652,557.024,656.1652,722.1842,656.1652,722.1842,708.7589,712.1842,718.7589,547.024,718.7589,547.024,666.1652\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"712.1842\" x2=\"722.1842\" y1=\"666.1652\" y2=\"656.1652\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"547.024\" x2=\"712.1842\" y1=\"666.1652\" y2=\"666.1652\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"712.1842\" x2=\"712.1842\" y1=\"666.1652\" y2=\"718.7589\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"63.9092\" x=\"562.024\" y=\"689.1603\">Optional:</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"625.9332\" y=\"689.1603\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"66.8008\" x=\"630.3834\" y=\"689.1603\">Database</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"26.2158\" x=\"567.4005\" y=\"705.4572\">(via</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"593.6163\" y=\"705.4572\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"93.7412\" x=\"598.0665\" y=\"705.4572\">SQLAlchemy)</text></g><!--entity agent--><g class=\"entity\" data-qualified-name=\"aws.vpc.subnets.ecs.agent\" data-source-line=\"17\" id=\"ent0007\"><polygon fill=\"#FFFFFF\" points=\"121.454,257.2352,131.454,247.2352,349.7499,247.2352,349.7499,316.1258,339.7499,326.1258,121.454,326.1258,121.454,257.2352\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"339.7499\" x2=\"349.7499\" y1=\"257.2352\" y2=\"247.2352\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"121.454\" x2=\"339.7499\" y1=\"257.2352\" y2=\"257.2352\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"339.7499\" x2=\"339.7499\" y1=\"257.2352\" y2=\"326.1258\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"27.5078\" x=\"136.454\" y=\"280.2303\">ECS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"163.9618\" y=\"280.2303\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.458\" x=\"168.412\" y=\"280.2303\">Service:</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"224.87\" y=\"280.2303\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"49.54\" x=\"229.3202\" y=\"280.2303\">Prefect</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"278.8603\" y=\"280.2303\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"41.4395\" x=\"283.3105\" y=\"280.2303\">Agent</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"59.418\" x=\"179.6708\" y=\"296.5272\">(Fargate</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"239.0888\" y=\"296.5272\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"37.9941\" x=\"243.539\" y=\"296.5272\">Task)</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.5283\" x=\"164.5737\" y=\"312.824\">Python</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"213.102\" y=\"312.824\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"11.7305\" x=\"217.5522\" y=\"312.824\">+</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"229.2826\" y=\"312.824\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"49.54\" x=\"233.7328\" y=\"312.824\">Prefect</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"283.2729\" y=\"312.824\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"8.9072\" x=\"287.7231\" y=\"312.824\">2</text></g><!--entity flowtasks--><g class=\"entity\" data-qualified-name=\"aws.vpc.subnets.ecs.flowtasks\" data-source-line=\"18\" id=\"ent0008\"><polygon fill=\"#FFFFFF\" points=\"121.654,451.6752,131.654,441.6752,349.5466,441.6752,349.5466,526.8627,339.5466,536.8627,121.654,536.8627,121.654,451.6752\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"339.5466\" x2=\"349.5466\" y1=\"451.6752\" y2=\"441.6752\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"121.654\" x2=\"339.5466\" y1=\"451.6752\" y2=\"451.6752\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"339.5466\" x2=\"339.5466\" y1=\"451.6752\" y2=\"536.8627\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"27.5078\" x=\"154.5368\" y=\"474.6703\">ECS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"182.0447\" y=\"474.6703\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"44.543\" x=\"186.4948\" y=\"474.6703\">Tasks:</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"231.0378\" y=\"474.6703\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"31.958\" x=\"235.488\" y=\"474.6703\">Flow</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"267.446\" y=\"474.6703\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"34.7676\" x=\"271.8962\" y=\"474.6703\">Runs</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"59.418\" x=\"176.0222\" y=\"490.9672\">(Fargate</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"235.4402\" y=\"490.9672\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"45.2881\" x=\"239.8904\" y=\"490.9672\">Tasks)</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.5283\" x=\"164.572\" y=\"507.264\">Python</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"213.1003\" y=\"507.264\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"11.7305\" x=\"217.5505\" y=\"507.264\">+</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"229.281\" y=\"507.264\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"49.54\" x=\"233.7312\" y=\"507.264\">Prefect</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"283.2712\" y=\"507.264\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"8.9072\" x=\"287.7214\" y=\"507.264\">2</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"61.0107\" x=\"136.654\" y=\"523.5609\">(pandas,</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"197.6648\" y=\"523.5609\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"32.874\" x=\"202.115\" y=\"523.5609\">s3fs,</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"234.989\" y=\"523.5609\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"85.1074\" x=\"239.4392\" y=\"523.5609\">sqlalchemy)</text></g><!--entity dask--><g class=\"entity\" data-qualified-name=\"aws.vpc.subnets.ecs.dask\" data-source-line=\"19\" id=\"ent0009\"><polygon fill=\"#FFFFFF\" points=\"121.254,649.8652,131.254,639.8652,343.9513,639.8652,343.9513,725.0527,333.9513,735.0527,121.254,735.0527,121.254,649.8652\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"333.9513\" x2=\"343.9513\" y1=\"649.8652\" y2=\"639.8652\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"121.254\" x2=\"333.9513\" y1=\"649.8652\" y2=\"649.8652\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"333.9513\" x2=\"333.9513\" y1=\"649.8652\" y2=\"735.0527\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"63.9092\" x=\"148.9723\" y=\"672.8603\">Optional:</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"212.8815\" y=\"672.8603\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"34.7607\" x=\"217.3317\" y=\"672.8603\">Dask</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"252.0924\" y=\"672.8603\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"49.6904\" x=\"256.5426\" y=\"672.8603\">Cluster</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"32.9697\" x=\"186.2487\" y=\"689.1572\">(ECS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"219.2184\" y=\"689.1572\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"45.2881\" x=\"223.6686\" y=\"689.1572\">Tasks)</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.5283\" x=\"136.254\" y=\"705.454\">Python</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"184.7823\" y=\"705.454\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"11.7305\" x=\"189.2325\" y=\"705.454\">+</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"200.963\" y=\"705.454\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"113.5381\" x=\"205.4132\" y=\"705.454\">dask/distributed</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"26.2158\" x=\"165.587\" y=\"721.7509\">(via</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"191.8029\" y=\"721.7509\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"93.3652\" x=\"196.253\" y=\"721.7509\">prefect-dask)</text></g><!--entity prefect_api--><g class=\"entity\" data-qualified-name=\"prefect.prefect_api\" data-source-line=\"30\" id=\"ent0013\"><rect fill=\"#FFFFFF\" height=\"36.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"144.6533\" x=\"778.274\" y=\"471.1252\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"22.1484\" x=\"788.274\" y=\"494.1203\">API</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"810.4225\" y=\"494.1203\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.7168\" x=\"814.8727\" y=\"494.1203\">/</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"819.5895\" y=\"494.1203\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"88.8877\" x=\"824.0397\" y=\"494.1203\">Orchestrator</text></g><!--entity operator--><g class=\"entity\" data-qualified-name=\"operator\" data-source-line=\"11\" id=\"ent0002\"><ellipse cx=\"1060.6073\" cy=\"257.0352\" fill=\"#FFFFFF\" rx=\"8\" ry=\"8\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M1060.6073,265.0352 L1060.6073,292.0352 M1047.6073,273.0352 L1073.6073,273.0352 M1060.6073,292.0352 L1047.6073,307.0352 M1060.6073,292.0352 L1073.6073,307.0352\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"62.665\" x=\"1015.514\" y=\"322.2803\">Operator</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1078.1791\" y=\"322.2803\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.7168\" x=\"1082.6293\" y=\"322.2803\">/</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1087.3461\" y=\"322.2803\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"13.9043\" x=\"1091.7963\" y=\"322.2803\">CI</text></g><!-- (SVG truncated in this field for brevity in display; it is valid SVG as returned by the renderer.) --></g></svg>",
  "architecture_description": "## High-level architecture\n\nThis repository defines **Prefect 2** workflows (Python) intended to be deployed and executed on **AWS ECS Fargate**, with flow code packaged to and retrieved from **Amazon S3** via a Prefect **storage block** (evidenced by `flows/log-flow-agent-ecs.yaml` and README).\n\n### Main components\n\n1. **Prefect Orchestration (Prefect Cloud or Prefect Server)**\n   - Acts as the control plane: stores deployments, schedules runs, and tracks state.\n   - Prefect agents poll this API for work and report run state/metadata.\n\n2. **Operator / CI**\n   - Registers deployments using `prefect deploy`.\n   - Uploads the flow package to S3 (as configured by the Prefect storage block).\n\n3. **AWS ECS Fargate (in a VPC / private subnets)**\n   - **Prefect Agent (Fargate task / service)**: long-running agent that polls Prefect for queued runs.\n   - **Flow Run Tasks (Fargate tasks)**: ephemeral tasks started for each flow run; execute Python code using Prefect 2 and dependencies like `pandas`, `s3fs`, and `sqlalchemy`.\n   - **Optional Dask execution layer**: if enabled via `prefect-dask`, flow runs can submit distributed work to a Dask cluster (modeled as additional ECS tasks).\n\n4. **Amazon S3 bucket (Prefect storage block)**\n   - Stores packaged flow code and potentially run artifacts.\n   - Flow run tasks read flow code from S3 at runtime and may write artifacts/results back.\n\n5. **Optional Database (via SQLAlchemy)**\n   - The repo includes `sqlalchemy` but no concrete DB configuration; modeled as an optional external database (commonly RDS Postgres).\n   - Flow run tasks may read/write data if configured.\n\n### Key relationships / runtime flow\n- Operator/CI registers deployments with Prefect and uploads flow code to S3.\n- Prefect Orchestrator assigns work; the ECS-based Prefect Agent polls for runs.\n- The agent starts ECS Fargate tasks for flow runs.\n- Flow run tasks communicate back to Prefect for heartbeats/state updates and interact with S3 (and optionally a DB and/or Dask)."
}