{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\ntitle High-level Deployment Architecture (Aiven-managed data platform)\n\nskinparam shadowing false\nskinparam componentStyle rectangle\nskinparam wrapWidth 220\nskinparam maxMessageSize 120\n\nnode \"User Workstation / Analyst\" as ws {\n  artifact \"Jupyter Notebook\\n(Python)\\n- clickhouse_driver\\n- aiven-client\\n- folium\\n- python-dotenv\" as nb\n  artifact \"Shell scripts\\n(Aiven CLI)\" as sh\n  artifact \"Docker runtime\" as docker\n  artifact \"clickhouse/clickhouse-client\\n(container)\" as chclient\n}\n\ncloud \"Internet\" as internet\n\nnode \"Aiven (Managed Services)\" as aiven {\n  node \"Aiven for Kafka\\n(Apache Kafka)\" as kafka {\n    queue \"Topics\" as topics\n  }\n\n  node \"Aiven for ClickHouse\\n(ClickHouse)\" as ch {\n    database \"Analytics DB\" as chdb\n    artifact \"Kafka integration table\\n(ingestion)\" as chint\n    artifact \"Materialized View\\n(from scripts/create_clickhouse_view.sql)\" as chmv\n  }\n\n  node \"Aiven for PostgreSQL\\n(PostgreSQL)\" as pg {\n    database \"Relational DB\\n(schema + seed)\" as pgdb\n  }\n}\n\nnode \"External Realtime Data Source\" as ext {\n  component \"Digitransit Realtime API\\n(HTTP/JSON)\" as digi\n}\n\n' Data flow\nnb --> digi : Fetch realtime data (HTTP)\nnb --> pgdb : Read/Write reference data\\n(SQL)\nnb --> topics : Produce events\\n(Kafka protocol)\n\n' Managed integration\nchint ..> topics : ClickHouse-Kafka\\nservice integration\\n(consumer)\nchmv ..> chint : Transform/aggregate\\n(materialized view)\nchmv ..> chdb : Persist analytics tables\n\n' Ops / provisioning\nsh --> aiven : avn CLI\\ncreate/update services\\n+ integrations\n\n' Local client access\ndocker --> chclient : docker run\nchclient --> chdb : Query ClickHouse\\n(native protocol)\n\n@enduml",
  "svg_diagram": "<?plantuml 1.2026.2beta1?><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" contentStyleType=\"text/css\" data-diagram-type=\"DESCRIPTION\" height=\"881px\" preserveAspectRatio=\"none\" style=\"width:1786px;height:881px;background:#FFFFFF;\" version=\"1.1\" viewBox=\"0 0 1786 881\" width=\"1786px\" zoomAndPan=\"magnify\"><title>High-level Deployment Architecture (Aiven-managed data platform)</title><defs/><g><g class=\"title\" data-source-line=\"4\"><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"537.7559\" x=\"617.2402\" y=\"22.9951\">High-level Deployment Architecture (Aiven-managed data platform)</text></g><!--cluster ws--><g class=\"cluster\" data-qualified-name=\"ws\" data-source-line=\"11\" id=\"ent0002\"><polygon fill=\"#FFFFFF\" points=\"114.2362,53.2969,124.2362,43.2969,632.2362,43.2969,632.2362,496.8169,622.2362,506.8169,114.2362,506.8169,114.2362,53.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"622.2362\" x2=\"632.2362\" y1=\"53.2969\" y2=\"43.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"114.2362\" x2=\"622.2362\" y1=\"53.2969\" y2=\"53.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"622.2362\" x2=\"622.2362\" y1=\"53.2969\" y2=\"506.8169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"211.8594\" x=\"263.3065\" y=\"69.292\">User Workstation / Analyst</text></g><!--cluster aiven--><g class=\"cluster\" data-qualified-name=\"aiven\" data-source-line=\"20\" id=\"ent0008\"><polygon fill=\"#FFFFFF\" points=\"664.2362,325.0769,674.2362,315.0769,1370.2362,315.0769,1370.2362,854.8569,1360.2362,864.8569,664.2362,864.8569,664.2362,325.0769\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1360.2362\" x2=\"1370.2362\" y1=\"325.0769\" y2=\"315.0769\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"664.2362\" x2=\"1360.2362\" y1=\"325.0769\" y2=\"325.0769\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1360.2362\" x2=\"1360.2362\" y1=\"325.0769\" y2=\"864.8569\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"205.6318\" x=\"910.4203\" y=\"341.072\">Aiven (Managed Services)</text></g><!--cluster kafka--><g class=\"cluster\" data-qualified-name=\"aiven.kafka\" data-source-line=\"21\" id=\"ent0009\"><polygon fill=\"#FFFFFF\" points=\"1050.2362,744.5569,1060.2362,734.5569,1247.2362,734.5569,1247.2362,822.8569,1237.2362,832.8569,1050.2362,832.8569,1050.2362,744.5569\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1237.2362\" x2=\"1247.2362\" y1=\"744.5569\" y2=\"734.5569\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1050.2362\" x2=\"1237.2362\" y1=\"744.5569\" y2=\"744.5569\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1237.2362\" x2=\"1237.2362\" y1=\"744.5569\" y2=\"832.8569\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"121.7275\" x=\"1083.8725\" y=\"760.552\">Aiven for Kafka</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"120.8799\" x=\"1084.2963\" y=\"776.8489\">(Apache Kafka)</text></g><!--cluster ch--><g class=\"cluster\" data-qualified-name=\"aiven.ch\" data-source-line=\"25\" id=\"ent0011\"><polygon fill=\"#FFFFFF\" points=\"696.2362,381.0769,706.2362,371.0769,1062.2362,371.0769,1062.2362,649.5569,1052.2362,659.5569,696.2362,659.5569,696.2362,381.0769\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1052.2362\" x2=\"1062.2362\" y1=\"381.0769\" y2=\"371.0769\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"696.2362\" x2=\"1052.2362\" y1=\"381.0769\" y2=\"381.0769\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1052.2362\" x2=\"1052.2362\" y1=\"381.0769\" y2=\"659.5569\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"163.1943\" x=\"793.6391\" y=\"397.072\">Aiven for ClickHouse</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"99.4082\" x=\"825.5321\" y=\"413.3689\">(ClickHouse)</text></g><!--cluster pg--><g class=\"cluster\" data-qualified-name=\"aiven.pg\" data-source-line=\"31\" id=\"ent0015\"><polygon fill=\"#FFFFFF\" points=\"1086.2362,386.2269,1096.2362,376.2269,1330.2362,376.2269,1330.2362,499.8169,1320.2362,509.8169,1086.2362,509.8169,1086.2362,386.2269\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1320.2362\" x2=\"1330.2362\" y1=\"386.2269\" y2=\"376.2269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1086.2362\" x2=\"1320.2362\" y1=\"386.2269\" y2=\"386.2269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1320.2362\" x2=\"1320.2362\" y1=\"386.2269\" y2=\"509.8169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"168.8135\" x=\"1119.8295\" y=\"402.222\">Aiven for PostgreSQL</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"105.0273\" x=\"1151.7226\" y=\"418.5189\">(PostgreSQL)</text></g><!--cluster ext--><g class=\"cluster\" data-qualified-name=\"ext\" data-source-line=\"36\" id=\"ent0017\"><polygon fill=\"#FFFFFF\" points=\"1451.2362,406.7269,1461.2362,396.7269,1769.2362,396.7269,1769.2362,495.3169,1759.2362,505.3169,1451.2362,505.3169,1451.2362,406.7269\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1759.2362\" x2=\"1769.2362\" y1=\"406.7269\" y2=\"396.7269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1451.2362\" x2=\"1759.2362\" y1=\"406.7269\" y2=\"406.7269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1759.2362\" x2=\"1759.2362\" y1=\"406.7269\" y2=\"505.3169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"242.1904\" x=\"1485.141\" y=\"422.722\">External Realtime Data Source</text></g><!--entity nb--><g class=\"entity\" data-qualified-name=\"ws.nb\" data-source-line=\"12\" id=\"ent0003\"><rect fill=\"#FFFFFF\" height=\"120.7813\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"161.1885\" x=\"454.6362\" y=\"83.2969\"/><polygon fill=\"#FFFFFF\" points=\"598.8247,88.2969,598.8247,102.2969,610.8247,102.2969,610.8247,94.2969,604.8247,88.2969,598.8247,88.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"604.8247\" x2=\"604.8247\" y1=\"88.2969\" y2=\"94.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"610.8247\" x2=\"604.8247\" y1=\"94.2969\" y2=\"94.2969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"50.0322\" x=\"469.3564\" y=\"109.292\">Jupyter</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"519.3887\" y=\"109.292\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"67.2656\" x=\"523.8389\" y=\"109.292\">Notebook</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"59.4521\" x=\"500.5044\" y=\"125.5889\">(Python)</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"5.0518\" x=\"464.6362\" y=\"141.8857\">-</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"469.688\" y=\"141.8857\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"121.6865\" x=\"474.1382\" y=\"141.8857\">clickhouse_driver</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"5.0518\" x=\"484.6074\" y=\"158.1826\">-</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"489.6592\" y=\"158.1826\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"81.7441\" x=\"494.1094\" y=\"158.1826\">aiven-client</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"5.0518\" x=\"503.5874\" y=\"174.4795\">-</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"508.6392\" y=\"174.4795\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"43.7842\" x=\"513.0894\" y=\"174.4795\">folium</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"5.0518\" x=\"474.1108\" y=\"190.7764\">-</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"479.1626\" y=\"190.7764\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"102.7373\" x=\"483.6128\" y=\"190.7764\">python-dotenv</text></g><!--entity sh--><g class=\"entity\" data-qualified-name=\"ws.sh\" data-source-line=\"13\" id=\"ent0004\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"114.9092\" x=\"304.7762\" y=\"115.8869\"/><polygon fill=\"#FFFFFF\" points=\"402.6854,120.8869,402.6854,134.8869,414.6854,134.8869,414.6854,126.8869,408.6854,120.8869,402.6854,120.8869\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"408.6854\" x2=\"408.6854\" y1=\"120.8869\" y2=\"126.8869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"414.6854\" x2=\"408.6854\" y1=\"126.8869\" y2=\"126.8869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"34.1523\" x=\"314.7762\" y=\"141.882\">Shell</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"348.9286\" y=\"141.882\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"46.3066\" x=\"353.3788\" y=\"141.882\">scripts</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"44.7002\" x=\"319.0726\" y=\"158.1789\">(Aiven</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"363.7728\" y=\"158.1789\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"27.166\" x=\"368.223\" y=\"158.1789\">CLI)</text></g><!--entity docker--><g class=\"entity\" data-qualified-name=\"ws.docker\" data-source-line=\"14\" id=\"ent0005\"><rect fill=\"#FFFFFF\" height=\"39.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"139.1016\" x=\"130.6862\" y=\"124.0369\"/><polygon fill=\"#FFFFFF\" points=\"252.7878,129.0369,252.7878,143.0369,264.7878,143.0369,264.7878,135.0369,258.7878,129.0369,252.7878,129.0369\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"258.7878\" x2=\"258.7878\" y1=\"129.0369\" y2=\"135.0369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"264.7878\" x2=\"258.7878\" y1=\"135.0369\" y2=\"135.0369\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"49.5195\" x=\"140.6862\" y=\"150.032\">Docker</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"190.2058\" y=\"150.032\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"55.1318\" x=\"194.656\" y=\"150.032\">runtime</text></g><!--entity chclient--><g class=\"entity\" data-qualified-name=\"ws.chclient\" data-source-line=\"15\" id=\"ent0006\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"225.2207\" x=\"260.6262\" y=\"435.2269\"/><polygon fill=\"#FFFFFF\" points=\"468.8469,440.2269,468.8469,454.2269,480.8469,454.2269,480.8469,446.2269,474.8469,440.2269,468.8469,440.2269\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"474.8469\" x2=\"474.8469\" y1=\"440.2269\" y2=\"446.2269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"480.8469\" x2=\"474.8469\" y1=\"446.2269\" y2=\"446.2269\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"195.2207\" x=\"270.6262\" y=\"461.222\">clickhouse/clickhouse-client</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"77.2598\" x=\"329.6067\" y=\"477.5189\">(container)</text></g><!--entity topics--><g class=\"entity\" data-qualified-name=\"aiven.kafka.topics\" data-source-line=\"22\" id=\"ent0010\"><path d=\"M1120.7962,790.5569 L1175.681,790.5569 C1180.681,790.5569 1180.681,803.7053 1180.681,803.7053 C1180.681,803.7053 1180.681,816.8538 1175.681,816.8538 L1120.7962,816.8538 C1115.7962,816.8538 1115.7962,803.7053 1115.7962,803.7053 C1115.7962,803.7053 1115.7962,790.5569 1120.7962,790.5569\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M1175.681,790.5569 C1170.681,790.5569 1170.681,803.7053 1170.681,803.7053 C1170.681,816.8538 1175.681,816.8538 1175.681,816.8538\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"44.8848\" x=\"1120.7962\" y=\"808.552\">Topics</text></g><!--entity chdb--><g class=\"entity\" data-qualified-name=\"aiven.ch.chdb\" data-source-line=\"26\" id=\"ent0012\"><path d=\"M712.0262,603.1169 C712.0262,593.1169 766.2308,593.1169 766.2308,593.1169 C766.2308,593.1169 820.4354,593.1169 820.4354,603.1169 L820.4354,628.4137 C820.4354,638.4137 766.2308,638.4137 766.2308,638.4137 C766.2308,638.4137 712.0262,638.4137 712.0262,628.4137 L712.0262,603.1169\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M712.0262,603.1169 C712.0262,613.1169 766.2308,613.1169 766.2308,613.1169 C766.2308,613.1169 820.4354,613.1169 820.4354,603.1169\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"63.5742\" x=\"722.0262\" y=\"630.112\">Analytics</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"785.6004\" y=\"630.112\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"20.3848\" x=\"790.0506\" y=\"630.112\">DB</text></g><!--entity chint--><g class=\"entity\" data-qualified-name=\"aiven.ch.chint\" data-source-line=\"27\" id=\"ent0013\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"190.6377\" x=\"855.9162\" y=\"587.9669\"/><polygon fill=\"#FFFFFF\" points=\"1029.5539,592.9669,1029.5539,606.9669,1041.5539,606.9669,1041.5539,598.9669,1035.5539,592.9669,1029.5539,592.9669\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1035.5539\" x2=\"1035.5539\" y1=\"592.9669\" y2=\"598.9669\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1041.5539\" x2=\"1035.5539\" y1=\"598.9669\" y2=\"598.9669\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"39.375\" x=\"865.9162\" y=\"613.962\">Kafka</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"905.2912\" y=\"613.962\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"76.9043\" x=\"909.7414\" y=\"613.962\">integration</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"986.6457\" y=\"613.962\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"35.458\" x=\"991.0959\" y=\"613.962\">table</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"75.2979\" x=\"908.5862\" y=\"630.2589\">(ingestion)</text></g><!--entity chmv--><g class=\"entity\" data-qualified-name=\"aiven.ch.chmv\" data-source-line=\"28\" id=\"ent0014\"><rect fill=\"#FFFFFF\" height=\"71.8906\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"275.4922\" x=\"739.4862\" y=\"427.0769\"/><polygon fill=\"#FFFFFF\" points=\"997.9784,432.0769,997.9784,446.0769,1009.9784,446.0769,1009.9784,438.0769,1003.9784,432.0769,997.9784,432.0769\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1003.9784\" x2=\"1003.9784\" y1=\"432.0769\" y2=\"438.0769\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1009.9784\" x2=\"1003.9784\" y1=\"438.0769\" y2=\"438.0769\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"85.6133\" x=\"810.4354\" y=\"453.072\">Materialized</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"896.0487\" y=\"453.072\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"33.5303\" x=\"900.4989\" y=\"453.072\">View</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"38.3496\" x=\"853.0575\" y=\"469.3689\">(from</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"245.4922\" x=\"749.4862\" y=\"485.6657\">scripts/create_clickhouse_view.sql)</text></g><!--entity pgdb--><g class=\"entity\" data-qualified-name=\"aiven.pg.pgdb\" data-source-line=\"32\" id=\"ent0016\"><path d=\"M1102.4062,442.2269 C1102.4062,432.2269 1172.2344,432.2269 1172.2344,432.2269 C1172.2344,432.2269 1242.0625,432.2269 1242.0625,442.2269 L1242.0625,483.8206 C1242.0625,493.8206 1172.2344,493.8206 1172.2344,493.8206 C1172.2344,493.8206 1102.4062,493.8206 1102.4062,483.8206 L1102.4062,442.2269\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M1102.4062,442.2269 C1102.4062,452.2269 1172.2344,452.2269 1172.2344,452.2269 C1172.2344,452.2269 1242.0625,452.2269 1242.0625,442.2269\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"70.0957\" x=\"1124.769\" y=\"469.222\">Relational</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1194.8647\" y=\"469.222\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"20.3848\" x=\"1199.3149\" y=\"469.222\">DB</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"60.1563\" x=\"1112.4062\" y=\"485.5189\">(schema</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1172.5625\" y=\"485.5189\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"11.7305\" x=\"1177.0127\" y=\"485.5189\">+</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1188.7431\" y=\"485.5189\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"38.8691\" x=\"1193.1933\" y=\"485.5189\">seed)</text></g><!--entity digi--><g class=\"entity\" data-qualified-name=\"ext.digi\" data-source-line=\"37\" id=\"ent0018\"><rect fill=\"#FFFFFF\" height=\"52.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"186.3047\" x=\"1468.0862\" y=\"436.7269\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"72.8164\" x=\"1478.0862\" y=\"459.722\">Digitransit</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1550.9026\" y=\"459.722\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"62.4395\" x=\"1555.3528\" y=\"459.722\">Realtime</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1617.7923\" y=\"459.722\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"22.1484\" x=\"1622.2425\" y=\"459.722\">API</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"86.2217\" x=\"1518.1277\" y=\"476.0189\">(HTTP/JSON)</text></g><!--entity internet--><g class=\"entity\" data-qualified-name=\"internet\" data-source-line=\"18\" id=\"ent0007\"><path d=\"M20.088,129.4175 C23.1837,124.3834 27.1123,124.1183 30.9197,128.6081 C34.0278,122.4362 38.372,122.5369 42.6137,127.4076 C45.5297,122.085 49.7975,121.6076 53.3775,126.7229 C57.126,121.7985 60.9829,120.6978 64.9703,126.4639 C70.0134,121.2005 74.2445,121.3492 77.0869,128.5955 C81.1445,123.428 85.8023,123.7025 89.4887,129.034 C96.8266,131.8734 98.5639,139.2295 92.2491,144.5049 C98.0537,150.9065 97.8993,155.9902 89.9033,160.3484 C87.9491,166.509 82.4152,166.9171 78.6664,162.2027 C75.7266,170.476 71.2594,171.518 65.1354,165.1443 C64.2031,170.8605 59.5096,173.0434 54.6217,169.771 C50.0236,173.9692 44.7405,173.4293 42.7783,166.8692 C36.2585,171.7047 33.0334,169.0706 30.8261,162.3924 C26.6178,166.848 21.5506,166.3796 18.8789,160.5989 C9.2209,159.6262 6,152.4027 12.5961,144.9177 C6.4792,135.9354 9.572,130.3604 20.088,129.4175\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"55.8359\" x=\"25.3162\" y=\"148.532\">Internet</text></g><!--link nb to digi--><g class=\"link\" data-entity-1=\"ent0003\" data-entity-2=\"ent0018\" data-link-type=\"dependency\" data-source-line=\"41\" id=\"lnk19\"><path d=\"M616.1662,148.3069 C825.5462,158.2969 1373.5362,188.5269 1441.2362,234.0769 C1513.0362,282.3869 1543.493,382.0515 1554.753,430.6915\" fill=\"none\" id=\"nb-to-digi\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"1556.1062,436.5369,1557.9734,426.8666,1554.9786,431.6657,1550.1795,428.6709,1556.1062,436.5369\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"33.1934\" x=\"1495.2362\" y=\"260.2155\">Fetch</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1528.4296\" y=\"260.2155\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"50.1152\" x=\"1532.244\" y=\"260.2155\">realtime</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1582.3593\" y=\"260.2155\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"27.0293\" x=\"1586.1737\" y=\"260.2155\">data</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"40.2832\" x=\"1534.078\" y=\"274.1843\">(HTTP)</text></g><!--link nb to pgdb--><g class=\"link\" data-entity-1=\"ent0003\" data-entity-2=\"ent0016\" data-link-type=\"dependency\" data-source-line=\"42\" id=\"lnk20\"><path d=\"M615.8962,151.2769 C726.2062,163.8269 925.9762,199.5269 1062.2362,299.0769 C1109.4962,333.6069 1140.3085,389.5515 1157.1385,426.3115\" fill=\"none\" id=\"nb-to-pgdb\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"1159.6362,431.7669,1159.5267,421.9186,1157.5548,427.2207,1152.2528,425.2489,1159.6362,431.7669\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"66.9551\" x=\"1062.0937\" y=\"253.2155\">Read/Write</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"57.8262\" x=\"1051.2362\" y=\"267.1843\">reference</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1109.0624\" y=\"267.1843\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"27.0293\" x=\"1112.8769\" y=\"267.1843\">data</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"33.1113\" x=\"1079.0155\" y=\"281.153\">(SQL)</text></g><!--link nb to topics--><g class=\"link\" data-entity-1=\"ent0003\" data-entity-2=\"ent0010\" data-link-type=\"dependency\" data-source-line=\"43\" id=\"lnk21\"><path d=\"M616.2362,146.2869 C809.2562,152.0569 1287.0062,178.4869 1378.2362,299.0769 C1509.0162,471.9369 1235.462,727.0977 1167.342,786.3877\" fill=\"none\" id=\"nb-to-topics\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"1162.8162,790.3269,1172.2311,787.4353,1166.5877,787.0442,1166.9788,781.4009,1162.8162,790.3269\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"48.7148\" x=\"1379.827\" y=\"541.1055\">Produce</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1428.5419\" y=\"541.1055\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"40.4297\" x=\"1432.3563\" y=\"541.1055\">events</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"38.4316\" x=\"1378.2362\" y=\"555.0743\">(Kafka</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1416.6679\" y=\"555.0743\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"53.8945\" x=\"1420.4823\" y=\"555.0743\">protocol)</text></g><!--link chint to topics--><g class=\"link\" data-entity-1=\"ent0013\" data-entity-2=\"ent0010\" data-link-type=\"dependency\" data-source-line=\"46\" id=\"lnk22\"><path d=\"M979.8762,643.7969 C1023.2062,684.6969 1099.3127,756.5387 1130.7827,786.2387\" fill=\"none\" id=\"chint-to-topics\" style=\"stroke:#000000;stroke-width:2;stroke-dasharray:7,7;\"/><polygon fill=\"#000000\" points=\"1135.1462,790.3569,1131.3463,781.2706,1131.5099,786.9251,1125.8554,787.0887,1135.1462,790.3569\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"104.2793\" x=\"1060.455\" y=\"687.6955\">ClickHouse-Kafka</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"42.9844\" x=\"1056.2362\" y=\"701.6643\">service</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1099.2206\" y=\"701.6643\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"65.918\" x=\"1103.0351\" y=\"701.6643\">integration</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"68.7715\" x=\"1078.2089\" y=\"715.633\">(consumer)</text></g><!--link chmv to chint--><g class=\"link\" data-entity-1=\"ent0014\" data-entity-2=\"ent0013\" data-link-type=\"dependency\" data-source-line=\"47\" id=\"lnk23\"><path d=\"M894.5862,499.3669 C907.8262,526.3369 923.1505,557.5717 935.2805,582.2617\" fill=\"none\" id=\"chmv-to-chint\" style=\"stroke:#000000;stroke-width:2;stroke-dasharray:7,7;\"/><polygon fill=\"#000000\" points=\"937.9262,587.6469,937.5478,577.8053,935.7215,583.1592,930.3676,581.3329,937.9262,587.6469\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"127.6699\" x=\"923.2362\" y=\"541.1055\">Transform/aggregate</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"79.4004\" x=\"929.3065\" y=\"555.0743\">(materialized</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1008.7069\" y=\"555.0743\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"32.3145\" x=\"1012.5214\" y=\"555.0743\">view)</text></g><!--link chmv to chdb--><g class=\"link\" data-entity-1=\"ent0014\" data-entity-2=\"ent0012\" data-link-type=\"dependency\" data-source-line=\"48\" id=\"lnk24\"><path d=\"M829.9262,499.1269 C819.9062,508.0769 810.0162,518.2269 802.2362,528.9669 C788.0162,548.5869 779.9059,568.9463 774.1359,587.1863\" fill=\"none\" id=\"chmv-to-chdb\" style=\"stroke:#000000;stroke-width:2;stroke-dasharray:7,7;\"/><polygon fill=\"#000000\" points=\"772.3262,592.9069,778.8544,585.5324,773.8343,588.1397,771.227,583.1196,772.3262,592.9069\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"40.0957\" x=\"803.2362\" y=\"541.1055\">Persist</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"843.3319\" y=\"541.1055\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"53.6367\" x=\"847.1464\" y=\"541.1055\">analytics</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"36.6445\" x=\"833.6874\" y=\"555.0743\">tables</text></g><!--link sh to aiven--><g class=\"link\" data-entity-1=\"ent0004\" data-entity-2=\"ent0008\" data-link-type=\"dependency\" data-source-line=\"51\" id=\"lnk25\"><path d=\"M390.0162,171.8569 C403.3162,183.4369 420.0662,196.0869 437.2362,204.0769 C612.4262,285.6169 671.1762,269.6969 863.2362,291.0769 C885.0462,293.5069 1239.0962,288.3369 1258.2362,299.0769 C1262.8456,301.6637 1267.2815,304.5491 1271.5477,307.6864 C1273.6808,309.2551 1275.7716,310.8867 1277.8204,312.5755 C1278.3326,312.9977 1278.8421,313.4235 1279.3491,313.8528 C1279.6026,314.0674 1275.3017,310.376 1275.5539,310.5924\" fill=\"none\" id=\"sh-to-aiven\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"1280.1076,314.4993,1275.8817,305.6031,1276.3129,311.2435,1270.6725,311.6747,1280.1076,314.4993\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"22.0605\" x=\"885.0165\" y=\"246.2155\">avn</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"907.077\" y=\"246.2155\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"18.6035\" x=\"910.8915\" y=\"246.2155\">CLI</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"84.6797\" x=\"864.9159\" y=\"260.1843\">create/update</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"49.2363\" x=\"882.6376\" y=\"274.153\">services</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"10.0547\" x=\"864.2362\" y=\"288.1218\">+</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"874.2909\" y=\"288.1218\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"72.1699\" x=\"878.1054\" y=\"288.1218\">integrations</text></g><!--link docker to chclient--><g class=\"link\" data-entity-1=\"ent0005\" data-entity-2=\"ent0006\" data-link-type=\"dependency\" data-source-line=\"54\" id=\"lnk26\"><path d=\"M209.6562,163.7869 C223.6062,191.8769 250.7262,245.8969 275.2362,291.0769 C303.1262,342.4969 334.4409,396.3272 354.1809,429.8372\" fill=\"none\" id=\"docker-to-chclient\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"357.2262,435.0069,356.1047,425.2221,354.6884,430.6988,349.2117,429.2826,357.2262,435.0069\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"40.8223\" x=\"276.2362\" y=\"267.2155\">docker</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"317.0585\" y=\"267.2155\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"20.1445\" x=\"320.8729\" y=\"267.2155\">run</text></g><!--link chclient to chdb--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0012\" data-link-type=\"dependency\" data-source-line=\"55\" id=\"lnk27\"><path d=\"M443.9462,491.1469 C520.7462,520.5969 636.1543,564.8677 705.9843,591.6577\" fill=\"none\" id=\"chclient-to-chdb\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"711.5862,593.8069,704.6162,586.8486,706.918,592.0159,701.7506,594.3178,711.5862,593.8069\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"36.4688\" x=\"617.2362\" y=\"541.1055\">Query</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"653.705\" y=\"541.1055\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"66.1992\" x=\"657.5194\" y=\"541.1055\">ClickHouse</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"42.1641\" x=\"620.5409\" y=\"555.0743\">(native</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"662.705\" y=\"555.0743\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"53.8945\" x=\"666.5194\" y=\"555.0743\">protocol)</text></g><?plantuml-src TLHDRziu4BthLqnpQOn2LffZ3WkuoHP9cxHkdMqk0OenDP88KwHAKdBSHV_x3adBbbliIIBvvitNctbLKYKrmU9fjUnR1OttdRig2elRUIrzqwzxHrOOxKdxkJ1jWLkdSEt2DvVyuFBAsBnJg3qJ5CFbnVoYAANpsIkfXUhB0td1tslJjaRFEpvccPTU4TpAkiaL3QJWXZfbTYsxWeKLZVGaV6y9pXTo89stgB6c4ahq2EpHi-TsbcLk8tM75bjm3PPcAtKD5If7anSElJEQcLT-nqujCwEkrHIojTWzoT8tS7bvCRblyUM1d6FNA_cJu2q_PjfmNcV_S6tWoTYDy-YbqL30GgFQENy6w63huDyC0AsN5GeFPn_wRkVPv9Fnj3PcywpFbplV63rxrZa89SMcCLpmxwNbX6sun9WvFt7euLmP9Vis_7NHCY-PIm_HdrwVU5irf1GuOMNd7RkAHOJh-xjPHBlc17rZn8P3ixtsigM8AEFL2UeOOt7yFOHt7eI2h2URN8WclMI_iameqvTmTiTAiffIWUJ-CDOpHNZ-iE_pYkmW1Rb45YiH2pe5imJW8rOR30bsA1fAnsIp2R_H1k17JpsRFPfE2XTVVVpbHmxlJzRhaDzjo8-fZuSniprhqE8QNR0CdVTC23VlzfXo7J77yiNGOjgrJOfXQnKSi6R9XPkHdq6_6JyWLqkYOX6My4tIbiqgQzgnnOMmn93l4nqDZ9gx7seaROV_otPfdAyjhRxS1r4U3icmg__8zYkfc03orBvZ4yULRn7UW2CgHwkO_w_G_UJkxvVGRpRvIgY2pE0cZFBAz5OaoT6BZwuEuyh2bBo8B6ed_T5kiRnZfxUFZylYm-hpf-ImP6HmzZhHLifiCxs6FFyhFi4Ll2VFdRCZIrmaaMKs0aFG36H7PV5aUGCnkY9BMYGuUmrb6U59GcomjARi6SDxJCTfIwtkhF5663KBKOswdlG_Yus6-Nn2TTHQlbUsIuCmDKp3vlgMPoqBZOqSYUqA7aEzmdOiiEP6rYmBDcYd0WhIEB6CUI_9EjxTW0SnHu6w4Fxdpl62uum6wJW2LcpccbY5D9fNW4FSByywAR7eEouPmJvyhigRQGgHzDu8raDQ4u22KIvBUoSoZnk4oSl3WieEjmaI8__IazsT3grcDmCTU_0V?></g></svg>",
  "architecture_description": "## High-level architecture\n\nThis codebase is a notebook-driven analytics/streaming demo that provisions and uses **Aiven-managed Kafka, ClickHouse, and PostgreSQL**, and enriches/visualizes data from an **external realtime API**.\n\n### Components\n\n1. **User Workstation / Analyst environment**\n   - **Jupyter Notebook (Python)**: primary “application” layer used to fetch realtime data, run analytics, and interact with managed services.\n     - Key libs: `clickhouse_driver` (ClickHouse queries), `aiven-client` (Aiven API), `python-dotenv` (config/secrets), `folium` (map visualization).\n   - **Shell scripts + Aiven CLI**: operational/provisioning layer.\n     - Creates/updates Aiven services and configures the **ClickHouse–Kafka integration** (`avn service integration-create` / `integration-update`).\n   - **Docker runtime**: used to run `clickhouse/clickhouse-client` locally for ad-hoc querying against Aiven ClickHouse.\n\n2. **Aiven (Managed Services)**\n   - **Aiven for Kafka (Apache Kafka)**: hosts topics that receive events produced by the notebook.\n   - **Aiven for ClickHouse (ClickHouse)**:\n     - **Kafka integration table**: ClickHouse-side ingestion surface that reads from Kafka topics via Aiven’s managed integration.\n     - **Materialized View**: created by `scripts/create_clickhouse_view.sql` to transform/aggregate streaming data into analytics tables.\n     - **Analytics DB**: persisted ClickHouse tables used for querying.\n   - **Aiven for PostgreSQL (PostgreSQL)**:\n     - Stores relational/reference data; schema and seed data are created by `scripts/create_postgres_schema.sql`.\n\n3. **External Realtime Data Source**\n   - **Digitransit Realtime API (HTTP/JSON)**: upstream data source consumed by the notebook.\n\n### Key relationships / data flows\n\n- The **Jupyter notebook** pulls realtime data from **Digitransit** over HTTP.\n- The notebook writes/reads reference data in **PostgreSQL** (SQL).\n- The notebook produces events into **Kafka topics**.\n- **Aiven ClickHouse–Kafka integration** enables ClickHouse to consume from Kafka into an integration table.\n- A **ClickHouse materialized view** transforms the ingested stream and persists results into ClickHouse analytics tables.\n- A local **clickhouse-client container** can query the ClickHouse analytics DB for validation and exploration.\n- **Aiven CLI scripts** manage lifecycle and configuration of services and integrations."
}