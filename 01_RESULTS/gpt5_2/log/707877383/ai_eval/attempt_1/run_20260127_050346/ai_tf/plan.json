{"format_version":"1.2","terraform_version":"1.13.5","variables":{"aws_region":{"value":"us-east-1"},"az_count":{"value":2},"container_command":{"value":[]},"container_image":{"value":"ai-tf"},"create_ecs_service":{"value":false},"enable_nat_gateway_ha":{"value":false},"environment":{"value":"dev"},"log_retention_days":{"value":14},"project_name":{"value":"proxy-http-client"},"schedule_expression":{"value":"rate(1 hour)"},"secrets_json":{"value":"ai-tf"},"sns_email":{"value":""},"tags":{"value":{}},"task_cpu":{"value":256},"task_desired_count":{"value":0},"task_memory":{"value":512},"vpc_cidr":{"value":"10.20.0.0/16"}},"planned_values":{"outputs":{"cloudwatch_log_group_name":{"sensitive":false,"type":"string","value":"/ecs/proxy-http-client-dev"},"ecs_cluster_name":{"sensitive":false,"type":"string","value":"proxy-http-client-dev-cluster"},"ecs_task_definition_arn":{"sensitive":false},"eventbridge_rule_name":{"sensitive":false,"type":"string","value":"proxy-http-client-dev-schedule"},"private_subnet_ids":{"sensitive":false},"secrets_manager_secret_arn":{"sensitive":false},"sns_topic_arn":{"sensitive":false},"vpc_id":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_cloudwatch_event_rule.schedule","mode":"managed","type":"aws_cloudwatch_event_rule","name":"schedule","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Schedule to run proxy-http-client-dev ECS task","event_bus_name":"default","event_pattern":null,"force_destroy":false,"is_enabled":null,"name":"proxy-http-client-dev-schedule","region":"us-east-1","role_arn":null,"schedule_expression":"rate(1 hour)","state":null,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"sensitive_values":{"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null,"region":null}},{"address":"aws_cloudwatch_event_target.ecs","mode":"managed","type":"aws_cloudwatch_event_target","name":"ecs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"appsync_target":[],"batch_target":[],"dead_letter_config":[],"ecs_target":[{"capacity_provider_strategy":[],"enable_ecs_managed_tags":false,"enable_execute_command":false,"group":null,"launch_type":"FARGATE","network_configuration":[{"assign_public_ip":false}],"ordered_placement_strategy":[],"placement_constraint":[],"platform_version":"LATEST","propagate_tags":null,"tags":null,"task_count":1}],"event_bus_name":"default","force_destroy":false,"http_target":[],"input":null,"input_path":null,"input_transformer":[],"kinesis_target":[],"redshift_target":[],"region":"us-east-1","retry_policy":[],"rule":"proxy-http-client-dev-schedule","run_command_targets":[],"sagemaker_pipeline_target":[],"sqs_target":[],"target_id":"ecs"},"sensitive_values":{"appsync_target":[],"batch_target":[],"dead_letter_config":[],"ecs_target":[{"capacity_provider_strategy":[],"network_configuration":[{"security_groups":[],"subnets":[]}],"ordered_placement_strategy":[],"placement_constraint":[]}],"http_target":[],"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"run_command_targets":[],"sagemaker_pipeline_target":[],"sqs_target":[]},"identity_schema_version":0,"identity":{"account_id":null,"event_bus_name":null,"region":null,"rule":null,"target_id":null}},{"address":"aws_cloudwatch_log_group.task","mode":"managed","type":"aws_cloudwatch_log_group","name":"task","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"kms_key_id":null,"name":"/ecs/proxy-http-client-dev","region":"us-east-1","retention_in_days":14,"skip_destroy":false,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"sensitive_values":{"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null,"region":null}},{"address":"aws_cloudwatch_metric_alarm.eventbridge_failed_invocations","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"eventbridge_failed_invocations","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_description":"EventBridge failed invocations for scheduled ECS task","alarm_name":"proxy-http-client-dev-schedule-failed-invocations","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"RuleName":"proxy-http-client-dev-schedule"},"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"FailedInvocations","metric_query":[],"namespace":"AWS/Events","ok_actions":null,"period":300,"region":"us-east-1","statistic":"Sum","tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"},"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"sensitive_values":{"alarm_actions":[],"dimensions":{},"metric_query":[],"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"alarm_name":null,"region":null}},{"address":"aws_ecs_cluster.this","mode":"managed","type":"aws_ecs_cluster","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"configuration":[],"name":"proxy-http-client-dev-cluster","region":"us-east-1","service_connect_defaults":[],"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"sensitive_values":{"configuration":[],"service_connect_defaults":[],"setting":[],"tags_all":{}}},{"address":"aws_ecs_task_definition.this","mode":"managed","type":"aws_ecs_task_definition","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"cpu":"256","ephemeral_storage":[],"family":"proxy-http-client-dev","ipc_mode":null,"memory":"512","network_mode":"awsvpc","pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"region":"us-east-1","requires_compatibilities":["FARGATE"],"runtime_platform":[],"skip_destroy":false,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"},"track_latest":false,"volume":[]},"sensitive_values":{"ephemeral_storage":[],"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"runtime_platform":[],"tags_all":{},"volume":[]}},{"address":"aws_eip.nat[\"single\"]","mode":"managed","type":"aws_eip","name":"nat","index":"single","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"address":null,"associate_with_private_ip":null,"customer_owned_ipv4_pool":null,"domain":"vpc","region":"us-east-1","tags":{"Name":"proxy-http-client-dev-nat-eip-single"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-nat-eip-single","Project":"proxy-http-client"},"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"aws_iam_policy.events_invoke_ecs","mode":"managed","type":"aws_iam_policy","name":"events_invoke_ecs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"delay_after_policy_creation_in_ms":null,"description":"Allow EventBridge to run ECS task.","name":"proxy-http-client-dev-events-invoke-ecs","path":"/","tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"sensitive_values":{"tags_all":{}},"identity_schema_version":0,"identity":{"arn":null}},{"address":"aws_iam_policy.task_secrets","mode":"managed","type":"aws_iam_policy","name":"task_secrets","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"delay_after_policy_creation_in_ms":null,"description":"Allow ECS task to read app config secret.","name":"proxy-http-client-dev-task-secrets","path":"/","tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"sensitive_values":{"tags_all":{}},"identity_schema_version":0,"identity":{"arn":null}},{"address":"aws_iam_role.events_invoke_ecs","mode":"managed","type":"aws_iam_role","name":"events_invoke_ecs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"events.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"proxy-http-client-dev-events-invoke-ecs","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null}},{"address":"aws_iam_role.task","mode":"managed","type":"aws_iam_role","name":"task","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"proxy-http-client-dev-ecs-task","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null}},{"address":"aws_iam_role.task_execution","mode":"managed","type":"aws_iam_role","name":"task_execution","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"proxy-http-client-dev-ecs-task-exec","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null}},{"address":"aws_iam_role_policy_attachment.events_invoke_ecs","mode":"managed","type":"aws_iam_role_policy_attachment","name":"events_invoke_ecs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"proxy-http-client-dev-events-invoke-ecs"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"policy_arn":null,"role":null}},{"address":"aws_iam_role_policy_attachment.task_execution","mode":"managed","type":"aws_iam_role_policy_attachment","name":"task_execution","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy","role":"proxy-http-client-dev-ecs-task-exec"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"policy_arn":null,"role":null}},{"address":"aws_iam_role_policy_attachment.task_secrets","mode":"managed","type":"aws_iam_role_policy_attachment","name":"task_secrets","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"proxy-http-client-dev-ecs-task"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"policy_arn":null,"role":null}},{"address":"aws_internet_gateway.this","mode":"managed","type":"aws_internet_gateway","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-igw"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-igw","Project":"proxy-http-client"},"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"aws_kms_alias.secrets","mode":"managed","type":"aws_kms_alias","name":"secrets","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"alias/proxy-http-client-dev-secrets","region":"us-east-1"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"name":null,"region":null}},{"address":"aws_kms_key.secrets","mode":"managed","type":"aws_kms_key","name":"secrets","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bypass_policy_lockout_safety_check":false,"custom_key_store_id":null,"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":7,"description":"KMS key for proxy-http-client-dev secrets","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","region":"us-east-1","tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"},"timeouts":null,"xks_key_id":null},"sensitive_values":{"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_nat_gateway.this[\"single\"]","mode":"managed","type":"aws_nat_gateway","name":"this","index":"single","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"availability_zone_address":[],"connectivity_type":"public","region":"us-east-1","tags":{"Name":"proxy-http-client-dev-nat-single"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-nat-single","Project":"proxy-http-client"},"timeouts":null},"sensitive_values":{"availability_zone_address":[],"regional_nat_gateway_address":[],"secondary_allocation_ids":[],"secondary_private_ip_addresses":[],"tags":{},"tags_all":{}}},{"address":"aws_route.private_default[\"us-east-1a\"]","mode":"managed","type":"aws_route","name":"private_default","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"carrier_gateway_id":null,"core_network_arn":null,"destination_cidr_block":"0.0.0.0/0","destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"egress_only_gateway_id":null,"gateway_id":null,"local_gateway_id":null,"region":"us-east-1","timeouts":null,"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"destination_cidr_block":null,"destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"region":null,"route_table_id":null}},{"address":"aws_route.private_default[\"us-east-1b\"]","mode":"managed","type":"aws_route","name":"private_default","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"carrier_gateway_id":null,"core_network_arn":null,"destination_cidr_block":"0.0.0.0/0","destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"egress_only_gateway_id":null,"gateway_id":null,"local_gateway_id":null,"region":"us-east-1","timeouts":null,"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"destination_cidr_block":null,"destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"region":null,"route_table_id":null}},{"address":"aws_route.public_internet","mode":"managed","type":"aws_route","name":"public_internet","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"carrier_gateway_id":null,"core_network_arn":null,"destination_cidr_block":"0.0.0.0/0","destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"egress_only_gateway_id":null,"local_gateway_id":null,"nat_gateway_id":null,"region":"us-east-1","timeouts":null,"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"destination_cidr_block":null,"destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"region":null,"route_table_id":null}},{"address":"aws_route_table.private[\"us-east-1a\"]","mode":"managed","type":"aws_route_table","name":"private","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-private-rt-us-east-1a"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-private-rt-us-east-1a","Project":"proxy-http-client"},"timeouts":null},"sensitive_values":{"propagating_vgws":[],"route":[],"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_route_table.private[\"us-east-1b\"]","mode":"managed","type":"aws_route_table","name":"private","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-private-rt-us-east-1b"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-private-rt-us-east-1b","Project":"proxy-http-client"},"timeouts":null},"sensitive_values":{"propagating_vgws":[],"route":[],"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_route_table.public","mode":"managed","type":"aws_route_table","name":"public","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-public-rt"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-public-rt","Project":"proxy-http-client"},"timeouts":null},"sensitive_values":{"propagating_vgws":[],"route":[],"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_route_table_association.private[\"us-east-1a\"]","mode":"managed","type":"aws_route_table_association","name":"private","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"region":"us-east-1","timeouts":null},"sensitive_values":{}},{"address":"aws_route_table_association.private[\"us-east-1b\"]","mode":"managed","type":"aws_route_table_association","name":"private","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"region":"us-east-1","timeouts":null},"sensitive_values":{}},{"address":"aws_route_table_association.public[\"us-east-1a\"]","mode":"managed","type":"aws_route_table_association","name":"public","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"region":"us-east-1","timeouts":null},"sensitive_values":{}},{"address":"aws_route_table_association.public[\"us-east-1b\"]","mode":"managed","type":"aws_route_table_association","name":"public","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"region":"us-east-1","timeouts":null},"sensitive_values":{}},{"address":"aws_secretsmanager_secret.app","mode":"managed","type":"aws_secretsmanager_secret","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"force_overwrite_replica_secret":false,"name":"proxy-http-client-dev/app-config","recovery_window_in_days":7,"region":"us-east-1","tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"sensitive_values":{"replica":[],"tags_all":{}},"identity_schema_version":0,"identity":{"arn":null}},{"address":"aws_secretsmanager_secret_version.app","mode":"managed","type":"aws_secretsmanager_secret_version","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-east-1","secret_binary":null,"secret_string":"ai-tf","secret_string_wo":null,"secret_string_wo_version":null},"sensitive_values":{"secret_binary":true,"secret_string":true,"secret_string_wo":true,"version_stages":[]},"identity_schema_version":0,"identity":{"account_id":null,"region":null,"secret_id":null,"version_id":null}},{"address":"aws_security_group.task","mode":"managed","type":"aws_security_group","name":"task","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"ECS task security group (no inbound).","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"HTTP outbound","from_port":80,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":80},{"cidr_blocks":["0.0.0.0/0"],"description":"HTTPS outbound","from_port":443,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":443}],"name":"proxy-http-client-dev-task-sg","region":"us-east-1","revoke_rules_on_delete":false,"tags":{"Name":"proxy-http-client-dev-task-sg"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-task-sg","Project":"proxy-http-client"},"timeouts":null},"sensitive_values":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[],"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_sns_topic.alerts","mode":"managed","type":"aws_sns_topic","name":"alerts","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"archive_policy":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"kms_master_key_id":null,"lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"proxy-http-client-dev-alerts","region":"us-east-1","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"sensitive_values":{"tags_all":{}},"identity_schema_version":0,"identity":{"arn":null}},{"address":"aws_subnet.private[\"us-east-1a\"]","mode":"managed","type":"aws_subnet","name":"private","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","cidr_block":"10.20.100.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-private-us-east-1a","Tier":"private"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-private-us-east-1a","Project":"proxy-http-client","Tier":"private"},"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_subnet.private[\"us-east-1b\"]","mode":"managed","type":"aws_subnet","name":"private","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","cidr_block":"10.20.101.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-private-us-east-1b","Tier":"private"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-private-us-east-1b","Project":"proxy-http-client","Tier":"private"},"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_subnet.public[\"us-east-1a\"]","mode":"managed","type":"aws_subnet","name":"public","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","cidr_block":"10.20.0.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":true,"outpost_arn":null,"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-public-us-east-1a","Tier":"public"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-public-us-east-1a","Project":"proxy-http-client","Tier":"public"},"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_subnet.public[\"us-east-1b\"]","mode":"managed","type":"aws_subnet","name":"public","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","cidr_block":"10.20.1.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":true,"outpost_arn":null,"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-public-us-east-1b","Tier":"public"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-public-us-east-1b","Project":"proxy-http-client","Tier":"public"},"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_vpc.this","mode":"managed","type":"aws_vpc","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_generated_ipv6_cidr_block":null,"cidr_block":"10.20.0.0/16","enable_dns_hostnames":true,"enable_dns_support":true,"instance_tenancy":"default","ipv4_ipam_pool_id":null,"ipv4_netmask_length":null,"ipv6_ipam_pool_id":null,"ipv6_netmask_length":null,"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-vpc"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-vpc","Project":"proxy-http-client"}},"sensitive_values":{"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}}]}},"resource_changes":[{"address":"aws_cloudwatch_event_rule.schedule","mode":"managed","type":"aws_cloudwatch_event_rule","name":"schedule","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Schedule to run proxy-http-client-dev ECS task","event_bus_name":"default","event_pattern":null,"force_destroy":false,"is_enabled":null,"name":"proxy-http-client-dev-schedule","region":"us-east-1","role_arn":null,"schedule_expression":"rate(1 hour)","state":null,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}},"after_identity":{"account_id":null,"name":null,"region":null}}},{"address":"aws_cloudwatch_event_target.ecs","mode":"managed","type":"aws_cloudwatch_event_target","name":"ecs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"appsync_target":[],"batch_target":[],"dead_letter_config":[],"ecs_target":[{"capacity_provider_strategy":[],"enable_ecs_managed_tags":false,"enable_execute_command":false,"group":null,"launch_type":"FARGATE","network_configuration":[{"assign_public_ip":false}],"ordered_placement_strategy":[],"placement_constraint":[],"platform_version":"LATEST","propagate_tags":null,"tags":null,"task_count":1}],"event_bus_name":"default","force_destroy":false,"http_target":[],"input":null,"input_path":null,"input_transformer":[],"kinesis_target":[],"redshift_target":[],"region":"us-east-1","retry_policy":[],"rule":"proxy-http-client-dev-schedule","run_command_targets":[],"sagemaker_pipeline_target":[],"sqs_target":[],"target_id":"ecs"},"after_unknown":{"appsync_target":[],"arn":true,"batch_target":[],"dead_letter_config":[],"ecs_target":[{"capacity_provider_strategy":[],"network_configuration":[{"security_groups":true,"subnets":true}],"ordered_placement_strategy":[],"placement_constraint":[],"task_definition_arn":true}],"http_target":[],"id":true,"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"role_arn":true,"run_command_targets":[],"sagemaker_pipeline_target":[],"sqs_target":[]},"before_sensitive":false,"after_sensitive":{"appsync_target":[],"batch_target":[],"dead_letter_config":[],"ecs_target":[{"capacity_provider_strategy":[],"network_configuration":[{"security_groups":[],"subnets":[]}],"ordered_placement_strategy":[],"placement_constraint":[]}],"http_target":[],"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"run_command_targets":[],"sagemaker_pipeline_target":[],"sqs_target":[]},"after_identity":{"account_id":null,"event_bus_name":null,"region":null,"rule":null,"target_id":null}}},{"address":"aws_cloudwatch_log_group.task","mode":"managed","type":"aws_cloudwatch_log_group","name":"task","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"kms_key_id":null,"name":"/ecs/proxy-http-client-dev","region":"us-east-1","retention_in_days":14,"skip_destroy":false,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"deletion_protection_enabled":true,"id":true,"log_group_class":true,"name_prefix":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}},"after_identity":{"account_id":null,"name":null,"region":null}}},{"address":"aws_cloudwatch_metric_alarm.eventbridge_failed_invocations","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"eventbridge_failed_invocations","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_description":"EventBridge failed invocations for scheduled ECS task","alarm_name":"proxy-http-client-dev-schedule-failed-invocations","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"RuleName":"proxy-http-client-dev-schedule"},"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"FailedInvocations","metric_query":[],"namespace":"AWS/Events","ok_actions":null,"period":300,"region":"us-east-1","statistic":"Sum","tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"},"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":true,"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":{}},"before_sensitive":false,"after_sensitive":{"alarm_actions":[],"dimensions":{},"metric_query":[],"tags_all":{}},"after_identity":{"account_id":null,"alarm_name":null,"region":null}}},{"address":"aws_ecs_cluster.this","mode":"managed","type":"aws_ecs_cluster","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"configuration":[],"name":"proxy-http-client-dev-cluster","region":"us-east-1","service_connect_defaults":[],"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"configuration":[],"id":true,"service_connect_defaults":[],"setting":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"configuration":[],"service_connect_defaults":[],"setting":[],"tags_all":{}}}},{"address":"aws_ecs_task_definition.this","mode":"managed","type":"aws_ecs_task_definition","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cpu":"256","ephemeral_storage":[],"family":"proxy-http-client-dev","ipc_mode":null,"memory":"512","network_mode":"awsvpc","pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"region":"us-east-1","requires_compatibilities":["FARGATE"],"runtime_platform":[],"skip_destroy":false,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"},"track_latest":false,"volume":[]},"after_unknown":{"arn":true,"arn_without_revision":true,"container_definitions":true,"enable_fault_injection":true,"ephemeral_storage":[],"execution_role_arn":true,"id":true,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"revision":true,"runtime_platform":[],"tags_all":{},"task_role_arn":true,"volume":[]},"before_sensitive":false,"after_sensitive":{"ephemeral_storage":[],"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"runtime_platform":[],"tags_all":{},"volume":[]}}},{"address":"aws_eip.nat[\"single\"]","mode":"managed","type":"aws_eip","name":"nat","index":"single","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"address":null,"associate_with_private_ip":null,"customer_owned_ipv4_pool":null,"domain":"vpc","region":"us-east-1","tags":{"Name":"proxy-http-client-dev-nat-eip-single"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-nat-eip-single","Project":"proxy-http-client"},"timeouts":null},"after_unknown":{"allocation_id":true,"arn":true,"association_id":true,"carrier_ip":true,"customer_owned_ip":true,"id":true,"instance":true,"ipam_pool_id":true,"network_border_group":true,"network_interface":true,"private_dns":true,"private_ip":true,"ptr_record":true,"public_dns":true,"public_ip":true,"public_ipv4_pool":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"aws_iam_policy.events_invoke_ecs","mode":"managed","type":"aws_iam_policy","name":"events_invoke_ecs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"delay_after_policy_creation_in_ms":null,"description":"Allow EventBridge to run ECS task.","name":"proxy-http-client-dev-events-invoke-ecs","path":"/","tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"attachment_count":true,"id":true,"name_prefix":true,"policy":true,"policy_id":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}},"after_identity":{"arn":null}}},{"address":"aws_iam_policy.task_secrets","mode":"managed","type":"aws_iam_policy","name":"task_secrets","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"delay_after_policy_creation_in_ms":null,"description":"Allow ECS task to read app config secret.","name":"proxy-http-client-dev-task-secrets","path":"/","tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"attachment_count":true,"id":true,"name_prefix":true,"policy":true,"policy_id":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}},"after_identity":{"arn":null}}},{"address":"aws_iam_role.events_invoke_ecs","mode":"managed","type":"aws_iam_role","name":"events_invoke_ecs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"events.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"proxy-http-client-dev-events-invoke-ecs","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}},"after_identity":{"account_id":null,"name":null}}},{"address":"aws_iam_role.task","mode":"managed","type":"aws_iam_role","name":"task","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"proxy-http-client-dev-ecs-task","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}},"after_identity":{"account_id":null,"name":null}}},{"address":"aws_iam_role.task_execution","mode":"managed","type":"aws_iam_role","name":"task_execution","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"proxy-http-client-dev-ecs-task-exec","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}},"after_identity":{"account_id":null,"name":null}}},{"address":"aws_iam_role_policy_attachment.events_invoke_ecs","mode":"managed","type":"aws_iam_role_policy_attachment","name":"events_invoke_ecs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"proxy-http-client-dev-events-invoke-ecs"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"policy_arn":null,"role":null}}},{"address":"aws_iam_role_policy_attachment.task_execution","mode":"managed","type":"aws_iam_role_policy_attachment","name":"task_execution","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy","role":"proxy-http-client-dev-ecs-task-exec"},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"policy_arn":null,"role":null}}},{"address":"aws_iam_role_policy_attachment.task_secrets","mode":"managed","type":"aws_iam_role_policy_attachment","name":"task_secrets","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"proxy-http-client-dev-ecs-task"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"policy_arn":null,"role":null}}},{"address":"aws_internet_gateway.this","mode":"managed","type":"aws_internet_gateway","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-igw"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-igw","Project":"proxy-http-client"},"timeouts":null},"after_unknown":{"arn":true,"id":true,"owner_id":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"aws_kms_alias.secrets","mode":"managed","type":"aws_kms_alias","name":"secrets","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"alias/proxy-http-client-dev-secrets","region":"us-east-1"},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"target_key_arn":true,"target_key_id":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"name":null,"region":null}}},{"address":"aws_kms_key.secrets","mode":"managed","type":"aws_kms_key","name":"secrets","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bypass_policy_lockout_safety_check":false,"custom_key_store_id":null,"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":7,"description":"KMS key for proxy-http-client-dev secrets","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","region":"us-east-1","tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"},"timeouts":null,"xks_key_id":null},"after_unknown":{"arn":true,"id":true,"key_id":true,"multi_region":true,"policy":true,"rotation_period_in_days":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_nat_gateway.this[\"single\"]","mode":"managed","type":"aws_nat_gateway","name":"this","index":"single","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"availability_zone_address":[],"connectivity_type":"public","region":"us-east-1","tags":{"Name":"proxy-http-client-dev-nat-single"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-nat-single","Project":"proxy-http-client"},"timeouts":null},"after_unknown":{"allocation_id":true,"association_id":true,"auto_provision_zones":true,"auto_scaling_ips":true,"availability_mode":true,"availability_zone_address":[],"id":true,"network_interface_id":true,"private_ip":true,"public_ip":true,"regional_nat_gateway_address":true,"regional_nat_gateway_auto_mode":true,"route_table_id":true,"secondary_allocation_ids":true,"secondary_private_ip_address_count":true,"secondary_private_ip_addresses":true,"subnet_id":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"availability_zone_address":[],"regional_nat_gateway_address":[],"secondary_allocation_ids":[],"secondary_private_ip_addresses":[],"tags":{},"tags_all":{}}}},{"address":"aws_route.private_default[\"us-east-1a\"]","mode":"managed","type":"aws_route","name":"private_default","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"carrier_gateway_id":null,"core_network_arn":null,"destination_cidr_block":"0.0.0.0/0","destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"egress_only_gateway_id":null,"gateway_id":null,"local_gateway_id":null,"region":"us-east-1","timeouts":null,"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null},"after_unknown":{"id":true,"instance_id":true,"instance_owner_id":true,"nat_gateway_id":true,"network_interface_id":true,"origin":true,"route_table_id":true,"state":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"destination_cidr_block":null,"destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"region":null,"route_table_id":null}}},{"address":"aws_route.private_default[\"us-east-1b\"]","mode":"managed","type":"aws_route","name":"private_default","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"carrier_gateway_id":null,"core_network_arn":null,"destination_cidr_block":"0.0.0.0/0","destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"egress_only_gateway_id":null,"gateway_id":null,"local_gateway_id":null,"region":"us-east-1","timeouts":null,"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null},"after_unknown":{"id":true,"instance_id":true,"instance_owner_id":true,"nat_gateway_id":true,"network_interface_id":true,"origin":true,"route_table_id":true,"state":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"destination_cidr_block":null,"destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"region":null,"route_table_id":null}}},{"address":"aws_route.public_internet","mode":"managed","type":"aws_route","name":"public_internet","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"carrier_gateway_id":null,"core_network_arn":null,"destination_cidr_block":"0.0.0.0/0","destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"egress_only_gateway_id":null,"local_gateway_id":null,"nat_gateway_id":null,"region":"us-east-1","timeouts":null,"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null},"after_unknown":{"gateway_id":true,"id":true,"instance_id":true,"instance_owner_id":true,"network_interface_id":true,"origin":true,"route_table_id":true,"state":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"destination_cidr_block":null,"destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"region":null,"route_table_id":null}}},{"address":"aws_route_table.private[\"us-east-1a\"]","mode":"managed","type":"aws_route_table","name":"private","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-private-rt-us-east-1a"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-private-rt-us-east-1a","Project":"proxy-http-client"},"timeouts":null},"after_unknown":{"arn":true,"id":true,"owner_id":true,"propagating_vgws":true,"route":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"propagating_vgws":[],"route":[],"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_route_table.private[\"us-east-1b\"]","mode":"managed","type":"aws_route_table","name":"private","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-private-rt-us-east-1b"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-private-rt-us-east-1b","Project":"proxy-http-client"},"timeouts":null},"after_unknown":{"arn":true,"id":true,"owner_id":true,"propagating_vgws":true,"route":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"propagating_vgws":[],"route":[],"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_route_table.public","mode":"managed","type":"aws_route_table","name":"public","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-public-rt"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-public-rt","Project":"proxy-http-client"},"timeouts":null},"after_unknown":{"arn":true,"id":true,"owner_id":true,"propagating_vgws":true,"route":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"propagating_vgws":[],"route":[],"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_route_table_association.private[\"us-east-1a\"]","mode":"managed","type":"aws_route_table_association","name":"private","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"region":"us-east-1","timeouts":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_route_table_association.private[\"us-east-1b\"]","mode":"managed","type":"aws_route_table_association","name":"private","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"region":"us-east-1","timeouts":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_route_table_association.public[\"us-east-1a\"]","mode":"managed","type":"aws_route_table_association","name":"public","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"region":"us-east-1","timeouts":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_route_table_association.public[\"us-east-1b\"]","mode":"managed","type":"aws_route_table_association","name":"public","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"region":"us-east-1","timeouts":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_secretsmanager_secret.app","mode":"managed","type":"aws_secretsmanager_secret","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"force_overwrite_replica_secret":false,"name":"proxy-http-client-dev/app-config","recovery_window_in_days":7,"region":"us-east-1","tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"id":true,"kms_key_id":true,"name_prefix":true,"policy":true,"replica":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"replica":[],"tags_all":{}},"after_identity":{"arn":null}}},{"address":"aws_secretsmanager_secret_version.app","mode":"managed","type":"aws_secretsmanager_secret_version","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-east-1","secret_binary":null,"secret_string":"ai-tf","secret_string_wo":null,"secret_string_wo_version":null},"after_unknown":{"arn":true,"has_secret_string_wo":true,"id":true,"secret_id":true,"version_id":true,"version_stages":true},"before_sensitive":false,"after_sensitive":{"secret_binary":true,"secret_string":true,"secret_string_wo":true,"version_stages":[]},"after_identity":{"account_id":null,"region":null,"secret_id":null,"version_id":null}}},{"address":"aws_security_group.task","mode":"managed","type":"aws_security_group","name":"task","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"ECS task security group (no inbound).","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"HTTP outbound","from_port":80,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":80},{"cidr_blocks":["0.0.0.0/0"],"description":"HTTPS outbound","from_port":443,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":443}],"name":"proxy-http-client-dev-task-sg","region":"us-east-1","revoke_rules_on_delete":false,"tags":{"Name":"proxy-http-client-dev-task-sg"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-task-sg","Project":"proxy-http-client"},"timeouts":null},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"id":true,"ingress":true,"name_prefix":true,"owner_id":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[],"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_sns_topic.alerts","mode":"managed","type":"aws_sns_topic","name":"alerts","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"archive_policy":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"kms_master_key_id":null,"lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"proxy-http-client-dev-alerts","region":"us-east-1","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":null,"tags_all":{"Environment":"dev","ManagedBy":"terraform","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"beginning_archive_time":true,"fifo_throughput_scope":true,"id":true,"name_prefix":true,"owner":true,"policy":true,"signature_version":true,"tags_all":{},"tracing_config":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}},"after_identity":{"arn":null}}},{"address":"aws_subnet.private[\"us-east-1a\"]","mode":"managed","type":"aws_subnet","name":"private","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","cidr_block":"10.20.100.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-private-us-east-1a","Tier":"private"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-private-us-east-1a","Project":"proxy-http-client","Tier":"private"},"timeouts":null},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_subnet.private[\"us-east-1b\"]","mode":"managed","type":"aws_subnet","name":"private","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","cidr_block":"10.20.101.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-private-us-east-1b","Tier":"private"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-private-us-east-1b","Project":"proxy-http-client","Tier":"private"},"timeouts":null},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_subnet.public[\"us-east-1a\"]","mode":"managed","type":"aws_subnet","name":"public","index":"us-east-1a","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","cidr_block":"10.20.0.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":true,"outpost_arn":null,"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-public-us-east-1a","Tier":"public"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-public-us-east-1a","Project":"proxy-http-client","Tier":"public"},"timeouts":null},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_subnet.public[\"us-east-1b\"]","mode":"managed","type":"aws_subnet","name":"public","index":"us-east-1b","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","cidr_block":"10.20.1.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":true,"outpost_arn":null,"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-public-us-east-1b","Tier":"public"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-public-us-east-1b","Project":"proxy-http-client","Tier":"public"},"timeouts":null},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_vpc.this","mode":"managed","type":"aws_vpc","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_generated_ipv6_cidr_block":null,"cidr_block":"10.20.0.0/16","enable_dns_hostnames":true,"enable_dns_support":true,"instance_tenancy":"default","ipv4_ipam_pool_id":null,"ipv4_netmask_length":null,"ipv6_ipam_pool_id":null,"ipv6_netmask_length":null,"region":"us-east-1","tags":{"Name":"proxy-http-client-dev-vpc"},"tags_all":{"Environment":"dev","ManagedBy":"terraform","Name":"proxy-http-client-dev-vpc","Project":"proxy-http-client"}},"after_unknown":{"arn":true,"default_network_acl_id":true,"default_route_table_id":true,"default_security_group_id":true,"dhcp_options_id":true,"enable_network_address_usage_metrics":true,"id":true,"ipv6_association_id":true,"ipv6_cidr_block":true,"ipv6_cidr_block_network_border_group":true,"main_route_table_id":true,"owner_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}}],"output_changes":{"cloudwatch_log_group_name":{"actions":["create"],"before":null,"after":"/ecs/proxy-http-client-dev","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"ecs_cluster_name":{"actions":["create"],"before":null,"after":"proxy-http-client-dev-cluster","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"ecs_task_definition_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"eventbridge_rule_name":{"actions":["create"],"before":null,"after":"proxy-http-client-dev-schedule","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"private_subnet_ids":{"actions":["create"],"before":null,"after":[null,null],"after_unknown":[true,true],"before_sensitive":false,"after_sensitive":false},"secrets_manager_secret_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"sns_topic_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"vpc_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.13.5","values":{"outputs":{"cloudwatch_log_group_name":{"sensitive":false,"value":"/ecs/proxy-http-client-dev","type":"string"},"ecs_cluster_name":{"sensitive":false,"value":"proxy-http-client-dev-cluster","type":"string"},"eventbridge_rule_name":{"sensitive":false,"value":"proxy-http-client-dev-schedule","type":"string"}},"root_module":{"resources":[{"address":"data.aws_availability_zones.available","mode":"data","type":"aws_availability_zones","name":"available","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"all_availability_zones":null,"exclude_names":null,"exclude_zone_ids":null,"filter":null,"group_names":[""],"id":"us-east-1","names":["us-east-1a","us-east-1b","us-east-1c","us-east-1d","us-east-1e","us-east-1f"],"region":"us-east-1","state":"available","timeouts":null,"zone_ids":["use1-az6","use1-az1","use1-az2","use1-az4","use1-az3","use1-az5"]},"sensitive_values":{"group_names":[false],"names":[false,false,false,false,false,false],"zone_ids":[false,false,false,false,false,false]}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"\u003e= 5.0.0","expressions":{"default_tags":[{"tags":{"references":["var.project_name","var.environment","var.tags"]}}],"region":{"references":["var.aws_region"]}}}},"root_module":{"outputs":{"cloudwatch_log_group_name":{"expression":{"references":["aws_cloudwatch_log_group.task.name","aws_cloudwatch_log_group.task"]},"description":"CloudWatch log group for task logs."},"ecs_cluster_name":{"expression":{"references":["aws_ecs_cluster.this.name","aws_ecs_cluster.this"]},"description":"ECS cluster name."},"ecs_task_definition_arn":{"expression":{"references":["aws_ecs_task_definition.this.arn","aws_ecs_task_definition.this"]},"description":"ECS task definition ARN."},"eventbridge_rule_name":{"expression":{"references":["aws_cloudwatch_event_rule.schedule.name","aws_cloudwatch_event_rule.schedule"]},"description":"EventBridge schedule rule name."},"private_subnet_ids":{"expression":{"references":["aws_subnet.private"]},"description":"Private subnet IDs used by ECS tasks."},"secrets_manager_secret_arn":{"expression":{"references":["aws_secretsmanager_secret.app.arn","aws_secretsmanager_secret.app"]},"description":"Secrets Manager secret ARN containing APP_CONFIG_JSON."},"sns_topic_arn":{"expression":{"references":["aws_sns_topic.alerts.arn","aws_sns_topic.alerts"]},"description":"SNS topic ARN for alerts."},"vpc_id":{"expression":{"references":["aws_vpc.this.id","aws_vpc.this"]},"description":"VPC ID."}},"resources":[{"address":"aws_cloudwatch_event_rule.schedule","mode":"managed","type":"aws_cloudwatch_event_rule","name":"schedule","provider_config_key":"aws","expressions":{"description":{"references":["local.name_prefix"]},"name":{"references":["local.name_prefix"]},"schedule_expression":{"references":["var.schedule_expression"]}},"schema_version":1},{"address":"aws_cloudwatch_event_target.ecs","mode":"managed","type":"aws_cloudwatch_event_target","name":"ecs","provider_config_key":"aws","expressions":{"arn":{"references":["aws_ecs_cluster.this.arn","aws_ecs_cluster.this"]},"ecs_target":[{"launch_type":{"constant_value":"FARGATE"},"network_configuration":[{"assign_public_ip":{"constant_value":false},"security_groups":{"references":["aws_security_group.task.id","aws_security_group.task"]},"subnets":{"references":["aws_subnet.private"]}}],"platform_version":{"constant_value":"LATEST"},"task_definition_arn":{"references":["aws_ecs_task_definition.this.arn","aws_ecs_task_definition.this"]}}],"role_arn":{"references":["aws_iam_role.events_invoke_ecs.arn","aws_iam_role.events_invoke_ecs"]},"rule":{"references":["aws_cloudwatch_event_rule.schedule.name","aws_cloudwatch_event_rule.schedule"]},"target_id":{"constant_value":"ecs"}},"schema_version":1},{"address":"aws_cloudwatch_log_group.task","mode":"managed","type":"aws_cloudwatch_log_group","name":"task","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"retention_in_days":{"references":["var.log_retention_days"]}},"schema_version":0},{"address":"aws_cloudwatch_metric_alarm.eventbridge_failed_invocations","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"eventbridge_failed_invocations","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alerts.arn","aws_sns_topic.alerts"]},"alarm_description":{"constant_value":"EventBridge failed invocations for scheduled ECS task"},"alarm_name":{"references":["local.name_prefix"]},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"dimensions":{"references":["aws_cloudwatch_event_rule.schedule.name","aws_cloudwatch_event_rule.schedule"]},"evaluation_periods":{"constant_value":1},"metric_name":{"constant_value":"FailedInvocations"},"namespace":{"constant_value":"AWS/Events"},"period":{"constant_value":300},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":0}},"schema_version":1},{"address":"aws_ecs_cluster.this","mode":"managed","type":"aws_ecs_cluster","name":"this","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]}},"schema_version":0},{"address":"aws_ecs_service.this","mode":"managed","type":"aws_ecs_service","name":"this","provider_config_key":"aws","expressions":{"cluster":{"references":["aws_ecs_cluster.this.id","aws_ecs_cluster.this"]},"desired_count":{"references":["var.task_desired_count"]},"launch_type":{"constant_value":"FARGATE"},"name":{"references":["local.name_prefix"]},"network_configuration":[{"assign_public_ip":{"constant_value":false},"security_groups":{"references":["aws_security_group.task.id","aws_security_group.task"]},"subnets":{"references":["aws_subnet.private"]}}],"task_definition":{"references":["aws_ecs_task_definition.this.arn","aws_ecs_task_definition.this"]}},"schema_version":1,"count_expression":{"references":["var.create_ecs_service"]}},{"address":"aws_ecs_task_definition.this","mode":"managed","type":"aws_ecs_task_definition","name":"this","provider_config_key":"aws","expressions":{"container_definitions":{"references":["var.container_image","var.container_command","var.container_command","var.environment","aws_secretsmanager_secret.app.arn","aws_secretsmanager_secret.app","aws_cloudwatch_log_group.task.name","aws_cloudwatch_log_group.task","var.aws_region"]},"cpu":{"references":["var.task_cpu"]},"execution_role_arn":{"references":["aws_iam_role.task_execution.arn","aws_iam_role.task_execution"]},"family":{"references":["local.name_prefix"]},"memory":{"references":["var.task_memory"]},"network_mode":{"constant_value":"awsvpc"},"requires_compatibilities":{"constant_value":["FARGATE"]},"task_role_arn":{"references":["aws_iam_role.task.arn","aws_iam_role.task"]}},"schema_version":1},{"address":"aws_eip.nat","mode":"managed","type":"aws_eip","name":"nat","provider_config_key":"aws","expressions":{"domain":{"constant_value":"vpc"},"tags":{"references":["local.name_prefix","each.key"]}},"schema_version":0,"for_each_expression":{"references":["var.enable_nat_gateway_ha","aws_subnet.public","aws_subnet.public"]}},{"address":"aws_iam_policy.events_invoke_ecs","mode":"managed","type":"aws_iam_policy","name":"events_invoke_ecs","provider_config_key":"aws","expressions":{"description":{"constant_value":"Allow EventBridge to run ECS task."},"name":{"references":["local.name_prefix"]},"policy":{"references":["aws_ecs_task_definition.this.arn","aws_ecs_task_definition.this","aws_iam_role.task_execution.arn","aws_iam_role.task_execution","aws_iam_role.task.arn","aws_iam_role.task"]}},"schema_version":0},{"address":"aws_iam_policy.task_secrets","mode":"managed","type":"aws_iam_policy","name":"task_secrets","provider_config_key":"aws","expressions":{"description":{"constant_value":"Allow ECS task to read app config secret."},"name":{"references":["local.name_prefix"]},"policy":{"references":["aws_secretsmanager_secret.app.arn","aws_secretsmanager_secret.app","aws_kms_key.secrets.arn","aws_kms_key.secrets"]}},"schema_version":0},{"address":"aws_iam_role.events_invoke_ecs","mode":"managed","type":"aws_iam_role","name":"events_invoke_ecs","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["local.name_prefix"]}},"schema_version":0},{"address":"aws_iam_role.task","mode":"managed","type":"aws_iam_role","name":"task","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["local.name_prefix"]}},"schema_version":0},{"address":"aws_iam_role.task_execution","mode":"managed","type":"aws_iam_role","name":"task_execution","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["local.name_prefix"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.events_invoke_ecs","mode":"managed","type":"aws_iam_role_policy_attachment","name":"events_invoke_ecs","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.events_invoke_ecs.arn","aws_iam_policy.events_invoke_ecs"]},"role":{"references":["aws_iam_role.events_invoke_ecs.name","aws_iam_role.events_invoke_ecs"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.task_execution","mode":"managed","type":"aws_iam_role_policy_attachment","name":"task_execution","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"},"role":{"references":["aws_iam_role.task_execution.name","aws_iam_role.task_execution"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.task_secrets","mode":"managed","type":"aws_iam_role_policy_attachment","name":"task_secrets","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.task_secrets.arn","aws_iam_policy.task_secrets"]},"role":{"references":["aws_iam_role.task.name","aws_iam_role.task"]}},"schema_version":0},{"address":"aws_internet_gateway.this","mode":"managed","type":"aws_internet_gateway","name":"this","provider_config_key":"aws","expressions":{"tags":{"references":["local.name_prefix"]},"vpc_id":{"references":["aws_vpc.this.id","aws_vpc.this"]}},"schema_version":0},{"address":"aws_kms_alias.secrets","mode":"managed","type":"aws_kms_alias","name":"secrets","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"target_key_id":{"references":["aws_kms_key.secrets.key_id","aws_kms_key.secrets"]}},"schema_version":0},{"address":"aws_kms_key.secrets","mode":"managed","type":"aws_kms_key","name":"secrets","provider_config_key":"aws","expressions":{"deletion_window_in_days":{"constant_value":7},"description":{"references":["local.name_prefix"]},"enable_key_rotation":{"constant_value":true}},"schema_version":0},{"address":"aws_nat_gateway.this","mode":"managed","type":"aws_nat_gateway","name":"this","provider_config_key":"aws","expressions":{"allocation_id":{"references":["aws_eip.nat","each.key"]},"subnet_id":{"references":["each.value.id","each.value"]},"tags":{"references":["local.name_prefix","each.key"]}},"schema_version":0,"for_each_expression":{"references":["var.enable_nat_gateway_ha","aws_subnet.public","aws_subnet.public"]},"depends_on":["aws_internet_gateway.this"]},{"address":"aws_route.private_default","mode":"managed","type":"aws_route","name":"private_default","provider_config_key":"aws","expressions":{"destination_cidr_block":{"constant_value":"0.0.0.0/0"},"nat_gateway_id":{"references":["var.enable_nat_gateway_ha","aws_nat_gateway.this","each.key","aws_nat_gateway.this[\"single\"].id","aws_nat_gateway.this[\"single\"]","aws_nat_gateway.this"]},"route_table_id":{"references":["each.value.id","each.value"]}},"schema_version":0,"for_each_expression":{"references":["aws_route_table.private"]}},{"address":"aws_route.public_internet","mode":"managed","type":"aws_route","name":"public_internet","provider_config_key":"aws","expressions":{"destination_cidr_block":{"constant_value":"0.0.0.0/0"},"gateway_id":{"references":["aws_internet_gateway.this.id","aws_internet_gateway.this"]},"route_table_id":{"references":["aws_route_table.public.id","aws_route_table.public"]}},"schema_version":0},{"address":"aws_route_table.private","mode":"managed","type":"aws_route_table","name":"private","provider_config_key":"aws","expressions":{"tags":{"references":["local.name_prefix","each.key"]},"vpc_id":{"references":["aws_vpc.this.id","aws_vpc.this"]}},"schema_version":0,"for_each_expression":{"references":["aws_subnet.private"]}},{"address":"aws_route_table.public","mode":"managed","type":"aws_route_table","name":"public","provider_config_key":"aws","expressions":{"tags":{"references":["local.name_prefix"]},"vpc_id":{"references":["aws_vpc.this.id","aws_vpc.this"]}},"schema_version":0},{"address":"aws_route_table_association.private","mode":"managed","type":"aws_route_table_association","name":"private","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.private","each.key"]},"subnet_id":{"references":["each.value.id","each.value"]}},"schema_version":0,"for_each_expression":{"references":["aws_subnet.private"]}},{"address":"aws_route_table_association.public","mode":"managed","type":"aws_route_table_association","name":"public","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.public.id","aws_route_table.public"]},"subnet_id":{"references":["each.value.id","each.value"]}},"schema_version":0,"for_each_expression":{"references":["aws_subnet.public"]}},{"address":"aws_secretsmanager_secret.app","mode":"managed","type":"aws_secretsmanager_secret","name":"app","provider_config_key":"aws","expressions":{"kms_key_id":{"references":["aws_kms_key.secrets.arn","aws_kms_key.secrets"]},"name":{"references":["local.name_prefix"]},"recovery_window_in_days":{"constant_value":7}},"schema_version":0},{"address":"aws_secretsmanager_secret_version.app","mode":"managed","type":"aws_secretsmanager_secret_version","name":"app","provider_config_key":"aws","expressions":{"secret_id":{"references":["aws_secretsmanager_secret.app.id","aws_secretsmanager_secret.app"]},"secret_string":{"references":["var.secrets_json"]}},"schema_version":0},{"address":"aws_security_group.task","mode":"managed","type":"aws_security_group","name":"task","provider_config_key":"aws","expressions":{"description":{"constant_value":"ECS task security group (no inbound)."},"egress":{"constant_value":[{"cidr_blocks":["0.0.0.0/0"],"description":"HTTPS outbound","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":443},{"cidr_blocks":["0.0.0.0/0"],"description":"HTTP outbound","from_port":80,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":80}]},"name":{"references":["local.name_prefix"]},"tags":{"references":["local.name_prefix"]},"vpc_id":{"references":["aws_vpc.this.id","aws_vpc.this"]}},"schema_version":1},{"address":"aws_sns_topic.alerts","mode":"managed","type":"aws_sns_topic","name":"alerts","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]}},"schema_version":0},{"address":"aws_sns_topic_subscription.email","mode":"managed","type":"aws_sns_topic_subscription","name":"email","provider_config_key":"aws","expressions":{"endpoint":{"references":["var.sns_email"]},"protocol":{"constant_value":"email"},"topic_arn":{"references":["aws_sns_topic.alerts.arn","aws_sns_topic.alerts"]}},"schema_version":0,"count_expression":{"references":["var.sns_email"]}},{"address":"aws_subnet.private","mode":"managed","type":"aws_subnet","name":"private","provider_config_key":"aws","expressions":{"availability_zone":{"references":["each.key"]},"cidr_block":{"references":["local.private_subnet_cidrs","each.value"]},"map_public_ip_on_launch":{"constant_value":false},"tags":{"references":["local.name_prefix","each.key"]},"vpc_id":{"references":["aws_vpc.this.id","aws_vpc.this"]}},"schema_version":1,"for_each_expression":{"references":["local.azs"]}},{"address":"aws_subnet.public","mode":"managed","type":"aws_subnet","name":"public","provider_config_key":"aws","expressions":{"availability_zone":{"references":["each.key"]},"cidr_block":{"references":["local.public_subnet_cidrs","each.value"]},"map_public_ip_on_launch":{"constant_value":true},"tags":{"references":["local.name_prefix","each.key"]},"vpc_id":{"references":["aws_vpc.this.id","aws_vpc.this"]}},"schema_version":1,"for_each_expression":{"references":["local.azs"]}},{"address":"aws_vpc.this","mode":"managed","type":"aws_vpc","name":"this","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.vpc_cidr"]},"enable_dns_hostnames":{"constant_value":true},"enable_dns_support":{"constant_value":true},"tags":{"references":["local.name_prefix"]}},"schema_version":1},{"address":"data.aws_availability_zones.available","mode":"data","type":"aws_availability_zones","name":"available","provider_config_key":"aws","expressions":{"state":{"constant_value":"available"}},"schema_version":0}],"variables":{"aws_region":{"default":"us-east-1","description":"AWS region."},"az_count":{"default":2,"description":"Number of AZs to use (2 recommended)."},"container_command":{"default":[],"description":"Optional command override for the container. Leave empty to use image CMD."},"container_image":{"description":"Container image URI for the Node.js job (e.g., \u003caccount\u003e.dkr.ecr.\u003cregion\u003e.amazonaws.com/repo:tag)."},"create_ecs_service":{"default":false,"description":"Create an ECS service (optional). Scheduled tasks do not require a service."},"enable_nat_gateway_ha":{"default":false,"description":"If true, create one NAT Gateway per AZ. If false, create a single NAT Gateway (cost-optimized)."},"environment":{"default":"dev","description":"Environment name (e.g., dev, staging, prod)."},"log_retention_days":{"default":14,"description":"CloudWatch Logs retention in days."},"project_name":{"default":"proxy-http-client","description":"Project name used for naming/tagging."},"schedule_expression":{"default":"rate(1 hour)","description":"EventBridge schedule expression (rate(...) or cron(...))."},"secrets_json":{"description":"JSON string stored in Secrets Manager and exposed to the container as APP_CONFIG_JSON. Put proxy URLs/credentials and other config here.","sensitive":true},"sns_email":{"default":"","description":"Optional email address to subscribe to alerts. Leave empty to skip subscription."},"tags":{"default":{},"description":"Additional tags to apply to all resources."},"task_cpu":{"default":256,"description":"Fargate task CPU units."},"task_desired_count":{"default":0,"description":"If you want a continuously running service, set \u003e0 and enable create_ecs_service. For scheduled tasks, keep 0."},"task_memory":{"default":512,"description":"Fargate task memory (MiB)."},"vpc_cidr":{"default":"10.20.0.0/16","description":"CIDR block for the VPC."}}}},"relevant_attributes":[{"resource":"aws_ecs_cluster.this","attribute":["arn"]},{"resource":"aws_ecs_task_definition.this","attribute":["arn"]},{"resource":"aws_route_table.public","attribute":["id"]},{"resource":"aws_cloudwatch_log_group.task","attribute":["name"]},{"resource":"aws_eip.nat","attribute":[]},{"resource":"aws_iam_role.task_execution","attribute":["arn"]},{"resource":"aws_iam_policy.task_secrets","attribute":["arn"]},{"resource":"aws_iam_role.task_execution","attribute":["name"]},{"resource":"aws_nat_gateway.this","attribute":[]},{"resource":"aws_iam_role.task","attribute":["arn"]},{"resource":"aws_nat_gateway.this[\"single\"]","attribute":["id"]},{"resource":"aws_cloudwatch_event_rule.schedule","attribute":["name"]},{"resource":"aws_vpc.this","attribute":["id"]},{"resource":"aws_route_table.private","attribute":[]},{"resource":"aws_subnet.private","attribute":[]},{"resource":"aws_kms_key.secrets","attribute":["arn"]},{"resource":"aws_kms_key.secrets","attribute":["key_id"]},{"resource":"aws_subnet.public","attribute":[]},{"resource":"data.aws_availability_zones.available","attribute":["names"]},{"resource":"aws_iam_role.events_invoke_ecs","attribute":["name"]},{"resource":"aws_secretsmanager_secret.app","attribute":["id"]},{"resource":"aws_iam_policy.events_invoke_ecs","attribute":["arn"]},{"resource":"aws_secretsmanager_secret.app","attribute":["arn"]},{"resource":"aws_iam_role.events_invoke_ecs","attribute":["arn"]},{"resource":"aws_ecs_cluster.this","attribute":["name"]},{"resource":"aws_iam_role.task","attribute":["name"]},{"resource":"aws_internet_gateway.this","attribute":["id"]},{"resource":"aws_sns_topic.alerts","attribute":["arn"]},{"resource":"aws_security_group.task","attribute":["id"]}],"timestamp":"2026-01-27T04:04:09Z","applyable":true,"complete":true,"errored":false}
