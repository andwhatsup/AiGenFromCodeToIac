{
  "aws_architecture_description": "### Proposed high-level AWS architecture (lean, secure, scalable)\n\n#### 1) Networking / edge\n- **VPC across 2+ Availability Zones** for high availability.\n- **Public subnets** host an **internet-facing Application Load Balancer (ALB)**.\n- **Private subnets** host the **ECS Fargate tasks** (no public IPs).\n- **NAT Gateways (one per AZ)** allow private tasks to reach AWS services/the internet as needed (e.g., pulling images, calling external APIs).\n- **VPC endpoints** (recommended) reduce NAT usage and keep traffic on AWS networks:\n  - ECR (api + dkr), CloudWatch Logs, S3 (gateway endpoint), Secrets Manager (if used).\n\n#### 2) Compute / service runtime\n- **Amazon ECS (Fargate)** runs the containerized Go `net/http` API.\n- **ECS Service** (e.g., `Poc-Assessment`) maintains desired task count and performs rolling deployments.\n- **ALB Target Group** forwards traffic to the ECS service on **container port 5678**.\n- **Health checks**:\n  - ALB target group health check path: **`/health`** (matches the app).\n  - ECS container health check can optionally call `GET /health` as well.\n\n#### 3) Container image supply chain\n- **Amazon ECR** hosts the Docker image.\n- **GitHub Actions** builds/tests, builds the Docker image, pushes to ECR, then triggers deployment.\n- Prefer **GitHub OIDC â†’ AWS IAM Role** (short-lived credentials) instead of long-lived AWS keys in GitHub.\n\n#### 4) Deployment safety / operations\n- Enable **ECS deployment circuit breaker with rollback** so failed deployments automatically stop and roll back. ([docs.aws.amazon.com](https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-properties-ecs-service-deploymentcircuitbreaker.html?utm_source=openai))\n- **CloudWatch Logs** for container logs (awslogs driver) and **CloudWatch metrics/alarms** for ALB 5XX, target health, latency, ECS CPU/memory. ECS task execution role commonly covers log delivery and ECR pulls. ([docs.aws.amazon.com](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_execution_IAM_role.html?utm_source=openai))\n- **AWS X-Ray** is optional; only add if you instrument the Go app.\n\n#### 5) TLS / DNS\n- **ACM certificate** attached to the ALB HTTPS listener (443).\n- **Route 53** hosted zone + alias record to the ALB.\n\n#### 6) Secrets / configuration\n- Use **SSM Parameter Store** or **Secrets Manager** for runtime configuration (if any sensitive values appear later). ECS task definition references these; access is granted via the **task role**.\n\n---\n\n## AWS resources to provision\n\n### Core networking\n- Amazon VPC\n- Public subnets (2+ AZs)\n- Private subnets (2+ AZs)\n- Internet Gateway\n- NAT Gateways (1 per AZ) + Elastic IPs\n- Route tables (public + private) and route associations\n- Security Groups:\n  - ALB security group (allow 443 from internet)\n  - ECS tasks security group (allow 5678 from ALB SG)\n- (Recommended) VPC Endpoints:\n  - Interface endpoints: ECR (api), ECR (dkr), CloudWatch Logs, Secrets Manager (if used), SSM (if used)\n  - Gateway endpoint: S3\n\n### Load balancing / ingress\n- Application Load Balancer (internet-facing)\n- ALB HTTPS listener (:443)\n- ALB target group (HTTP to targets on port 5678)\n- ALB listener rule(s) (default forward to target group)\n\n### Compute (containers)\n- Amazon ECS Cluster\n- ECS Service (Fargate) (e.g., `Poc-Assessment`)\n- ECS Task Definition (container port 5678, health check `/health`, log configuration)\n- (Optional) ECS Service Auto Scaling (target tracking on CPU/memory or ALB request count)\n\n### Container registry\n- Amazon ECR repository\n- ECR lifecycle policy (expire old images)\n\n### IAM / security\n- IAM role: **ECS task execution role** (pull from ECR, write logs to CloudWatch Logs, fetch secrets if referenced) ([docs.aws.amazon.com](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_execution_IAM_role.html?utm_source=openai))\n- IAM role: **ECS task role** (application AWS API permissions; least privilege)\n- IAM role: **GitHub Actions deploy role** (trusted via GitHub OIDC; permissions to push to ECR + update ECS service)\n- IAM OIDC identity provider: `token.actions.githubusercontent.com` (for GitHub OIDC)\n- (Optional) AWS KMS key(s) for encrypting secrets/parameters/log groups (if you need customer-managed keys)\n\n### Observability\n- CloudWatch Log Group(s) for ECS task logs\n- CloudWatch Alarms (ALB 5XX, target unhealthy host count, latency; ECS CPU/memory)\n- (Optional) CloudWatch dashboard\n\n### DNS / TLS\n- AWS Certificate Manager (ACM) certificate for your domain\n- Amazon Route 53 hosted zone (if not existing)\n- Route 53 A/AAAA alias record to ALB\n\n### (Optional hardening)\n- AWS WAFv2 Web ACL associated to the ALB (basic managed rules)\n- AWS Shield Standard (automatic with ALB)\n\nIf you tell me your expected traffic (RPS), whether you need a custom domain, and whether the service calls any AWS services (S3/DynamoDB/etc.), I can tighten the IAM policies and right-size the scaling/alarms.",
  "aws_resources": [
    "Amazon VPC",
    "Public Subnets (2+ AZs)",
    "Private Subnets (2+ AZs)",
    "Internet Gateway",
    "NAT Gateways (1 per AZ)",
    "Elastic IPs (for NAT)",
    "Public Route Table + routes + associations",
    "Private Route Tables + routes + associations",
    "Security Group - ALB",
    "Security Group - ECS Tasks",
    "VPC Interface Endpoint - ECR (api)",
    "VPC Interface Endpoint - ECR (dkr)",
    "VPC Interface Endpoint - CloudWatch Logs",
    "VPC Interface Endpoint - Secrets Manager (optional)",
    "VPC Interface Endpoint - SSM (optional)",
    "VPC Gateway Endpoint - S3",
    "Application Load Balancer (internet-facing)",
    "ALB HTTPS Listener (443)",
    "ALB Target Group (HTTP to port 5678)",
    "ALB Listener Rules",
    "Amazon ECS Cluster",
    "ECS Service (Fargate)",
    "ECS Task Definition",
    "ECS Service Auto Scaling (optional)",
    "Amazon ECR Repository",
    "ECR Lifecycle Policy",
    "IAM Role - ECS Task Execution Role",
    "IAM Role - ECS Task Role",
    "IAM OIDC Provider - token.actions.githubusercontent.com",
    "IAM Role - GitHub Actions Deploy Role (OIDC trust)",
    "CloudWatch Log Group(s)",
    "CloudWatch Alarms",
    "CloudWatch Dashboard (optional)",
    "AWS Certificate Manager (ACM) Certificate",
    "Amazon Route 53 Hosted Zone (if needed)",
    "Route 53 Alias Record to ALB",
    "AWS WAFv2 Web ACL (optional)"
  ]
}