{
  "aws_architecture_description": "### Target deployment architecture (lean, AWS best-practice aligned)\n\nThis system is a **static MkDocs site** built in CI and deployed to AWS. The simplest reliable AWS architecture is:\n\n1. **Build & deploy (GitHub Actions → AWS via OIDC)**\n   - GitHub Actions builds the MkDocs site (HTML/CSS/JS) and deploys it using short‑lived AWS credentials obtained via **STS AssumeRoleWithWebIdentity** through a configured **GitHub OIDC provider** and environment-specific **IAM roles**. ([github.com](https://github.com/aws-actions/configure-aws-credentials?utm_source=openai))\n   - Use separate roles for **dev** and **prod** (and optionally PR preview) with least-privilege policies.\n\n2. **Static site hosting (S3 origin + CloudFront in front)**\n   - Host the built site in an **S3 bucket per environment** (dev/prod). \n   - Put **CloudFront** in front of each bucket to:\n     - avoid public S3 website endpoints,\n     - provide HTTPS, caching, and global performance,\n     - restrict S3 access to CloudFront using **Origin Access Control (OAC)**.\n   - This lets you keep **S3 Block Public Access enabled** (recommended) and avoid public-read bucket policies. ([docs.aws.amazon.com](https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html?utm_source=openai))\n\n3. **DNS + TLS**\n   - Use **Route 53** for `docs-dev.example.com` and `docs.example.com`.\n   - Use **ACM certificates** (in `us-east-1` for CloudFront) for HTTPS.\n\n4. **Artifacts & infrastructure state**\n   - Keep the existing **artifact bucket** for build archives.\n   - Keep a dedicated **Terraform remote state S3 bucket** with **versioning + encryption** and **state locking** enabled.\n   - Prefer **S3 native state locking** (Terraform 1.10+) rather than DynamoDB locking. ([docs.aws.amazon.com](https://docs.aws.amazon.com/prescriptive-guidance/latest/terraform-aws-provider-best-practices/backend.html?utm_source=openai))\n\n5. **Security, audit, and operations**\n   - Enforce least privilege on deploy roles.\n   - Enable CloudFront access logs (optional) and S3 server access logs (optional) depending on your audit needs.\n   - Use CloudWatch alarms sparingly (e.g., CloudFront 4xx/5xx spikes) if you want basic operational visibility.\n\n### Environment layout\n\n- **Dev environment**\n  - `docs-dev` S3 bucket (private)\n  - CloudFront distribution (dev)\n  - Route53 record `docs-dev.example.com`\n  - IAM role `gha-deploy-dev`\n\n- **Prod environment**\n  - `docs-prod` S3 bucket (private)\n  - CloudFront distribution (prod)\n  - Route53 record `docs.example.com`\n  - IAM role `gha-deploy-prod`\n\n- **Shared**\n  - Artifact bucket (can be shared across envs)\n  - Terraform state bucket (often per account/region; keys per env)\n  - GitHub OIDC provider in IAM\n\n> Note: Your repo currently includes S3 “static website hosting” configuration and public-read bucket policy patterns. With CloudFront+OAC, you typically **do not** use the S3 website endpoint and you **do not** need public bucket access, aligning with AWS guidance to block public access wherever possible. ([docs.aws.amazon.com](https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html?utm_source=openai))\n\n---\n\n## AWS resources to provision\n\n### Core networking (none required)\n- **No VPC required** (S3 + CloudFront + IAM are managed services and do not need a VPC for this use case).\n\n### Identity & access management\n- **IAM OIDC Identity Provider** for GitHub Actions\n- **IAM Role**: `gha-deploy-dev`\n- **IAM Role**: `gha-deploy-prod`\n- (Optional) **IAM Role**: `gha-deploy-pr-preview`\n- **IAM Policies** attached to each role (least privilege):\n  - S3 write to the specific site bucket prefix\n  - S3 write to artifact bucket (if used by that workflow)\n  - CloudFront invalidation permission (if you invalidate on deploy)\n\n### Static site storage (origins)\n- **S3 Bucket**: `docs-dev-site` (private)\n- **S3 Bucket**: `docs-prod-site` (private)\n- **S3 Bucket Policy** for each site bucket allowing access only from CloudFront (via OAC)\n- **S3 Bucket Public Access Block** enabled (account-level and/or bucket-level) ([docs.aws.amazon.com](https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html?utm_source=openai))\n- **S3 Bucket Versioning** (recommended for rollback)\n- **S3 Default Encryption** (SSE-S3 or SSE-KMS)\n\n### CDN / edge\n- **CloudFront Distribution** (dev)\n- **CloudFront Distribution** (prod)\n- **CloudFront Origin Access Control (OAC)** for each distribution\n- (Optional) **CloudFront Response Headers Policy** (security headers)\n- (Optional) **CloudFront Cache Policy** tuned for static assets\n\n### DNS + certificates\n- **Route 53 Hosted Zone** (if not already existing)\n- **Route 53 A/AAAA Alias Records** pointing to CloudFront:\n  - `docs-dev.example.com`\n  - `docs.example.com`\n- **ACM Certificate** in `us-east-1` for CloudFront (dev/prod SANs or separate certs)\n\n### CI/CD support buckets\n- **S3 Bucket**: `factually-settled-boxer-artifacts` (artifact storage)\n  - encryption + lifecycle policy (e.g., expire old artifacts)\n\n### Terraform backend\n- **S3 Bucket**: `tf-state-<region>-<env>` (or a single shared state bucket with per-env keys)\n  - versioning enabled\n  - encryption enabled\n  - **S3 native state locking** (Terraform backend `use_lockfile = true`) ([docs.aws.amazon.com](https://docs.aws.amazon.com/prescriptive-guidance/latest/terraform-aws-provider-best-practices/backend.html?utm_source=openai))\n- (Optional, legacy) **DynamoDB table** for Terraform state locking (only if you can’t use S3 native locking)\n\n### Observability / audit (optional but common)\n- **CloudTrail** (account-level; often already present)\n- (Optional) **S3 access logs bucket** (central logging bucket)\n- (Optional) **CloudFront standard logs** to S3\n- (Optional) **CloudWatch Alarms** for CloudFront 4xx/5xx rates\n\n---\n\nIf you want, I can also map these resources directly to Terraform module boundaries (e.g., `site-dev`, `site-prod`, `iam-oidc`, `tf-backend`) and propose least-privilege IAM policy statements for the GitHub Actions deploy roles.",
  "aws_resources": [
    "IAM OIDC Identity Provider (GitHub Actions)",
    "IAM Role (GitHub Actions deploy - dev)",
    "IAM Role (GitHub Actions deploy - prod)",
    "IAM Role (optional: GitHub Actions deploy - PR preview)",
    "IAM Policy (least-privilege S3 deploy permissions per env)",
    "IAM Policy (optional: CloudFront invalidation permissions)",
    "Amazon S3 Bucket (static site origin - dev, private)",
    "Amazon S3 Bucket (static site origin - prod, private)",
    "S3 Bucket Policy (allow CloudFront OAC access to origin buckets)",
    "S3 Block Public Access configuration (account and/or bucket level)",
    "S3 Bucket Versioning (site buckets)",
    "S3 Default Encryption (SSE-S3 or SSE-KMS)",
    "Amazon CloudFront Distribution (dev)",
    "Amazon CloudFront Distribution (prod)",
    "CloudFront Origin Access Control (OAC)",
    "CloudFront Cache Policy (optional)",
    "CloudFront Response Headers Policy (optional)",
    "Amazon Route 53 Hosted Zone (if needed)",
    "Route 53 Record Set (A/AAAA alias to CloudFront for dev)",
    "Route 53 Record Set (A/AAAA alias to CloudFront for prod)",
    "AWS Certificate Manager (ACM) Certificate in us-east-1 for CloudFront",
    "Amazon S3 Bucket (artifact bucket: factually-settled-boxer-artifacts)",
    "S3 Lifecycle Policy (artifact retention)",
    "Amazon S3 Bucket (Terraform remote state: tf-state-<region>-<env>)",
    "S3 Versioning (Terraform state bucket)",
    "S3 Default Encryption (Terraform state bucket)",
    "Terraform S3 backend native state locking (use_lockfile=true)",
    "Amazon DynamoDB Table (optional/legacy: Terraform state locking)",
    "AWS CloudTrail (optional if not already enabled)",
    "Amazon S3 Bucket (optional: centralized access logs)",
    "CloudFront Standard Logs to S3 (optional)",
    "Amazon CloudWatch Alarms (optional: CloudFront 4xx/5xx)"
  ]
}