{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\ntitle SSM Parameter Store Backup (Lambda) - Deployment Architecture\n\nskinparam shadowing false\nskinparam wrapWidth 220\nskinparam maxMessageSize 120\n\nnode \"AWS Account\" as aws {\n\n  node \"EventBridge\" as evb {\n    artifact \"Scheduled Rule\\n(daily cron)\" as rule\n  }\n\n  node \"AWS Lambda\" as lambda {\n    artifact \"ssm_backup\\nPython runtime\\n(boto3/botocore)\" as fn\n    artifact \"Env Vars\\nS3_BUCKET\\nKMS_KEY_ARN\" as env\n  }\n\n  database \"SSM Parameter Store\" as ssm {\n    artifact \"Parameters\\n(SecureString/String)\" as params\n  }\n\n  node \"Amazon S3\" as s3 {\n    artifact \"Backup Bucket\" as bucket\n    artifact \"Object: backups/parameters-<timestamp>.json\\nSSE-KMS\" as obj\n  }\n\n  node \"AWS KMS\" as kms {\n    artifact \"Customer Managed Key\\n(KMS_KEY_ARN)\" as key\n  }\n\n  node \"IAM\" as iam {\n    artifact \"Lambda Execution Role\" as role\n    artifact \"Policy\\nssm:DescribeParameters\\nssm:GetParameters\\ns3:PutObject\\nkms:Encrypt\" as policy\n  }\n}\n\nrule --> fn : triggers\nfn --> ssm : DescribeParameters\\nGetParameters\nfn --> s3 : PutObject (JSON backup)\ns3 --> kms : SSE-KMS encrypt\nfn ..> kms : uses key ARN\nfn ..> role : assumes\nrole --> policy : attached\n\n@enduml",
  "svg_diagram": "<?plantuml 1.2026.2beta1?><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" contentStyleType=\"text/css\" data-diagram-type=\"DESCRIPTION\" height=\"840px\" preserveAspectRatio=\"none\" style=\"width:1322px;height:840px;background:#FFFFFF;\" version=\"1.1\" viewBox=\"0 0 1322 840\" width=\"1322px\" zoomAndPan=\"magnify\"><title>SSM Parameter Store Backup (Lambda) - Deployment Architecture</title><defs/><g><g class=\"title\" data-source-line=\"4\"><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"526.7842\" x=\"390.6079\" y=\"22.9951\">SSM Parameter Store Backup (Lambda) - Deployment Architecture</text></g><!--cluster aws--><g class=\"cluster\" data-qualified-name=\"aws\" data-source-line=\"10\" id=\"ent0002\"><polygon fill=\"#FFFFFF\" points=\"16,53.2969,26,43.2969,1305,43.2969,1305,813.5669,1295,823.5669,16,823.5669,16,53.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1295\" x2=\"1305\" y1=\"53.2969\" y2=\"43.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"16\" x2=\"1295\" y1=\"53.2969\" y2=\"53.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1295\" x2=\"1295\" y1=\"53.2969\" y2=\"823.5669\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"104.9111\" x=\"604.0444\" y=\"69.292\">AWS Account</text></g><!--cluster evb--><g class=\"cluster\" data-qualified-name=\"aws.evb\" data-source-line=\"12\" id=\"ent0003\"><polygon fill=\"#FFFFFF\" points=\"805,101.2969,815,91.2969,977,91.2969,977,192.8969,967,202.8969,805,202.8969,805,101.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"967\" x2=\"977\" y1=\"101.2969\" y2=\"91.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"805\" x2=\"967\" y1=\"101.2969\" y2=\"101.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"967\" x2=\"967\" y1=\"101.2969\" y2=\"202.8969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"96.7559\" x=\"838.6221\" y=\"117.292\">EventBridge</text></g><!--cluster lambda--><g class=\"cluster\" data-qualified-name=\"aws.lambda\" data-source-line=\"16\" id=\"ent0005\"><polygon fill=\"#FFFFFF\" points=\"801,259.8969,811,249.8969,1146,249.8969,1146,367.7869,1136,377.7869,801,377.7869,801,259.8969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1136\" x2=\"1146\" y1=\"259.8969\" y2=\"249.8969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"801\" x2=\"1136\" y1=\"259.8969\" y2=\"259.8969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1136\" x2=\"1136\" y1=\"259.8969\" y2=\"377.7869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"103.6807\" x=\"917.6597\" y=\"275.892\">AWS Lambda</text></g><!--cluster ssm--><g class=\"cluster\" data-qualified-name=\"aws.ssm\" data-source-line=\"21\" id=\"ent0008\"><path d=\"M48,456.7869 C48,446.7869 170.5,446.7869 170.5,446.7869 C170.5,446.7869 293,446.7869 293,456.7869 L293,574.3769 C293,584.3769 170.5,584.3769 170.5,584.3769 C170.5,584.3769 48,584.3769 48,574.3769 L48,456.7869\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M48,456.7869 C48,466.7869 170.5,466.7869 170.5,466.7869 C170.5,466.7869 293,466.7869 293,456.7869\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"169.873\" x=\"85.5635\" y=\"481.782\">SSM Parameter Store</text></g><!--cluster s3--><g class=\"cluster\" data-qualified-name=\"aws.s3\" data-source-line=\"25\" id=\"ent0010\"><polygon fill=\"#FFFFFF\" points=\"333,458.6369,343,448.6369,881,448.6369,881,582.5269,871,592.5269,333,592.5269,333,458.6369\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"871\" x2=\"881\" y1=\"458.6369\" y2=\"448.6369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"333\" x2=\"871\" y1=\"458.6369\" y2=\"458.6369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"871\" x2=\"871\" y1=\"458.6369\" y2=\"592.5269\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"87.3018\" x=\"559.3491\" y=\"474.632\">Amazon S3</text></g><!--cluster kms--><g class=\"cluster\" data-qualified-name=\"aws.kms\" data-source-line=\"30\" id=\"ent0013\"><polygon fill=\"#FFFFFF\" points=\"631,665.5269,641,655.5269,896,655.5269,896,773.1169,886,783.1169,631,783.1169,631,665.5269\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"886\" x2=\"896\" y1=\"665.5269\" y2=\"655.5269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"631\" x2=\"886\" y1=\"665.5269\" y2=\"665.5269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"886\" x2=\"886\" y1=\"665.5269\" y2=\"783.1169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"76.0977\" x=\"721.4512\" y=\"681.522\">AWS KMS</text></g><!--cluster iam--><g class=\"cluster\" data-qualified-name=\"aws.iam\" data-source-line=\"34\" id=\"ent0015\"><polygon fill=\"#FFFFFF\" points=\"1043,482.9369,1053,472.9369,1281,472.9369,1281,789.5669,1271,799.5669,1043,799.5669,1043,482.9369\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1271\" x2=\"1281\" y1=\"482.9369\" y2=\"472.9369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1043\" x2=\"1271\" y1=\"482.9369\" y2=\"482.9369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1271\" x2=\"1271\" y1=\"482.9369\" y2=\"799.5669\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"29.9756\" x=\"1143.0122\" y=\"498.932\">IAM</text></g><!--entity rule--><g class=\"entity\" data-qualified-name=\"aws.evb.rule\" data-source-line=\"13\" id=\"ent0004\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"138.7734\" x=\"821.61\" y=\"131.2969\"/><polygon fill=\"#FFFFFF\" points=\"943.3834,136.2969,943.3834,150.2969,955.3834,150.2969,955.3834,142.2969,949.3834,136.2969,943.3834,136.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"949.3834\" x2=\"949.3834\" y1=\"136.2969\" y2=\"142.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"955.3834\" x2=\"949.3834\" y1=\"142.2969\" y2=\"142.2969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"73.2197\" x=\"831.61\" y=\"157.292\">Scheduled</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"904.8297\" y=\"157.292\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"31.1035\" x=\"909.2799\" y=\"157.292\">Rule</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"38.9922\" x=\"846.0988\" y=\"173.5889\">(daily</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"885.091\" y=\"173.5889\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"36.3535\" x=\"889.5412\" y=\"173.5889\">cron)</text></g><!--entity fn--><g class=\"entity\" data-qualified-name=\"aws.lambda.fn\" data-source-line=\"17\" id=\"ent0006\"><rect fill=\"#FFFFFF\" height=\"71.8906\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"148.1934\" x=\"816.9\" y=\"289.8969\"/><polygon fill=\"#FFFFFF\" points=\"948.0934,294.8969,948.0934,308.8969,960.0934,308.8969,960.0934,300.8969,954.0934,294.8969,948.0934,294.8969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"954.0934\" x2=\"954.0934\" y1=\"294.8969\" y2=\"300.8969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"960.0934\" x2=\"954.0934\" y1=\"300.8969\" y2=\"300.8969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"86.2559\" x=\"842.8688\" y=\"315.892\">ssm_backup</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.5283\" x=\"831.9415\" y=\"332.1889\">Python</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"880.4698\" y=\"332.1889\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"55.1318\" x=\"884.92\" y=\"332.1889\">runtime</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"118.1934\" x=\"826.9\" y=\"348.4857\">(boto3/botocore)</text></g><!--entity env--><g class=\"entity\" data-qualified-name=\"aws.lambda.env\" data-source-line=\"18\" id=\"ent0007\"><rect fill=\"#FFFFFF\" height=\"71.8906\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"130.502\" x=\"999.75\" y=\"289.8969\"/><polygon fill=\"#FFFFFF\" points=\"1113.252,294.8969,1113.252,308.8969,1125.252,308.8969,1125.252,300.8969,1119.252,294.8969,1113.252,294.8969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1119.252\" x2=\"1119.252\" y1=\"294.8969\" y2=\"300.8969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1125.252\" x2=\"1119.252\" y1=\"300.8969\" y2=\"300.8969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"26.0039\" x=\"1029.1709\" y=\"315.892\">Env</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1055.1748\" y=\"315.892\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"31.2061\" x=\"1059.625\" y=\"315.892\">Vars</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"80.999\" x=\"1019.5015\" y=\"332.1889\">S3_BUCKET</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"100.502\" x=\"1009.75\" y=\"348.4857\">KMS_KEY_ARN</text></g><!--entity params--><g class=\"entity\" data-qualified-name=\"aws.ssm.params\" data-source-line=\"22\" id=\"ent0009\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"177.6426\" x=\"72.18\" y=\"504.7869\"/><polygon fill=\"#FFFFFF\" points=\"232.8226,509.7869,232.8226,523.7869,244.8226,523.7869,244.8226,515.7869,238.8226,509.7869,232.8226,509.7869\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"238.8226\" x2=\"238.8226\" y1=\"509.7869\" y2=\"515.7869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"244.8226\" x2=\"238.8226\" y1=\"515.7869\" y2=\"515.7869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"80.7598\" x=\"115.6214\" y=\"530.782\">Parameters</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"147.6426\" x=\"82.18\" y=\"547.0789\">(SecureString/String)</text></g><!--entity bucket--><g class=\"entity\" data-qualified-name=\"aws.s3.bucket\" data-source-line=\"26\" id=\"ent0011\"><rect fill=\"#FFFFFF\" height=\"39.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"134.583\" x=\"356.71\" y=\"512.9369\"/><polygon fill=\"#FFFFFF\" points=\"474.293,517.9369,474.293,531.9369,486.293,531.9369,486.293,523.9369,480.293,517.9369,474.293,517.9369\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"480.293\" x2=\"480.293\" y1=\"517.9369\" y2=\"523.9369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"486.293\" x2=\"480.293\" y1=\"523.9369\" y2=\"523.9369\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"51.748\" x=\"366.71\" y=\"538.932\">Backup</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"418.458\" y=\"538.932\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.3848\" x=\"422.9082\" y=\"538.932\">Bucket</text></g><!--entity obj--><g class=\"entity\" data-qualified-name=\"aws.s3.obj\" data-source-line=\"27\" id=\"ent0012\"><rect fill=\"#FFFFFF\" height=\"71.8906\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"311.3467\" x=\"526.33\" y=\"496.6369\"/><polygon fill=\"#FFFFFF\" points=\"820.6767,501.6369,820.6767,515.6369,832.6767,515.6369,832.6767,507.6369,826.6767,501.6369,820.6767,501.6369\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"826.6767\" x2=\"826.6767\" y1=\"501.6369\" y2=\"507.6369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"832.6767\" x2=\"826.6767\" y1=\"507.6369\" y2=\"507.6369\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"50.3125\" x=\"651.8471\" y=\"522.632\">Object:</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"281.3467\" x=\"536.33\" y=\"538.9289\">backups/parameters-&lt;timestamp&gt;.json</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"61.8174\" x=\"646.0946\" y=\"555.2257\">SSE-KMS</text></g><!--entity key--><g class=\"entity\" data-qualified-name=\"aws.kms.key\" data-source-line=\"31\" id=\"ent0014\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"197.4805\" x=\"655.26\" y=\"703.5269\"/><polygon fill=\"#FFFFFF\" points=\"835.7405,708.5269,835.7405,722.5269,847.7405,722.5269,847.7405,714.5269,841.7405,708.5269,835.7405,708.5269\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"841.7405\" x2=\"841.7405\" y1=\"708.5269\" y2=\"714.5269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"847.7405\" x2=\"841.7405\" y1=\"714.5269\" y2=\"714.5269\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"68.0039\" x=\"665.26\" y=\"729.522\">Customer</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"733.2639\" y=\"729.522\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"64.4971\" x=\"737.7141\" y=\"729.522\">Managed</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"802.2112\" y=\"729.522\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"26.0791\" x=\"806.6614\" y=\"729.522\">Key</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"111.4258\" x=\"693.2873\" y=\"745.8189\">(KMS_KEY_ARN)</text></g><!--entity role--><g class=\"entity\" data-qualified-name=\"aws.iam.role\" data-source-line=\"35\" id=\"ent0016\"><rect fill=\"#FFFFFF\" height=\"39.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"195.1973\" x=\"1063.4\" y=\"512.9369\"/><polygon fill=\"#FFFFFF\" points=\"1241.5973,517.9369,1241.5973,531.9369,1253.5973,531.9369,1253.5973,523.9369,1247.5973,517.9369,1241.5973,517.9369\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1247.5973\" x2=\"1247.5973\" y1=\"517.9369\" y2=\"523.9369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1253.5973\" x2=\"1247.5973\" y1=\"523.9369\" y2=\"523.9369\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.3691\" x=\"1073.4\" y=\"538.932\">Lambda</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1129.7691\" y=\"538.932\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"69.1318\" x=\"1134.2193\" y=\"538.932\">Execution</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1203.3512\" y=\"538.932\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"30.7959\" x=\"1207.8014\" y=\"538.932\">Role</text></g><!--entity policy--><g class=\"entity\" data-qualified-name=\"aws.iam.policy\" data-source-line=\"36\" id=\"ent0017\"><rect fill=\"#FFFFFF\" height=\"104.4844\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"205.2324\" x=\"1059.38\" y=\"679.0869\"/><polygon fill=\"#FFFFFF\" points=\"1247.6124,684.0869,1247.6124,698.0869,1259.6124,698.0869,1259.6124,690.0869,1253.6124,684.0869,1247.6124,684.0869\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1253.6124\" x2=\"1253.6124\" y1=\"684.0869\" y2=\"690.0869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1259.6124\" x2=\"1253.6124\" y1=\"690.0869\" y2=\"690.0869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"40.7695\" x=\"1136.6114\" y=\"705.082\">Policy</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"175.2324\" x=\"1069.38\" y=\"721.3789\">ssm:DescribeParameters</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"138.6533\" x=\"1087.6696\" y=\"737.6757\">ssm:GetParameters</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"89.3184\" x=\"1112.337\" y=\"753.9726\">s3:PutObject</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"87.5889\" x=\"1113.2018\" y=\"770.2695\">kms:Encrypt</text></g><!--link rule to fn--><g class=\"link\" data-entity-1=\"ent0004\" data-entity-2=\"ent0006\" data-link-type=\"dependency\" data-source-line=\"40\" id=\"lnk18\"><path d=\"M891,187.3069 C891,215.2669 891,252.9369 891,283.5469\" fill=\"none\" id=\"rule-to-fn\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"891,289.5469,895,280.5469,891,284.5469,887,280.5469,891,289.5469\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"46.7754\" x=\"892\" y=\"231.0355\">triggers</text></g><!--link fn to ssm--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0008\" data-link-type=\"dependency\" data-source-line=\"41\" id=\"lnk19\"><path d=\"M816.41,333.1069 C684.32,345.4669 416.1,376.5769 341,430.7869 C320.55,445.5519 306.665,470.1994 297.8362,491.4244 C296.7327,494.0775 295.7081,496.6771 294.7595,499.1973 C294.2853,500.4574 293.83,501.6977 293.3934,502.9148 C293.2843,503.219 295.1811,497.8667 295.0742,498.1681\" fill=\"none\" id=\"fn-to-ssm\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"293.0694,503.8232,299.8467,496.677,294.7401,499.1106,292.3065,494.004,293.0694,503.8232\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"121.9629\" x=\"425\" y=\"405.9255\">DescribeParameters</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"90.6094\" x=\"440.6768\" y=\"419.8943\">GetParameters</text></g><!--link fn to s3--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0010\" data-link-type=\"dependency\" data-source-line=\"42\" id=\"lnk20\"><path d=\"M854.51,362.1969 C846.95,371.6669 840.06,382.4569 836,393.7869 C831.65,405.9169 828.98,411.9769 836,422.7869 C840.77,430.1269 848.57,423.9169 854,430.7869 C857.4813,435.1856 860.3934,440.028 862.8239,445.1381 C863.1277,445.7769 863.424,446.4199 863.7129,447.0667 C863.8574,447.3901 864,447.7144 864.1408,448.0397 C864.2112,448.2023 861.9291,442.8455 861.9986,443.0085\" fill=\"none\" id=\"fn-to-s3\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"864.3507,448.5283,864.5024,438.6806,862.3906,443.9285,857.1427,441.8167,864.3507,448.5283\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"58.6289\" x=\"837\" y=\"405.9255\">PutObject</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"895.6289\" y=\"405.9255\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"34.2598\" x=\"899.4434\" y=\"405.9255\">(JSON</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"48.4219\" x=\"861.1406\" y=\"419.8943\">backup)</text></g><!--link s3 to kms--><g class=\"link\" data-entity-1=\"ent0010\" data-entity-2=\"ent0013\" data-link-type=\"dependency\" data-source-line=\"43\" id=\"lnk21\"><path d=\"M864.1894,592.819 C863.3199,594.7357 862.37,596.6118 861.3326,598.4308 C859.2577,602.0687 856.8325,605.4781 854,608.5269 C846.35,616.7669 836.57,607.4069 830,616.5269 C826.1,621.9369 825.79,626.3569 830,631.5269 C841.18,645.2369 856.46,627.0369 869,639.5269 C872.5938,643.1069 875.5908,647.1806 878.0835,651.5724 C878.7067,652.6703 879.2984,653.7882 879.86,654.9231 C879.9302,655.065 877.3755,649.8115 877.4448,649.9539\" fill=\"none\" id=\"s3-to-kms\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"880.0692,655.3495,879.7296,645.5065,877.8822,650.8532,872.5355,649.0057,880.0692,655.3495\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"52.9863\" x=\"831\" y=\"628.6655\">SSE-KMS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"883.9863\" y=\"628.6655\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"45.9434\" x=\"887.8008\" y=\"628.6655\">encrypt</text></g><!--link fn to kms--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0013\" data-link-type=\"dependency\" data-source-line=\"44\" id=\"lnk22\"><path d=\"M921.76,362.1869 C928.41,371.8269 934.49,382.6869 938,393.7869 C953.92,444.1669 950.26,580.1369 938,631.5269 C932.465,654.7119 920.56,678.6169 909.755,697.1044 C907.0538,701.7262 904.4213,706.0095 901.9742,709.8583 C900.7507,711.7827 899.5736,713.5985 898.4574,715.2936 C897.8993,716.1412 897.3564,716.9587 896.8306,717.7444 C896.5677,718.1373 899.6636,713.5477 899.4095,713.9245\" fill=\"none\" id=\"fn-to-kms\" style=\"stroke:#000000;stroke-width:2;stroke-dasharray:7,7;\"/><polygon fill=\"#000000\" points=\"896.055,718.8992,904.4032,713.6736,898.8504,714.7536,897.7703,709.2008,896.055,718.8992\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"27.4922\" x=\"949\" y=\"537.2255\">uses</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"976.4922\" y=\"537.2255\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"21.4336\" x=\"980.3066\" y=\"537.2255\">key</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1001.7402\" y=\"537.2255\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"25.5234\" x=\"1005.5547\" y=\"537.2255\">ARN</text></g><!--link fn to role--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0016\" data-link-type=\"dependency\" data-source-line=\"45\" id=\"lnk23\"><path d=\"M941.09,362.0769 C968.99,381.9269 1004.19,407.3669 1035,430.7869 C1071.57,458.5869 1108.3585,488.3347 1133.4085,508.8547\" fill=\"none\" id=\"fn-to-role\" style=\"stroke:#000000;stroke-width:2;stroke-dasharray:7,7;\"/><polygon fill=\"#000000\" points=\"1138.05,512.6569,1133.6225,503.8593,1134.1821,509.4884,1128.553,510.048,1138.05,512.6569\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"52.7871\" x=\"1024\" y=\"412.9255\">assumes</text></g><!--link role to policy--><g class=\"link\" data-entity-1=\"ent0016\" data-entity-2=\"ent0017\" data-link-type=\"dependency\" data-source-line=\"46\" id=\"lnk24\"><path d=\"M1161.1,552.4469 C1161.24,581.2969 1161.4997,631.407 1161.7097,672.927\" fill=\"none\" id=\"role-to-policy\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"1161.74,678.9269,1165.6944,669.9068,1161.7147,673.9269,1157.6945,669.9472,1161.74,678.9269\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"53.3203\" x=\"1162\" y=\"628.6655\">attached</text></g><?plantuml-src RLJ1Rjf04BtxAoOvaOFjDDoiAX8aLjLI4XItZIeXeVLwWGtshhKxXf2g_zxPNQ0Gmi76-yPlthmtS569kLG21i_5f6jgM2AsDajJmpR9GkAoApih3DSAXSA4woPb6rkpqhfxB0cmyLoRkAsPGY98rpVNoNLQIOlHXLIyxge3UKhtEzqqMYKjFKOHIgm55CKO9iomHg0mKA0s0eQChxeMUjzPKrRi2cAu5ssjjmsfW87XIuc2OsT45DcLLArx7UoILNeZrGBchBRY2DaOrZxB2fTmStDzTDwmrx6mbYr48Ty4V28mKfeKNv9K672kEuMNm2pGjF0dYW02dAz9oD38QY4yBDObmK0VPb3E6KUuBFXIL5qjAdYYwrJrAYRhBN2ZrPL_oT0nlVFtFwth6aRs1RN_UaPiRJChlK5JDTdYKYkYKYWRrwJKgFkfkt8oCZIQgtSCkLh3BsRiL1NzsV3dtIZ_CLMZSJ4RvRzdWwU7C9DQxzLL35d9B2dy82nVJ9hET1xgg4-l49pYAj1GFccu1N4-2VlEXuQzqLH5Ft3tpwXt-p7i-4g4W4h_zLtPO_b2Qv91SCkcxK5H_DdvPP4rxMtoOhKYAuey9WyycovVpfFPWwl6dWcwwopgXYmPCqNhLC58R6dg8q_3j2knFIN-EXXxGB9p0yCgGFvAtg4aGvvq7Umssg_EYTkwbfnwKXBPlR3So58S9-3ElmWyEUfdamw3ILD5OsMvucRR1aTRJ-ZLabwth137jxHCa07bjrWGHqHFxj35dy57RKzQ7ihxL7re3RrlnUF3BgIhY41NurpEO1SABQCNvWYIP0_INvDt5CZUFUAS8OXPsr6-aNzqT64QXo0ozyly1m00?></g></svg>",
  "architecture_description": "## High-level architecture\n\nThis codebase deploys a scheduled AWS Lambda (Python) that backs up AWS Systems Manager (SSM) Parameter Store parameters into an Amazon S3 bucket as a timestamped JSON file.\n\n### Components\n- **EventBridge scheduled rule (daily)**: Triggers the backup workflow on a cron schedule.\n- **AWS Lambda function `ssm_backup` (Python runtime, boto3/botocore)**:\n  - Entry point: `ssm_backup.lambda_handler`.\n  - Reads all parameters from **SSM Parameter Store** using `DescribeParameters` and `GetParameters`.\n  - Writes a JSON backup to **Amazon S3** at `backups/parameters-<timestamp>.json`.\n  - Uses environment variables:\n    - `S3_BUCKET` (target bucket)\n    - `KMS_KEY_ARN` (KMS key for encryption)\n- **Amazon S3 bucket**: Stores backup objects; objects are encrypted using **SSE-KMS**.\n- **AWS KMS customer-managed key**: Used by S3 for server-side encryption; referenced by the Lambda via `KMS_KEY_ARN`.\n- **IAM execution role/policy for Lambda**: Grants least-privilege access required by the function:\n  - `ssm:DescribeParameters`, `ssm:GetParameters`\n  - `s3:PutObject`\n  - `kms:Encrypt` (for SSE-KMS usage)\n\n### Key relationships / data flow\n1. **EventBridge** triggers the **Lambda** on a daily schedule.\n2. **Lambda** queries **SSM Parameter Store** to retrieve parameter metadata and values.\n3. **Lambda** uploads the resulting JSON document to **S3**.\n4. **S3** encrypts the object using the configured **KMS key (SSE-KMS)**.\n5. **Lambda** runs under an **IAM role** with permissions to call SSM APIs and write encrypted objects to S3."
}