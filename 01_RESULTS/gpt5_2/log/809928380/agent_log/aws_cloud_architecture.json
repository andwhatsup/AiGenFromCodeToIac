{
  "aws_architecture_description": "## Proposed high-level AWS architecture (lean, secure, scalable)\n\n### 1) Core runtime\n- **AWS Lambda (Java 21) – `reminder-bot-lambda`**\n  - Deploy the shaded “fat JAR” produced by Maven Shade.\n  - Handler: `handler.Handler`.\n  - Configure **reserved concurrency** (e.g., 1–2) to prevent accidental message storms.\n  - Configure **timeouts** (e.g., 10–30s) and **memory** (e.g., 512–1024MB) appropriate for Java cold starts.\n\n### 2) Scheduling / invocation\n- **Amazon EventBridge Scheduler** (or EventBridge Rule) triggers the Lambda on the required cadence (e.g., twice a month).\n  - Use two schedules (e.g., “half-month” and “end-month”) if the messages differ, or one schedule if the Lambda decides which message to send.\n\n### 3) Secrets and configuration\n- Store sensitive values (Telegram bot token) in **AWS Secrets Manager**.\n- Store non-sensitive configuration (chat id, message templates) in **SSM Parameter Store** (or also Secrets Manager if you prefer one place).\n- Lambda reads these at runtime using its execution role.\n  - This avoids putting `bot_token` directly in Lambda environment variables.\n\n### 4) Networking / egress\n- **Default approach (recommended for this simple bot):** Lambda runs **without a VPC attachment** and calls the Telegram Bot API over the public internet.\n  - This is simplest and avoids NAT costs/complexity.\n- **Optional hardening:** If you must control egress, attach Lambda to a VPC with private subnets + NAT Gateway and restrict outbound via NACL/SG and (where feasible) egress controls. (Note: Telegram uses public endpoints; you can’t use VPC endpoints for it.)\n\n### 5) Observability and operations\n- **CloudWatch Logs** for Lambda logs.\n- **CloudWatch Alarms** on:\n  - Lambda Errors > 0\n  - Throttles > 0\n  - Duration approaching timeout\n- **AWS X-Ray** (optional) for tracing outbound call latency to Telegram.\n\n### 6) CI/CD (GitHub Actions → AWS)\n- Replace long-lived AWS access keys with **GitHub OIDC → AWS IAM Role** (recommended).\n  - GitHub Actions assumes a deploy role via OIDC and updates Lambda code.\n- Keep the existing workflow pattern:\n  - CI: `mvn verify`\n  - Release: `mvn package` then `aws lambda update-function-code`\n\n### 7) Build/runtime correctness note\n- The code references `org.joda.time.DateTime` but no explicit dependency was detected. Ensure `joda-time` is included (directly or via a known transitive dependency) so the Lambda doesn’t fail at runtime.\n\n---\n\n## Deployment relationships (at a glance)\n1. **GitHub Actions** builds shaded JAR → assumes **IAM deploy role** → updates **Lambda code**.\n2. **EventBridge Scheduler** invokes **Lambda** on schedule.\n3. **Lambda** reads **Secrets Manager / SSM** config → calls **Telegram Bot API** over HTTPS.\n4. **CloudWatch** captures logs/metrics and triggers alarms.\n",
  "aws_resources": [
    "AWS Lambda Function (Java 21) - reminder-bot-lambda",
    "AWS IAM Role - Lambda execution role",
    "AWS IAM Policy - permissions for Secrets Manager/SSM + CloudWatch Logs",
    "AWS Secrets Manager Secret - Telegram bot token",
    "AWS Systems Manager Parameter Store Parameters - chat_id, half_month_message, end_month_message (or store all in Secrets Manager)",
    "Amazon EventBridge Scheduler Schedule(s) (or EventBridge Rule) - triggers for half-month/end-month",
    "Amazon CloudWatch Log Group - /aws/lambda/reminder-bot-lambda",
    "Amazon CloudWatch Alarms - Errors/Throttles/Duration (and optional notification)",
    "Amazon SNS Topic (optional) - alarm notifications",
    "AWS IAM OIDC Identity Provider - GitHub (recommended)",
    "AWS IAM Role - GitHub Actions deploy role (assumable via OIDC)",
    "AWS IAM Policy - least-privilege deploy permissions (lambda:UpdateFunctionCode, lambda:GetFunction, etc.)"
  ]
}