{
  "aws_architecture_description": "### Target AWS architecture (lean, EKS-native)\n\n#### 1) Networking foundation\n- Create a dedicated **VPC** spanning **at least 2 Availability Zones**.\n- Use **public subnets** for internet-facing load balancers and **private subnets** for EKS worker nodes and Pods.\n  - This matches AWS EKS best practice: nodes in private subnets, ingress in public subnets, with NAT for egress. ([docs.aws.amazon.com](https://docs.aws.amazon.com/eks/latest/best-practices/subnets.html?utm_source=openai))\n- Provide outbound internet access from private subnets via **NAT Gateway(s)** (so nodes can pull images, reach AWS APIs, etc.).\n\n#### 2) Compute: Amazon EKS\n- Provision an **Amazon EKS cluster** (control plane managed by AWS).\n- Run the workload on **EKS Managed Node Groups** (EC2) in private subnets.\n  - This is sufficient for a static Nginx container and keeps the architecture simple.\n- Install core EKS add-ons:\n  - **VPC CNI**, **CoreDNS**, **kube-proxy** (standard).\n\n#### 3) Ingress / external access\n- Use the **AWS Load Balancer Controller** in the cluster to provision an **Application Load Balancer (ALB)** from Kubernetes Ingress/Service annotations.\n  - Your repo already implies ALB annotations; the controller is the AWS-supported way to create/manage ALBs from EKS. ([docs.aws.amazon.com](https://docs.aws.amazon.com/eks/latest/userguide/alb-ingress.html?utm_source=openai))\n- Terminate TLS at the ALB using **ACM** certificates.\n- Optionally place **AWS WAF** on the ALB for basic L7 protection (SQLi/XSS managed rules), since this is an internet-facing endpoint.\n\n#### 4) Container images / registry strategy\n- Recommended: standardize on **Amazon ECR (private)** as the primary registry for the app image.\n- Because your manifests/workflows reference Docker Hub and GHCR, you have two clean options:\n  1) **Push directly to ECR** from GitHub Actions/Jenkins (preferred).\n  2) Use **ECR Pull Through Cache** to cache upstream images from Docker Hub / GHCR into ECR (reduces external dependency and improves pull reliability). ([docs.aws.amazon.com](https://docs.aws.amazon.com/AmazonECR/latest/userguide/pull-through-cache.html?utm_source=openai))\n\n#### 5) CI/CD on AWS (minimal changes)\n- Keep **GitHub Actions** and/or **Jenkins** as-is, but change the “push” target to ECR and the “deploy” step to update EKS.\n- Secure access from CI to AWS using:\n  - **IAM Role + OIDC federation** for GitHub Actions (no long-lived AWS keys).\n  - For Jenkins: either run Jenkins on AWS (EC2/ECS) with an instance/task role, or store short-lived credentials via an assumed role.\n\n#### 6) Observability, security, and ops\n- Send EKS control plane logs to **CloudWatch Logs**.\n- Use **CloudWatch Container Insights** (or Prometheus/Grafana later if needed) for node/pod metrics.\n- Use **AWS CloudTrail** for audit.\n- Use **AWS Secrets Manager** (or Kubernetes secrets with envelope encryption via KMS) for any registry credentials (if you keep private upstream registries / pull-through cache auth). ([docs.aws.amazon.com](https://docs.aws.amazon.com/AmazonECR/latest/userguide/pull-through-cache.html?utm_source=openai))\n\n---\n\n## Request/traffic flow\n1. User hits `https://your-domain`.\n2. **Route 53** resolves to the **ALB**.\n3. **ALB (AWS Load Balancer Controller-managed)** forwards to the Kubernetes Service/Pods.\n4. Pod runs **nginx:alpine** serving static HTML/CSS/JS.\n\n## Build/deploy flow\n1. GitHub Actions / Jenkins builds the Docker image.\n2. Image is pushed to **ECR** (or cached into ECR via pull-through cache).\n3. CI applies Kubernetes manifests (or Helm/Kustomize) to EKS.\n\n---\n\n# AWS resources to provision\n\n## Networking\n- Amazon VPC\n- Public subnets (2+ AZs)\n- Private subnets (2+ AZs)\n- Internet Gateway (IGW)\n- NAT Gateway(s) + Elastic IP(s)\n- Route tables (public/private) + routes\n- Security Groups (ALB SG, node SG, optional admin/bastion SG)\n- Network ACLs (optional; default is fine for lean setup)\n\n## EKS\n- Amazon EKS Cluster\n- EKS Managed Node Group(s) (EC2)\n- EKS Add-ons: VPC CNI, CoreDNS, kube-proxy\n- IAM OIDC provider for the cluster (for IRSA)\n- IAM roles:\n  - EKS cluster service role\n  - Node group instance role\n  - IRSA role for AWS Load Balancer Controller\n  - (Optional) IRSA role(s) for external-dns, cert-manager, etc.\n\n## Ingress / Edge\n- AWS Load Balancer Controller (installed in-cluster; requires IAM + creates AWS resources)\n- Application Load Balancer (created/managed by controller)\n- Target Groups (created/managed by controller)\n- ACM Certificate(s) for TLS\n- Amazon Route 53 Hosted Zone + DNS records (A/AAAA alias to ALB)\n- AWS WAFv2 Web ACL (optional but recommended for public ALB)\n\n## Container registry\n- Amazon ECR Private Repository (for `range-slider` image)\n- (Optional) ECR Pull Through Cache rule(s) for Docker Hub / GHCR upstreams ([docs.aws.amazon.com](https://docs.aws.amazon.com/AmazonECR/latest/userguide/pull-through-cache.html?utm_source=openai))\n- AWS Secrets Manager secret(s) for upstream registry credentials (if using authenticated pull-through cache) ([docs.aws.amazon.com](https://docs.aws.amazon.com/AmazonECR/latest/userguide/pull-through-cache.html?utm_source=openai))\n\n## CI/CD access to AWS\n- IAM role for GitHub Actions via OIDC (assume-role policy scoped to repo/environment)\n- IAM policy allowing:\n  - ECR push/pull\n  - EKS deploy (typically `eks:DescribeCluster` + Kubernetes RBAC via aws-auth / access entries)\n- (If Jenkins runs on AWS) EC2 instance profile role or ECS task role for Jenkins\n\n## Logging / Monitoring / Audit\n- CloudWatch Log Groups (EKS control plane logs, optional app logs)\n- CloudWatch Container Insights (optional enablement)\n- AWS CloudTrail (org/account trail)\n- AWS KMS key (optional; for Secrets Manager and/or EKS secret encryption)\n\n## Optional hardening (only if needed)\n- VPC Endpoints (Interface/Gateway) for private access to AWS APIs (ECR, S3, STS, CloudWatch Logs) to reduce NAT usage\n- AWS Shield Advanced (usually not needed for small static app)\n- Bastion host or SSM Session Manager access pattern (if you need node access; otherwise avoid)\n\n---\n\nIf you tell me your preferred deployment style (keep Service type LoadBalancer vs move to Ingress objects) and whether you want to keep Docker Hub/GHCR as the source of truth or migrate fully to ECR, I can tighten the resource list further and call out exactly which IAM policies/roles are required.",
  "aws_resources": [
    "Amazon VPC",
    "Public Subnets (2+ AZs)",
    "Private Subnets (2+ AZs)",
    "Internet Gateway (IGW)",
    "NAT Gateway(s)",
    "Elastic IP(s) for NAT",
    "Route Tables (public/private) and Routes",
    "Security Groups (ALB, nodes, optional admin)",
    "Amazon EKS Cluster",
    "EKS Managed Node Group(s) (EC2)",
    "EKS Add-ons (VPC CNI, CoreDNS, kube-proxy)",
    "IAM OIDC Provider for EKS (IRSA)",
    "IAM Role: EKS Cluster Service Role",
    "IAM Role: Node Group Instance Role",
    "IAM Role (IRSA): AWS Load Balancer Controller",
    "AWS Load Balancer Controller (Kubernetes add-on)",
    "Application Load Balancer (ALB)",
    "ALB Target Group(s)",
    "AWS Certificate Manager (ACM) Certificate(s)",
    "Amazon Route 53 Hosted Zone",
    "Route 53 DNS Records (ALIAS to ALB)",
    "AWS WAFv2 Web ACL (optional)",
    "Amazon ECR Private Repository",
    "ECR Pull Through Cache Rule(s) (optional)",
    "AWS Secrets Manager Secret(s) (optional; for registry auth)",
    "IAM Role for GitHub Actions (OIDC federation)",
    "IAM Policies for CI/CD (ECR + EKS access)",
    "Amazon CloudWatch Log Groups",
    "CloudWatch Container Insights (optional)",
    "AWS CloudTrail",
    "AWS KMS Key (optional)"
  ]
}