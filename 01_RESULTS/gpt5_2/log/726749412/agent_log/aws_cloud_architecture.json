{
  "aws_architecture_description": "### Target AWS deployment (lean, secure, scalable)\n\n#### 1) Container runtime (serving traffic)\n- **Amazon ECS on AWS Fargate** runs the existing Dockerized Node.js/Express app (listening on **port 3000**) without managing servers.\n- The service is deployed in a **VPC across 2+ Availability Zones**:\n  - **Public subnets**: only the load balancer.\n  - **Private subnets**: ECS tasks (app containers) with no public IPs.\n- **Application Load Balancer (ALB)** terminates TLS (HTTPS) and forwards traffic to the ECS service target group on port 3000.\n- **Blue/Green deployments** are implemented with **AWS CodeDeploy (ECS blue/green)**:\n  - Two ALB target groups (blue and green).\n  - CodeDeploy shifts traffic from blue → green with health checks and optional manual approval.\n\n#### 2) Container image registry\n- Replace Docker Hub with **Amazon ECR** for first-party IAM auth, private networking options, and tighter integration.\n- Jenkins builds the image from the existing `Dockerfile`, tags it (e.g., git SHA + `latest`), and pushes to ECR.\n\n#### 3) CI/CD (keeping Jenkins, but AWS-native delivery)\n- Keep **Jenkins** as the orchestrator (as in your repo), but run it on AWS:\n  - **Option A (leaner ops):** Jenkins controller on **ECS Fargate** (plus EFS for persistent Jenkins home).\n  - **Option B (traditional):** Jenkins on **EC2** with an EBS volume.\n- Jenkins pipeline stages map cleanly:\n  - **Test:** run Mocha tests.\n  - **Quality:** run SonarQube scan (either keep existing SonarQube or host it on AWS).\n  - **Security:** run Trivy scan.\n  - **Publish:** push image to ECR.\n  - **Deploy:** trigger **CodeDeploy** to perform ECS blue/green.\n- **Slack notifications** remain from Jenkins (store Slack webhook/token in AWS Secrets Manager).\n\n#### 4) Observability, security, and operations\n- **CloudWatch Logs** collects container stdout/stderr from ECS tasks.\n- **CloudWatch Alarms** on ALB 5xx, target health, latency, and ECS service CPU/memory.\n- **AWS WAF** on the ALB for basic L7 protection (managed rules).\n- **Secrets Manager** for any runtime secrets (and Jenkins credentials like ECR auth if needed).\n- **IAM roles**:\n  - ECS task execution role (pull from ECR, write logs).\n  - ECS task role (app permissions; likely minimal for this app).\n  - CodeDeploy service role.\n  - Jenkins instance/task role to push to ECR and trigger deployments.\n\n#### 5) Static HTML handling\n- Your app currently serves `index.html`/`about.html` from the container. That works as-is.\n- Optional optimization (only if desired): move static assets to **S3 + CloudFront** and keep ECS for API/dynamic routes. For this codebase, it’s not required.\n\n---\n\n### AWS resources to provision\n\n#### Networking\n- **VPC**\n- **Internet Gateway (IGW)**\n- **NAT Gateway** (one per AZ recommended; at minimum one)\n- **Public subnets** (2+ AZ)\n- **Private subnets** (2+ AZ)\n- **Route tables** (public + private) and routes\n- **VPC endpoints (optional but recommended)**:\n  - Interface endpoints: **ECR (api, dkr)**, **CloudWatch Logs**, **Secrets Manager**\n  - Gateway endpoint: **S3** (if using S3/CloudFront or for general private access)\n\n#### Load balancing / edge\n- **Application Load Balancer (ALB)**\n- **ALB listeners** (HTTP→HTTPS redirect, HTTPS)\n- **Target Groups (2)** for blue/green\n- **ACM certificate** for TLS\n- **Route 53 hosted zone + DNS record** (if you manage DNS in AWS)\n- **AWS WAFv2 Web ACL** associated to ALB\n\n#### Compute (application)\n- **ECS Cluster (Fargate)**\n- **ECS Task Definition** (container port 3000, env vars, log config)\n- **ECS Service** (desired count, autoscaling, deployment controller)\n- **Security Groups**:\n  - ALB SG (inbound 443/80 from internet; outbound to ECS)\n  - ECS Service SG (inbound 3000 from ALB SG only)\n- **Application Auto Scaling** for ECS service (target tracking on CPU/memory)\n\n#### Container registry\n- **Amazon ECR repository**\n- **ECR lifecycle policy** (retain last N images)\n- **ECR repository policy** (if cross-account access is needed)\n\n#### Blue/Green deployment\n- **AWS CodeDeploy application (ECS)**\n- **CodeDeploy deployment group** (blue/green, ALB listener + 2 target groups)\n- **IAM role for CodeDeploy**\n\n#### CI/CD (Jenkins on AWS)\n- **Option A: Jenkins on ECS Fargate**\n  - ECS service/task definition for Jenkins controller\n  - **EFS file system** + mount targets (for Jenkins home)\n  - Security group for Jenkins (restricted admin access)\n  - (Optional) internal ALB for Jenkins UI\n- **Option B: Jenkins on EC2**\n  - **EC2 instance** (or Auto Scaling Group)\n  - **EBS volume** for Jenkins home\n  - Security group for Jenkins\n- **IAM role/policy for Jenkins** (push to ECR, read secrets, trigger CodeDeploy)\n- **Secrets Manager secrets** (Slack webhook/token, SonarQube token, any registry creds)\n\n#### Logging / monitoring / security\n- **CloudWatch Log Groups** (ECS app, optionally Jenkins)\n- **CloudWatch dashboards** (optional)\n- **CloudWatch alarms** (ALB + ECS)\n- **SNS topic** for alarm notifications (optional)\n- **AWS CloudTrail** (account-level; recommended)\n- **AWS Config** (optional, governance)\n- **KMS keys** (for encrypting ECR, EFS, Secrets Manager, logs where applicable)\n\n#### Optional (only if you choose to externalize static content)\n- **S3 bucket** for static site assets\n- **CloudFront distribution**\n- **Origin Access Control (OAC)**\n\nIf you tell me whether you want to (a) keep Jenkins, or migrate to AWS CodePipeline/CodeBuild, and (b) whether you need a public domain name, I can tighten this into a minimal “exact” bill of materials for your preferred path.",
  "aws_resources": [
    "VPC",
    "Internet Gateway (IGW)",
    "NAT Gateway",
    "Public Subnets (2+)",
    "Private Subnets (2+)",
    "Route Tables (public/private) and Routes",
    "VPC Endpoints (optional): ECR (api,dkr), CloudWatch Logs, Secrets Manager, S3 gateway",
    "Application Load Balancer (ALB)",
    "ALB Listeners (HTTP, HTTPS)",
    "ALB Target Groups (Blue, Green)",
    "AWS Certificate Manager (ACM) Certificate",
    "Route 53 Hosted Zone and DNS Record (optional)",
    "AWS WAFv2 Web ACL",
    "Amazon ECS Cluster (Fargate)",
    "ECS Task Definition (Node.js/Express container)",
    "ECS Service",
    "Security Group: ALB",
    "Security Group: ECS Service",
    "Application Auto Scaling for ECS Service",
    "Amazon ECR Repository",
    "ECR Lifecycle Policy",
    "ECR Repository Policy (optional)",
    "AWS CodeDeploy Application (ECS)",
    "AWS CodeDeploy Deployment Group (Blue/Green)",
    "IAM Role for CodeDeploy",
    "Jenkins hosting (choose one): ECS Fargate Service/Task Definition OR EC2 Instance/ASG",
    "EFS File System + Mount Targets (if Jenkins on ECS)",
    "EBS Volume (if Jenkins on EC2)",
    "Security Group for Jenkins",
    "IAM Role/Policies for Jenkins",
    "AWS Secrets Manager Secrets (Slack, SonarQube, etc.)",
    "Amazon CloudWatch Log Groups",
    "CloudWatch Alarms",
    "CloudWatch Dashboard (optional)",
    "SNS Topic for Alerts (optional)",
    "AWS CloudTrail",
    "AWS Config (optional)",
    "AWS KMS Keys",
    "S3 Bucket + CloudFront Distribution + OAC (optional for static assets)"
  ]
}