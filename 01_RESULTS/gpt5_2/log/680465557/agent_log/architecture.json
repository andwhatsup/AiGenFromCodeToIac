{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\nskinparam shadowing false\nskinparam componentStyle rectangle\nskinparam wrapWidth 220\nskinparam maxMessageSize 120\n\ntitle High-level Deployment Architecture (AWS Lambda container image)\n\nactor \"GitHub\" as github\n\ncloud \"AWS Account\" as aws {\n\n  node \"Amazon EventBridge\\n(Scheduled Rule)\" as eventbridge\n\n  node \"Amazon ECR\\n(Container Image Repository)\" as ecr\n\n  node \"AWS Lambda\\nPython 3.11 (container image)\\nHandler: lambda_function.py\\nEphemeral /tmp\" as lambda\n\n  node \"AWS Organizations\\n(SCPs)\" as orgs\n  node \"AWS IAM\\n(Roles & Policies)\" as iam\n\n  node \"AWS CloudTrail\" as cloudtrail\n  database \"Amazon S3\\n(CloudTrail Log Bucket)\" as s3\n}\n\n' Build/deploy relationship\n ecr --> lambda : Pull container image\n\n' Trigger\n eventbridge --> lambda : Invoke on schedule\n\n' AWS API calls\n lambda --> orgs : boto3: list/describe SCPs\n lambda --> iam : boto3: list roles/policies\n\n' CloudTrail logging\n cloudtrail --> s3 : Deliver logs\n\n' External integration\n lambda --> github : HTTPS (git clone/push)\\nPyGithub/requests\\nToken auth\n\nnote right of lambda\nDependencies (requirements.txt):\n- boto3/botocore\n- PyGithub, requests\n- cryptography, PyJWT, PyNaCl\nUses /tmp for repo checkout\nend note\n\n@enduml",
  "svg_diagram": "<?plantuml 1.2026.2beta1?><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" contentStyleType=\"text/css\" data-diagram-type=\"DESCRIPTION\" height=\"592px\" preserveAspectRatio=\"none\" style=\"width:951px;height:592px;background:#FFFFFF;\" version=\"1.1\" viewBox=\"0 0 951 592\" width=\"951px\" zoomAndPan=\"magnify\"><title>High-level Deployment Architecture (AWS Lambda container image)</title><defs/><g><g class=\"title\" data-source-line=\"9\"><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"538.1865\" x=\"199.8485\" y=\"22.9951\">High-level Deployment Architecture (AWS Lambda container image)</text></g><!--cluster aws--><g class=\"cluster\" data-qualified-name=\"aws\" data-source-line=\"13\" id=\"ent0003\"><path d=\"M42.7897,74.0928 C56.8365,53.9544 70.136,54.4993 85.3075,72.8504 C103.538,49.4927 120.041,52.6135 136.691,74.6399 C150.6291,55.0056 169.5819,54.0683 183.9704,74.1031 C191.8361,50.2469 213.2253,49.9466 227.6908,67.0602 C240.7796,47.3574 262.7211,47.2437 274.6001,68.4475 C286.9668,44.8003 308.9998,45.3737 319.3296,70.3224 C333.248,49.8716 348.4405,43.2969 365.9478,66.4888 C383.6345,46.8606 399.738,45.0267 413.6015,70.5261 C428.5867,43.7888 450.9554,45.3004 465.5785,70.8857 C478.6798,48.3039 492.2032,43.7836 510.2116,65.9963 C526.1055,48.337 543.8227,49.6253 556.8612,69.5413 C570.7224,45.6965 586.3091,51.0394 601.0325,68.6219 C614.415,48.0681 636.5094,49.351 646.3533,72.3078 C661.4427,45.367 685.8354,53.1896 698.0508,75.3347 C701.5836,77.0944 702.3585,79.1442 699.5325,82.2636 C720.8591,92.0641 721.9194,108.0415 704.5925,122.6811 C727.4795,137.5235 721.2502,162.0506 699.8518,172.6954 C719.4297,182.496 725.8243,201.911 705.3374,216.7054 C728.4626,232.7418 726.9485,254.9472 702.1723,268.0297 C723.712,280.3644 722.2691,293.7692 706.879,310.2234 C731.2993,326.1057 726.8881,345.2807 704.0299,358.365 C725.1921,375.5282 722.8135,389.8618 699.8659,402.9008 C722.3541,415.7636 719.1368,433.5362 700.819,447.2755 C721.0163,459.8774 719.1785,480.5506 699.2974,491.7823 C719.9293,511.0408 714.8589,530.832 691.0508,542.9247 C694.6254,541.4881 696.7898,543.1769 696.0509,547.0142 C682.0023,566.9217 667.6016,570.3273 650.0098,551.1925 C635.5368,573.8753 619.5603,577.4694 603.3835,552.8728 C591.1837,575.4949 567.0757,580.0355 552.5513,555.3717 C541.3514,574.585 521.1964,578.3611 508.2323,557.3136 C493.6823,574.3471 478.4003,572.7898 465.9211,554.811 C448.9241,580.4915 432.5468,581.6731 415.5282,554.8317 C406.7993,578.7897 386.1817,581.6089 370.8251,561.565 C352.4345,585.5566 338.1963,581.0744 323.0007,558.2979 C306.3667,582.2953 289.1238,583.3854 271.7335,559.101 C255.0221,581.3334 242.3811,576.5096 229.0324,555.7603 C215.1085,578.564 197.8887,576.3778 186.2999,553.5724 C169.3684,578.2969 150.7333,574.8258 136.8277,550.5193 C124.573,575.2017 102.9549,568.267 91.3594,549.8244 C65.1624,569.5392 45.7128,566.2583 31.0508,535.9247 C37.0571,533.9372 40.348,536.5302 39.1034,542.9061 C13.1683,532.3689 11.7257,511.1943 35.6681,496.9303 C7.1074,483.2631 7.9306,457.2713 35.9437,443.8981 C14.0378,432.598 14.2279,413.5435 34.8893,401.1924 C12.8629,389.6136 12.4518,368.8982 31.0289,353.9981 C6.7781,338.4613 9.7927,323.9161 28.7509,306.3151 C9.5348,288.8856 6.2615,274.1754 32.1703,260.0835 C15.0843,249.2638 12.716,235.0616 29.5671,221.9266 C11.2931,205.5869 7.1854,188.8553 32.325,175.0708 C13.3509,160.3675 9.7597,142.5956 33.1117,128.609 C6,109.6158 12.5647,83.0179 38.0508,68.3347 C42.2581,68.0086 44.3402,69.6804 42.7897,74.0928\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"104.9111\" x=\"312.0953\" y=\"86.3298\">AWS Account</text></g><!--entity eventbridge--><g class=\"entity\" data-qualified-name=\"aws.eventbridge\" data-source-line=\"15\" id=\"ent0004\"><polygon fill=\"#FFFFFF\" points=\"38.6608,105.3347,48.6608,95.3347,225.4352,95.3347,225.4352,147.9285,215.4352,157.9285,38.6608,157.9285,38.6608,105.3347\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"215.4352\" x2=\"225.4352\" y1=\"105.3347\" y2=\"95.3347\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"38.6608\" x2=\"215.4352\" y1=\"105.3347\" y2=\"105.3347\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"215.4352\" x2=\"215.4352\" y1=\"105.3347\" y2=\"157.9285\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.5811\" x=\"53.6608\" y=\"128.3298\">Amazon</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"110.2419\" y=\"128.3298\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"85.7432\" x=\"114.6921\" y=\"128.3298\">EventBridge</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"78.6816\" x=\"67.1994\" y=\"144.6267\">(Scheduled</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"145.881\" y=\"144.6267\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"36.5654\" x=\"150.3312\" y=\"144.6267\">Rule)</text></g><!--entity ecr--><g class=\"entity\" data-qualified-name=\"aws.ecr\" data-source-line=\"17\" id=\"ent0005\"><polygon fill=\"#FFFFFF\" points=\"260.4708,105.3347,270.4708,95.3347,507.6271,95.3347,507.6271,147.9285,497.6271,157.9285,260.4708,157.9285,260.4708,105.3347\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"497.6271\" x2=\"507.6271\" y1=\"105.3347\" y2=\"95.3347\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"260.4708\" x2=\"497.6271\" y1=\"105.3347\" y2=\"105.3347\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"497.6271\" x2=\"497.6271\" y1=\"105.3347\" y2=\"157.9285\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.5811\" x=\"334.359\" y=\"128.3298\">Amazon</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"390.9401\" y=\"128.3298\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"28.3486\" x=\"395.3903\" y=\"128.3298\">ECR</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"73.876\" x=\"275.4708\" y=\"144.6267\">(Container</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"349.3468\" y=\"144.6267\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"43.8457\" x=\"353.797\" y=\"144.6267\">Image</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"397.6427\" y=\"144.6267\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"80.5342\" x=\"402.0929\" y=\"144.6267\">Repository)</text></g><!--entity lambda--><g class=\"entity\" data-qualified-name=\"aws.lambda\" data-source-line=\"19\" id=\"ent0006\"><polygon fill=\"#FFFFFF\" points=\"217.0908,259.7347,227.0908,249.7347,471.0078,249.7347,471.0078,334.9222,461.0078,344.9222,217.0908,344.9222,217.0908,259.7347\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"461.0078\" x2=\"471.0078\" y1=\"259.7347\" y2=\"249.7347\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"217.0908\" x2=\"461.0078\" y1=\"259.7347\" y2=\"259.7347\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"461.0078\" x2=\"461.0078\" y1=\"259.7347\" y2=\"344.9222\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"32.3066\" x=\"292.4863\" y=\"282.7298\">AWS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"324.793\" y=\"282.7298\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.3691\" x=\"329.2432\" y=\"282.7298\">Lambda</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.5283\" x=\"232.0908\" y=\"299.0267\">Python</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"280.6192\" y=\"299.0267\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"31.1719\" x=\"285.0693\" y=\"299.0267\">3.11</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"316.2412\" y=\"299.0267\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"71.7979\" x=\"320.6914\" y=\"299.0267\">(container</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"392.4893\" y=\"299.0267\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"49.0684\" x=\"396.9395\" y=\"299.0267\">image)</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"59.8418\" x=\"237.7681\" y=\"315.3236\">Handler:</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"297.6099\" y=\"315.3236\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"138.2705\" x=\"302.0601\" y=\"315.3236\">lambda_function.py</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"75.6943\" x=\"282.6118\" y=\"331.6205\">Ephemeral</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"358.3062\" y=\"331.6205\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"32.7305\" x=\"362.7564\" y=\"331.6205\">/tmp</text></g><!--entity orgs--><g class=\"entity\" data-qualified-name=\"aws.orgs\" data-source-line=\"21\" id=\"ent0007\"><polygon fill=\"#FFFFFF\" points=\"145.1508,482.3347,155.1508,472.3347,318.9506,472.3347,318.9506,524.9285,308.9506,534.9285,145.1508,534.9285,145.1508,482.3347\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"308.9506\" x2=\"318.9506\" y1=\"482.3347\" y2=\"472.3347\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"145.1508\" x2=\"308.9506\" y1=\"482.3347\" y2=\"482.3347\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"308.9506\" x2=\"308.9506\" y1=\"482.3347\" y2=\"534.9285\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"32.3066\" x=\"160.1508\" y=\"505.3298\">AWS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"192.4575\" y=\"505.3298\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"97.043\" x=\"196.9077\" y=\"505.3298\">Organizations</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"45.3223\" x=\"204.3896\" y=\"521.6267\">(SCPs)</text></g><!--entity iam--><g class=\"entity\" data-qualified-name=\"aws.iam\" data-source-line=\"22\" id=\"ent0008\"><polygon fill=\"#FFFFFF\" points=\"353.4908,482.3347,363.4908,472.3347,514.6031,472.3347,514.6031,524.9285,504.6031,534.9285,353.4908,534.9285,353.4908,482.3347\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"504.6031\" x2=\"514.6031\" y1=\"482.3347\" y2=\"472.3347\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"353.4908\" x2=\"504.6031\" y1=\"482.3347\" y2=\"482.3347\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"504.6031\" x2=\"504.6031\" y1=\"482.3347\" y2=\"534.9285\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"32.3066\" x=\"397.776\" y=\"505.3298\">AWS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"430.0826\" y=\"505.3298\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"25.7852\" x=\"434.5328\" y=\"505.3298\">IAM</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"43.5518\" x=\"368.4908\" y=\"521.6267\">(Roles</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"412.0426\" y=\"521.6267\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"10.917\" x=\"416.4928\" y=\"521.6267\">&amp;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"427.4098\" y=\"521.6267\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"57.7432\" x=\"431.86\" y=\"521.6267\">Policies)</text></g><!--entity cloudtrail--><g class=\"entity\" data-qualified-name=\"aws.cloudtrail\" data-source-line=\"24\" id=\"ent0009\"><polygon fill=\"#FFFFFF\" points=\"542.3408,113.4847,552.3408,103.4847,689.7539,103.4847,689.7539,139.7816,679.7539,149.7816,542.3408,149.7816,542.3408,113.4847\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"679.7539\" x2=\"689.7539\" y1=\"113.4847\" y2=\"103.4847\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"542.3408\" x2=\"679.7539\" y1=\"113.4847\" y2=\"113.4847\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"679.7539\" x2=\"679.7539\" y1=\"113.4847\" y2=\"149.7816\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"32.3066\" x=\"557.3408\" y=\"136.4798\">AWS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"589.6475\" y=\"136.4798\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"70.6563\" x=\"594.0977\" y=\"136.4798\">CloudTrail</text></g><!--entity s3--><g class=\"entity\" data-qualified-name=\"aws.s3\" data-source-line=\"25\" id=\"ent0010\"><path d=\"M505.9908,276.5347 C505.9908,266.5347 598.0494,266.5347 598.0494,266.5347 C598.0494,266.5347 690.108,266.5347 690.108,276.5347 L690.108,318.1285 C690.108,328.1285 598.0494,328.1285 598.0494,328.1285 C598.0494,328.1285 505.9908,328.1285 505.9908,318.1285 L505.9908,276.5347\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M505.9908,276.5347 C505.9908,286.5347 598.0494,286.5347 598.0494,286.5347 C598.0494,286.5347 690.108,286.5347 690.108,276.5347\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.5811\" x=\"558.6368\" y=\"303.5298\">Amazon</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"615.2179\" y=\"303.5298\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"17.7939\" x=\"619.6681\" y=\"303.5298\">S3</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"76.1182\" x=\"515.9908\" y=\"319.8267\">(CloudTrail</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"592.109\" y=\"319.8267\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"25.252\" x=\"596.5592\" y=\"319.8267\">Log</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"621.8111\" y=\"319.8267\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"53.8467\" x=\"626.2613\" y=\"319.8267\">Bucket)</text></g><!--entity github--><g class=\"entity\" data-qualified-name=\"github\" data-source-line=\"11\" id=\"ent0002\"><ellipse cx=\"746.0482\" cy=\"473.9747\" fill=\"#FFFFFF\" rx=\"8\" ry=\"8\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M746.0482,481.9747 L746.0482,508.9747 M733.0482,489.9747 L759.0482,489.9747 M746.0482,508.9747 L733.0482,523.9747 M746.0482,508.9747 L759.0482,523.9747\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.5146\" x=\"721.7908\" y=\"539.2198\">GitHub</text></g><g class=\"entity\" data-qualified-name=\"GMN17\" data-source-line=\"45\" id=\"ent0018\"><path d=\"M725.2208,246.9347 L725.2208,347.7316 L944.8834,347.7316 L944.8834,256.9347 L934.8834,246.9347 L725.2208,246.9347\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M934.8834,246.9347 L934.8834,256.9347 L944.8834,256.9347 L934.8834,246.9347\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"92.5171\" x=\"784.2936\" y=\"264.0016\">Dependencies</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"124.103\" x=\"768.5006\" y=\"279.1344\">(requirements.txt):</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.6909\" x=\"776.3368\" y=\"294.2672\">-</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.1323\" x=\"781.0277\" y=\"294.2672\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"99.6074\" x=\"785.16\" y=\"294.2672\">boto3/botocore</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.6909\" x=\"764.2477\" y=\"309.4001\">-</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.1323\" x=\"768.9386\" y=\"309.4001\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"63.1782\" x=\"773.0709\" y=\"309.4001\">PyGithub,</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.1323\" x=\"836.2492\" y=\"309.4001\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"56.4751\" x=\"840.3815\" y=\"309.4001\">requests</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.6909\" x=\"731.2208\" y=\"324.5329\">-</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.1323\" x=\"735.9117\" y=\"324.5329\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"91.3682\" x=\"740.0441\" y=\"324.5329\">cryptography,</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.1323\" x=\"831.4122\" y=\"324.5329\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"44.2939\" x=\"835.5446\" y=\"324.5329\">PyJWT,</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.1323\" x=\"879.8385\" y=\"324.5329\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"45.9126\" x=\"883.9708\" y=\"324.5329\">PyNaCl</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"31.0591\" x=\"738.1747\" y=\"339.6657\">Uses</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.1323\" x=\"769.2338\" y=\"339.6657\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"30.3926\" x=\"773.3661\" y=\"339.6657\">/tmp</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.1323\" x=\"803.7587\" y=\"339.6657\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"17.875\" x=\"807.891\" y=\"339.6657\">for</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.1323\" x=\"825.766\" y=\"339.6657\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"29.5483\" x=\"829.8983\" y=\"339.6657\">repo</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"4.1323\" x=\"859.4467\" y=\"339.6657\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"13\" lengthAdjust=\"spacing\" textLength=\"59.3506\" x=\"863.579\" y=\"339.6657\">checkout</text></g><!--link ecr to lambda--><g class=\"link\" data-entity-1=\"ent0005\" data-entity-2=\"ent0006\" data-link-type=\"dependency\" data-source-line=\"29\" id=\"lnk11\"><path d=\"M376.8108,158.1847 C370.7708,183.6347 363.4643,214.4464 356.5543,243.6064\" fill=\"none\" id=\"ecr-to-lambda\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"355.1708,249.4447,361.1383,241.6096,356.3237,244.5795,353.3539,239.7649,355.1708,249.4447\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"21.5098\" x=\"369.0508\" y=\"200.0734\">Pull</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"390.5606\" y=\"200.0734\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"56.8594\" x=\"394.3751\" y=\"200.0734\">container</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"37.377\" x=\"391.4542\" y=\"214.0421\">image</text></g><!--link eventbridge to lambda--><g class=\"link\" data-entity-1=\"ent0004\" data-entity-2=\"ent0006\" data-link-type=\"dependency\" data-source-line=\"32\" id=\"lnk12\"><path d=\"M167.4508,158.3247 C187.8508,175.7947 214.1308,197.9247 238.0508,216.9347 C251.4608,227.5847 261.2483,235.1548 275.1883,245.6548\" fill=\"none\" id=\"eventbridge-to-lambda\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"279.9808,249.2647,275.1986,240.6548,275.987,246.2565,270.3854,247.0449,279.9808,249.2647\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"39.9199\" x=\"239.0508\" y=\"207.0734\">Invoke</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"278.9708\" y=\"207.0734\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"14.9473\" x=\"282.7852\" y=\"207.0734\">on</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"297.7325\" y=\"207.0734\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"53.7773\" x=\"301.5469\" y=\"207.0734\">schedule</text></g><!--link lambda to orgs--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0007\" data-link-type=\"dependency\" data-source-line=\"35\" id=\"lnk13\"><path d=\"M280.3708,345.3847 C270.6308,355.1047 261.6508,365.9947 255.0508,377.7247 C238.6208,406.9447 233.9127,439.5028 232.5327,466.0128\" fill=\"none\" id=\"lambda-to-orgs\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"232.2208,472.0047,236.6833,463.2248,232.4808,467.0115,228.6941,462.809,232.2208,472.0047\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"38.6836\" x=\"256.0508\" y=\"403.8634\">boto3:</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"294.7344\" y=\"403.8634\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"72.7852\" x=\"298.5489\" y=\"403.8634\">list/describe</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"29.4844\" x=\"298.9502\" y=\"417.8321\">SCPs</text></g><!--link lambda to iam--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0008\" data-link-type=\"dependency\" data-source-line=\"36\" id=\"lnk14\"><path d=\"M364.7008,345.2047 C381.8808,384.1947 403.4118,433.074 418.2018,466.644\" fill=\"none\" id=\"lambda-to-iam\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"420.6208,472.1347,420.6527,462.2859,418.6049,467.5591,413.3317,465.5113,420.6208,472.1347\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"38.6836\" x=\"412.2295\" y=\"403.8634\">boto3:</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"450.9131\" y=\"403.8634\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"17.625\" x=\"454.7276\" y=\"403.8634\">list</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"78.4805\" x=\"403.0508\" y=\"417.8321\">roles/policies</text></g><!--link cloudtrail to s3--><g class=\"link\" data-entity-1=\"ent0009\" data-entity-2=\"ent0010\" data-link-type=\"dependency\" data-source-line=\"39\" id=\"lnk15\"><path d=\"M613.6608,150.0347 C610.4808,179.8847 605.4677,226.8186 601.9077,260.1686\" fill=\"none\" id=\"cloudtrail-to-s3\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"601.2708,266.1347,606.2035,257.6101,601.8015,261.163,598.2487,256.761,601.2708,266.1347\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"42.709\" x=\"610.0508\" y=\"207.0734\">Deliver</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"652.7598\" y=\"207.0734\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"24.5449\" x=\"656.5743\" y=\"207.0734\">logs</text></g><!--link lambda to github--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0002\" data-link-type=\"dependency\" data-source-line=\"42\" id=\"lnk16\"><path d=\"M471.3208,344.8447 C543.2708,374.0147 633.1408,415.4247 706.0508,464.7247 C711.2808,468.2647 712.0079,468.4845 716.8379,472.8245\" fill=\"none\" id=\"lambda-to-github\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"721.3008,476.8347,717.2798,467.8441,717.5817,473.4929,711.9329,473.7947,721.3008,476.8347\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"38.5371\" x=\"675.045\" y=\"389.8634\">HTTPS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"713.5821\" y=\"389.8634\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"20.3379\" x=\"717.3965\" y=\"389.8634\">(git</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"70.0664\" x=\"671.3565\" y=\"403.8321\">clone/push)</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"110.6777\" x=\"651.0508\" y=\"417.8009\">PyGithub/requests</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"36.6094\" x=\"672.543\" y=\"431.7696\">Token</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"709.1524\" y=\"431.7696\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"27.2695\" x=\"712.9668\" y=\"431.7696\">auth</text></g><!--link lambda to GMN17--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0018\" data-link-type=\"association\" data-source-line=\"45\" id=\"lnk19\"><path d=\"M407.6508,249.3547 C436.0408,230.8347 470.8808,211.8647 505.5508,202.4347 C584.0308,181.0847 610.5508,179.3747 688.5508,202.4347 C719.0608,211.4547 749.1908,229.0347 774.1208,246.6447\" fill=\"none\" id=\"lambda-GMN17\" style=\"stroke:#000000;stroke-width:2;stroke-dasharray:7,7;\"/></g><?plantuml-src PLJ1RXen4BtxAoOSMf02cuGRXqg4H84gQH5GvO9K6U-mQ-6rj_QOX5JzzuuNGY6zh6NxlJSpppDxaUDQMuJXytmQAmCbKHq6MURbIw_GLCPL3EYLiuIMUifLcNm9Hgv2MhkQBq9txNotDj8I2sJRcwlULPRhGE92MsLYVXJFU1svgdAsL_DMYB3HjfPULX1AcRiNRGjOInFmv8P3rivoy3dj3897HT8MvXJoucNzh7CguURcwkIyagzF688iSAxV4AxvKf0cLXdhekmQtAA1EwoDsrKS08PUbPeuGFG8RKuM7cMroYMayYMxv45NhDOHGYfo7beFciPnrG8PO6-M4Cguc4ChiOTAkMYfkMQtuBSG0DQn8QrX9T-SXVijnxtrEYzmQTjpLM8U3UOmus-duM52h1h4_-pHZ5cZOtAJb1pCi7P1StgxWuBo9ynZKKixtL79AltUzJMqFvQuj6DfSuD-0AR1_rn7gqYdjzijxNrTOeLU6iYegfiuUzXvgE--a5Q_oSGBgSBHDEopShu8Pz39y8a1CsSmm2UOEgELnWDOo-fSTvHCNdYfJNFVU4vfowXSabp9yC-cUJ-vT6J0eolWDgeDqbuzzCKV8JxpcJPvbZVzm7rczbcNkXR9G-XslnngX05Cep4Vso9fBBmk2lJYzDtEcHExTHi4pYiSdZlncdQPJa19OzYN0peHar5CMpboVNuBdYjECIYlLmZ9pZCm6tME1PyCpUg3dIdKYHF65GNFd3Wni949VLQvGwEtN1k36jxzAw6t_EAQ_mM5Rzmv2xwV06QE5ulf7DgyJy8Mipg6ifCQxg61P1v_HGp47R5WBop8IAKGrX7FDqycWLk_jnEF9zeSRSeUseceFQPf3JrwfSv0TFVbPkchd4S-U8zp2U-1-53vNKsEywxBtIL3lZulql9DZepu4LWyDJBmhun9jGD-6xLnaGH7XvJPNm00?></g></svg>",
  "architecture_description": "## High-level architecture\n\nThis codebase deploys a **Python 3.11 AWS Lambda function using the container image runtime**. The function is **invoked on a schedule** (likely via **Amazon EventBridge**) and performs automation that:\n\n- Calls **AWS Organizations** APIs to list/describe **Service Control Policies (SCPs)**.\n- Calls **AWS IAM** APIs to list **roles and policies**.\n- Interacts with a **GitHub repository** over HTTPS (clone/push) using a **GitHub token**.\n- Uses Lambda **ephemeral storage (/tmp)** to clone and manipulate the repository during execution.\n\nSupporting/related resources referenced by the repo:\n\n- **Amazon ECR** hosts the Lambda container image (build/push described in README).\n- **AWS CloudTrail** is expected to be enabled and configured to deliver logs to an **Amazon S3 bucket** (names referenced via TF variables). This is shown as an account-level logging pipeline; the Lambda itself is not necessarily reading these logs based on the provided analysis.\n\n## Component relationships\n\n- **EventBridge → Lambda**: scheduled invocation.\n- **ECR → Lambda**: Lambda pulls the container image at deploy/runtime.\n- **Lambda → AWS Organizations / IAM**: boto3 API calls to enumerate org/IAM configuration.\n- **Lambda → GitHub**: outbound HTTPS for git operations and GitHub API usage (PyGithub/requests) authenticated via token.\n- **CloudTrail → S3**: CloudTrail delivers audit logs to the configured S3 bucket."
}