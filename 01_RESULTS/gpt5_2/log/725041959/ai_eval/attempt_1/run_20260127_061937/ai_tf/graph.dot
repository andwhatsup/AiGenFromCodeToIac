digraph G {
  rankdir = "RL";
  node [shape = rect, fontname = "sans-serif"];
  "data.aws_availability_zones.available" [label="data.aws_availability_zones.available"];
  "data.aws_caller_identity.current" [label="data.aws_caller_identity.current"];
  "data.aws_partition.current" [label="data.aws_partition.current"];
  "data.tls_certificate.oidc" [label="data.tls_certificate.oidc"];
  "aws_db_instance.this" [label="aws_db_instance.this"];
  "aws_db_parameter_group.this" [label="aws_db_parameter_group.this"];
  "aws_db_subnet_group.this" [label="aws_db_subnet_group.this"];
  "aws_ecr_lifecycle_policy.backup" [label="aws_ecr_lifecycle_policy.backup"];
  "aws_ecr_repository.backup" [label="aws_ecr_repository.backup"];
  "aws_efs_access_point.nextcloud" [label="aws_efs_access_point.nextcloud"];
  "aws_efs_file_system.this" [label="aws_efs_file_system.this"];
  "aws_efs_mount_target.this" [label="aws_efs_mount_target.this"];
  "aws_eip.nat" [label="aws_eip.nat"];
  "aws_eks_addon.coredns" [label="aws_eks_addon.coredns"];
  "aws_eks_addon.kube_proxy" [label="aws_eks_addon.kube_proxy"];
  "aws_eks_addon.vpc_cni" [label="aws_eks_addon.vpc_cni"];
  "aws_eks_cluster.this" [label="aws_eks_cluster.this"];
  "aws_eks_node_group.default" [label="aws_eks_node_group.default"];
  "aws_iam_instance_profile.eks_node" [label="aws_iam_instance_profile.eks_node"];
  "aws_iam_openid_connect_provider.eks" [label="aws_iam_openid_connect_provider.eks"];
  "aws_iam_policy.backup" [label="aws_iam_policy.backup"];
  "aws_iam_role.backup_sa" [label="aws_iam_role.backup_sa"];
  "aws_iam_role.eks_cluster" [label="aws_iam_role.eks_cluster"];
  "aws_iam_role.eks_node" [label="aws_iam_role.eks_node"];
  "aws_iam_role_policy_attachment.backup" [label="aws_iam_role_policy_attachment.backup"];
  "aws_iam_role_policy_attachment.eks_cluster_AmazonEKSClusterPolicy" [label="aws_iam_role_policy_attachment.eks_cluster_AmazonEKSClusterPolicy"];
  "aws_iam_role_policy_attachment.eks_node_AmazonEC2ContainerRegistryReadOnly" [label="aws_iam_role_policy_attachment.eks_node_AmazonEC2ContainerRegistryReadOnly"];
  "aws_iam_role_policy_attachment.eks_node_AmazonEKSWorkerNodePolicy" [label="aws_iam_role_policy_attachment.eks_node_AmazonEKSWorkerNodePolicy"];
  "aws_iam_role_policy_attachment.eks_node_AmazonEKS_CNI_Policy" [label="aws_iam_role_policy_attachment.eks_node_AmazonEKS_CNI_Policy"];
  "aws_internet_gateway.this" [label="aws_internet_gateway.this"];
  "aws_kms_alias.main" [label="aws_kms_alias.main"];
  "aws_kms_key.main" [label="aws_kms_key.main"];
  "aws_nat_gateway.this" [label="aws_nat_gateway.this"];
  "aws_route.private_nat" [label="aws_route.private_nat"];
  "aws_route.public_internet" [label="aws_route.public_internet"];
  "aws_route_table.private" [label="aws_route_table.private"];
  "aws_route_table.public" [label="aws_route_table.public"];
  "aws_route_table_association.private" [label="aws_route_table_association.private"];
  "aws_route_table_association.public" [label="aws_route_table_association.public"];
  "aws_s3_bucket.backups" [label="aws_s3_bucket.backups"];
  "aws_s3_bucket_lifecycle_configuration.backups" [label="aws_s3_bucket_lifecycle_configuration.backups"];
  "aws_s3_bucket_policy.backups" [label="aws_s3_bucket_policy.backups"];
  "aws_s3_bucket_public_access_block.backups" [label="aws_s3_bucket_public_access_block.backups"];
  "aws_s3_bucket_server_side_encryption_configuration.backups" [label="aws_s3_bucket_server_side_encryption_configuration.backups"];
  "aws_s3_bucket_versioning.backups" [label="aws_s3_bucket_versioning.backups"];
  "aws_secretsmanager_secret.db" [label="aws_secretsmanager_secret.db"];
  "aws_secretsmanager_secret_version.db" [label="aws_secretsmanager_secret_version.db"];
  "aws_security_group.efs" [label="aws_security_group.efs"];
  "aws_security_group.eks_nodes" [label="aws_security_group.eks_nodes"];
  "aws_security_group.rds" [label="aws_security_group.rds"];
  "aws_security_group.vpce" [label="aws_security_group.vpce"];
  "aws_security_group_rule.efs_egress" [label="aws_security_group_rule.efs_egress"];
  "aws_security_group_rule.efs_from_eks" [label="aws_security_group_rule.efs_from_eks"];
  "aws_security_group_rule.rds_egress" [label="aws_security_group_rule.rds_egress"];
  "aws_security_group_rule.rds_from_eks" [label="aws_security_group_rule.rds_from_eks"];
  "aws_subnet.private" [label="aws_subnet.private"];
  "aws_subnet.public" [label="aws_subnet.public"];
  "aws_vpc.this" [label="aws_vpc.this"];
  "aws_vpc_endpoint.ecr_api" [label="aws_vpc_endpoint.ecr_api"];
  "aws_vpc_endpoint.ecr_dkr" [label="aws_vpc_endpoint.ecr_dkr"];
  "aws_vpc_endpoint.logs" [label="aws_vpc_endpoint.logs"];
  "aws_vpc_endpoint.s3" [label="aws_vpc_endpoint.s3"];
  "aws_vpc_endpoint.secretsmanager" [label="aws_vpc_endpoint.secretsmanager"];
  "aws_vpc_endpoint.sts" [label="aws_vpc_endpoint.sts"];
  "random_password.db" [label="random_password.db"];
  "data.tls_certificate.oidc" -> "aws_eks_cluster.this";
  "aws_db_instance.this" -> "aws_db_parameter_group.this";
  "aws_db_instance.this" -> "aws_db_subnet_group.this";
  "aws_db_instance.this" -> "aws_kms_key.main";
  "aws_db_instance.this" -> "aws_security_group.rds";
  "aws_db_instance.this" -> "random_password.db";
  "aws_db_subnet_group.this" -> "aws_subnet.private";
  "aws_ecr_lifecycle_policy.backup" -> "aws_ecr_repository.backup";
  "aws_ecr_repository.backup" -> "aws_kms_key.main";
  "aws_efs_access_point.nextcloud" -> "aws_efs_file_system.this";
  "aws_efs_file_system.this" -> "aws_kms_key.main";
  "aws_efs_mount_target.this" -> "aws_efs_file_system.this";
  "aws_efs_mount_target.this" -> "aws_security_group.efs";
  "aws_efs_mount_target.this" -> "aws_subnet.private";
  "aws_eks_addon.coredns" -> "aws_eks_node_group.default";
  "aws_eks_addon.kube_proxy" -> "aws_eks_node_group.default";
  "aws_eks_addon.vpc_cni" -> "aws_eks_node_group.default";
  "aws_eks_cluster.this" -> "aws_iam_role_policy_attachment.eks_cluster_AmazonEKSClusterPolicy";
  "aws_eks_cluster.this" -> "aws_security_group.eks_nodes";
  "aws_eks_cluster.this" -> "aws_subnet.private";
  "aws_eks_cluster.this" -> "aws_subnet.public";
  "aws_eks_node_group.default" -> "aws_eks_cluster.this";
  "aws_eks_node_group.default" -> "aws_iam_role_policy_attachment.eks_node_AmazonEC2ContainerRegistryReadOnly";
  "aws_eks_node_group.default" -> "aws_iam_role_policy_attachment.eks_node_AmazonEKSWorkerNodePolicy";
  "aws_eks_node_group.default" -> "aws_iam_role_policy_attachment.eks_node_AmazonEKS_CNI_Policy";
  "aws_iam_instance_profile.eks_node" -> "aws_iam_role.eks_node";
  "aws_iam_openid_connect_provider.eks" -> "data.tls_certificate.oidc";
  "aws_iam_policy.backup" -> "aws_s3_bucket.backups";
  "aws_iam_policy.backup" -> "aws_secretsmanager_secret.db";
  "aws_iam_role.backup_sa" -> "aws_iam_openid_connect_provider.eks";
  "aws_iam_role_policy_attachment.backup" -> "aws_iam_policy.backup";
  "aws_iam_role_policy_attachment.backup" -> "aws_iam_role.backup_sa";
  "aws_iam_role_policy_attachment.eks_cluster_AmazonEKSClusterPolicy" -> "data.aws_partition.current";
  "aws_iam_role_policy_attachment.eks_cluster_AmazonEKSClusterPolicy" -> "aws_iam_role.eks_cluster";
  "aws_iam_role_policy_attachment.eks_node_AmazonEC2ContainerRegistryReadOnly" -> "data.aws_partition.current";
  "aws_iam_role_policy_attachment.eks_node_AmazonEC2ContainerRegistryReadOnly" -> "aws_iam_role.eks_node";
  "aws_iam_role_policy_attachment.eks_node_AmazonEKSWorkerNodePolicy" -> "data.aws_partition.current";
  "aws_iam_role_policy_attachment.eks_node_AmazonEKSWorkerNodePolicy" -> "aws_iam_role.eks_node";
  "aws_iam_role_policy_attachment.eks_node_AmazonEKS_CNI_Policy" -> "data.aws_partition.current";
  "aws_iam_role_policy_attachment.eks_node_AmazonEKS_CNI_Policy" -> "aws_iam_role.eks_node";
  "aws_internet_gateway.this" -> "aws_vpc.this";
  "aws_kms_alias.main" -> "aws_kms_key.main";
  "aws_kms_key.main" -> "data.aws_caller_identity.current";
  "aws_kms_key.main" -> "data.aws_partition.current";
  "aws_nat_gateway.this" -> "aws_eip.nat";
  "aws_nat_gateway.this" -> "aws_internet_gateway.this";
  "aws_nat_gateway.this" -> "aws_subnet.public";
  "aws_route.private_nat" -> "aws_nat_gateway.this";
  "aws_route.private_nat" -> "aws_route_table.private";
  "aws_route.public_internet" -> "aws_internet_gateway.this";
  "aws_route.public_internet" -> "aws_route_table.public";
  "aws_route_table.private" -> "aws_vpc.this";
  "aws_route_table.public" -> "aws_vpc.this";
  "aws_route_table_association.private" -> "aws_route_table.private";
  "aws_route_table_association.private" -> "aws_subnet.private";
  "aws_route_table_association.public" -> "aws_route_table.public";
  "aws_route_table_association.public" -> "aws_subnet.public";
  "aws_s3_bucket_lifecycle_configuration.backups" -> "aws_s3_bucket.backups";
  "aws_s3_bucket_policy.backups" -> "aws_s3_bucket.backups";
  "aws_s3_bucket_public_access_block.backups" -> "aws_s3_bucket.backups";
  "aws_s3_bucket_server_side_encryption_configuration.backups" -> "aws_kms_key.main";
  "aws_s3_bucket_server_side_encryption_configuration.backups" -> "aws_s3_bucket.backups";
  "aws_s3_bucket_versioning.backups" -> "aws_s3_bucket.backups";
  "aws_secretsmanager_secret.db" -> "aws_kms_key.main";
  "aws_secretsmanager_secret_version.db" -> "aws_db_instance.this";
  "aws_secretsmanager_secret_version.db" -> "aws_secretsmanager_secret.db";
  "aws_security_group.efs" -> "aws_vpc.this";
  "aws_security_group.eks_nodes" -> "aws_vpc.this";
  "aws_security_group.rds" -> "aws_vpc.this";
  "aws_security_group.vpce" -> "aws_vpc.this";
  "aws_security_group_rule.efs_egress" -> "aws_security_group.efs";
  "aws_security_group_rule.efs_from_eks" -> "aws_security_group.efs";
  "aws_security_group_rule.efs_from_eks" -> "aws_security_group.eks_nodes";
  "aws_security_group_rule.rds_egress" -> "aws_security_group.rds";
  "aws_security_group_rule.rds_from_eks" -> "aws_security_group.eks_nodes";
  "aws_security_group_rule.rds_from_eks" -> "aws_security_group.rds";
  "aws_subnet.private" -> "data.aws_availability_zones.available";
  "aws_subnet.private" -> "aws_vpc.this";
  "aws_subnet.public" -> "data.aws_availability_zones.available";
  "aws_subnet.public" -> "aws_vpc.this";
  "aws_vpc_endpoint.ecr_api" -> "aws_security_group.vpce";
  "aws_vpc_endpoint.ecr_api" -> "aws_subnet.private";
  "aws_vpc_endpoint.ecr_dkr" -> "aws_security_group.vpce";
  "aws_vpc_endpoint.ecr_dkr" -> "aws_subnet.private";
  "aws_vpc_endpoint.logs" -> "aws_security_group.vpce";
  "aws_vpc_endpoint.logs" -> "aws_subnet.private";
  "aws_vpc_endpoint.s3" -> "aws_route_table.private";
  "aws_vpc_endpoint.secretsmanager" -> "aws_security_group.vpce";
  "aws_vpc_endpoint.secretsmanager" -> "aws_subnet.private";
  "aws_vpc_endpoint.sts" -> "aws_security_group.vpce";
  "aws_vpc_endpoint.sts" -> "aws_subnet.private";
}
