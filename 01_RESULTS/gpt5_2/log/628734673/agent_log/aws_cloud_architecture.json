{
  "aws_architecture_description": "## Proposed high-level AWS architecture (Flask container on Kubernetes + CI/CD)\n\n### 1) Container build & registry\n- **Source control**: Developer pushes code to a Git repo (e.g., GitHub/CodeCommit). A pipeline triggers on commit.\n- **Build**: Use **AWS CodeBuild** to build the Docker image from the repo’s `Dockerfile`.\n- **Registry**: Push the image to **Amazon ECR** (replaces Docker Hub; keeps images private, integrates with IAM).\n\n### 2) Kubernetes runtime (serving path)\n- **Amazon EKS** hosts the Kubernetes control plane.\n- **Managed Node Group (EC2)** provides worker nodes in private subnets.\n- Deploy the existing Kubernetes manifests (Deployment/Service) with small adjustments:\n  - Container listens on **TCP/8080** as today.\n  - Use an **EKS ServiceAccount with IAM Role (IRSA)** if the app later needs AWS API access.\n- **Ingress / exposure**:\n  - Prefer **ALB Ingress Controller (AWS Load Balancer Controller)** so Kubernetes Ingress creates an **Application Load Balancer**.\n  - ALB listens on **443** (TLS) and forwards to the Kubernetes Service/Pods on **8080**.\n  - Optionally place **AWS WAF** on the ALB.\n\n### 3) Networking & security\n- **VPC across 2–3 AZs**.\n- **Public subnets**: ALB, NAT Gateways.\n- **Private subnets**: EKS worker nodes and pods.\n- **VPC endpoints** (Interface/Gateway) to reduce NAT usage and keep traffic private where possible (notably ECR, S3, CloudWatch Logs).\n- **Security groups**:\n  - ALB SG: allow inbound 443 from the internet; outbound to node SG on target ports.\n  - Node SG: allow inbound from ALB SG to NodePort/target group ports; allow egress to required AWS services.\n\n### 4) CI/CD deployment to EKS\n- Replace Jenkins with AWS-native CI/CD (leaner ops):\n  - **CodePipeline** orchestrates: Source → Build (CodeBuild) → Deploy.\n  - Deploy stage uses **kubectl/helm** from CodeBuild (or CodePipeline deploy action) to apply the Kubernetes manifests to EKS.\n- If you must keep Jenkins:\n  - Run **Jenkins on EC2** (or on EKS) in private subnets, fronted by an internal ALB, and use IAM roles to push to ECR and deploy to EKS.\n\n### 5) Observability & operations\n- **CloudWatch Container Insights** (or CloudWatch + Fluent Bit) for cluster/app logs and metrics.\n- **AWS X-Ray** (optional) for tracing Flask requests.\n- **AWS Secrets Manager** (or SSM Parameter Store) for secrets; sync into Kubernetes via External Secrets Operator (optional).\n- **Route 53** for DNS to the ALB; **ACM** for TLS certificates.\n\n### 6) Scalability & resilience\n- **Horizontal Pod Autoscaler (HPA)** scales pods based on CPU/memory (and later custom metrics).\n- **Cluster Autoscaler / Karpenter** scales worker nodes.\n- Multi-AZ node groups and ALB across AZs for high availability.\n\nNotes/assumptions:\n- The current app appears stateless (no DB mentioned). If state is added later, prefer managed services (RDS/DynamoDB) and keep pods stateless.\n",
  "aws_resources": [
    "Amazon VPC",
    "Public subnets (2–3 AZs)",
    "Private subnets (2–3 AZs)",
    "Internet Gateway (IGW)",
    "NAT Gateway(s) (per AZ or shared, depending on cost/HA needs)",
    "Route tables (public/private)",
    "Security Groups (ALB SG, EKS node SG, optional Jenkins SG)",
    "Network ACLs (optional, if you enforce beyond SGs)",
    "VPC Endpoints: ECR (api + dkr) interface endpoints",
    "VPC Endpoint: CloudWatch Logs interface endpoint",
    "VPC Endpoint: STS interface endpoint (optional)",
    "VPC Endpoint: S3 gateway endpoint (recommended)",
    "Amazon EKS Cluster",
    "EKS Managed Node Group(s) (EC2)",
    "EKS IAM roles: EKS Cluster Role, Node Instance Role",
    "EKS add-ons: VPC CNI, CoreDNS, kube-proxy (managed add-ons)",
    "AWS Load Balancer Controller (installed in EKS)",
    "Kubernetes Ingress resource (to provision ALB)",
    "Application Load Balancer (created by controller)",
    "Target Group(s) (created by controller)",
    "AWS Certificate Manager (ACM) certificate (for HTTPS)",
    "Amazon Route 53 hosted zone + DNS record(s)",
    "Amazon ECR repository",
    "AWS CodeBuild project (docker build + push + kubectl apply)",
    "AWS CodePipeline pipeline (source/build/deploy)",
    "IAM roles for CodePipeline/CodeBuild (ECR push, EKS deploy permissions)",
    "Amazon CloudWatch Log Groups (EKS/control plane, app logs)",
    "CloudWatch Container Insights (or CloudWatch agent/Fluent Bit)",
    "AWS Secrets Manager (for app secrets)",
    "AWS Systems Manager Parameter Store (optional alternative to Secrets Manager)",
    "AWS KMS key(s) (for ECR/Secrets/Logs encryption, if using CMKs)",
    "AWS WAF Web ACL (optional, attached to ALB)",
    "Amazon S3 bucket (optional: pipeline artifacts, logs, backups)",
    "(If keeping Jenkins) Amazon EC2 instance(s) for Jenkins",
    "(If keeping Jenkins) EBS volume(s) for Jenkins home",
    "(If keeping Jenkins) Internal ALB for Jenkins UI (optional)"
  ]
}