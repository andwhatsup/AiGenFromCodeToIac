{"format_version":"1.2","terraform_version":"1.13.5","variables":{"allowed_cidr":{"value":null},"associate_public_ip":{"value":true},"aws_region":{"value":"ap-northeast-1"},"enable_https":{"value":false},"instance_type":{"value":"t3.micro"},"key_pair_name":{"value":null},"name":{"value":"ec2-test-server"},"private_key_path":{"value":".security/my-net-keypair.id_rsa"},"public_key_path":{"value":null},"public_subnet_id":{"value":"subnet-00000000"},"root_volume_size_gb":{"value":10},"root_volume_type":{"value":"gp3"},"ssh_username":{"value":"ec2-user"},"tags":{"value":{"Managed":"terraform","Project":"ec2_test_server"}},"vpc_id":{"value":"vpc-00000000"}},"planned_values":{"outputs":{"allowed_cidr":{"sensitive":false,"type":"string","value":"193.5.234.233/32"},"ami_id":{"sensitive":false,"type":"string","value":"ami-04681a1dbd79675a5"},"ec2_public_dns":{"sensitive":false},"ec2_public_ip":{"sensitive":false},"web_url":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_instance.web","mode":"managed","type":"aws_instance","name":"web","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"ami":"ami-04681a1dbd79675a5","associate_public_ip_address":true,"credit_specification":[],"force_destroy":false,"get_password_data":false,"hibernation":null,"instance_type":"t3.micro","launch_template":[],"metadata_options":[{"http_endpoint":"enabled","http_protocol_ipv6":"disabled","http_tokens":"required"}],"region":"ap-northeast-1","root_block_device":[{"delete_on_termination":true,"encrypted":true,"tags":null,"volume_size":10,"volume_type":"gp3"}],"source_dest_check":true,"subnet_id":"subnet-00000000","tags":{"Name":"ec2-test-server"},"tags_all":{"Managed":"terraform","Name":"ec2-test-server","Project":"ec2_test_server"},"timeouts":null,"user_data":null,"user_data_replace_on_change":false,"volume_tags":null},"sensitive_values":{"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"ebs_block_device":[],"enclave_options":[],"ephemeral_block_device":[],"instance_market_options":[],"ipv6_addresses":[],"launch_template":[],"maintenance_options":[],"metadata_options":[{}],"network_interface":[],"primary_network_interface":[],"private_dns_name_options":[],"root_block_device":[{"tags_all":{}}],"secondary_private_ips":[],"security_groups":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_security_group.web","mode":"managed","type":"aws_security_group","name":"web","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Allow SSH and web access from allowlisted CIDR","name_prefix":"ec2-test-server-","region":"ap-northeast-1","revoke_rules_on_delete":false,"tags":null,"tags_all":{"Managed":"terraform","Project":"ec2_test_server"},"timeouts":null,"vpc_id":"vpc-00000000"},"sensitive_values":{"egress":[],"ingress":[],"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"id":null,"region":null}},{"address":"aws_vpc_security_group_egress_rule.all","mode":"managed","type":"aws_vpc_security_group_egress_rule","name":"all","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"cidr_ipv4":"0.0.0.0/0","cidr_ipv6":null,"description":"All outbound","from_port":null,"ip_protocol":"-1","prefix_list_id":null,"referenced_security_group_id":null,"region":"ap-northeast-1","tags":null,"tags_all":{"Managed":"terraform","Project":"ec2_test_server"},"to_port":null},"sensitive_values":{"tags_all":{}}},{"address":"aws_vpc_security_group_ingress_rule.http","mode":"managed","type":"aws_vpc_security_group_ingress_rule","name":"http","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"cidr_ipv4":"193.5.234.233/32","cidr_ipv6":null,"description":"HTTP from allowlisted CIDR","from_port":80,"ip_protocol":"tcp","prefix_list_id":null,"referenced_security_group_id":null,"region":"ap-northeast-1","tags":null,"tags_all":{"Managed":"terraform","Project":"ec2_test_server"},"to_port":80},"sensitive_values":{"tags_all":{}}},{"address":"aws_vpc_security_group_ingress_rule.ssh","mode":"managed","type":"aws_vpc_security_group_ingress_rule","name":"ssh","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"cidr_ipv4":"193.5.234.233/32","cidr_ipv6":null,"description":"SSH from allowlisted CIDR","from_port":22,"ip_protocol":"tcp","prefix_list_id":null,"referenced_security_group_id":null,"region":"ap-northeast-1","tags":null,"tags_all":{"Managed":"terraform","Project":"ec2_test_server"},"to_port":22},"sensitive_values":{"tags_all":{}}}]}},"resource_changes":[{"address":"aws_instance.web","mode":"managed","type":"aws_instance","name":"web","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"ami":"ami-04681a1dbd79675a5","associate_public_ip_address":true,"credit_specification":[],"force_destroy":false,"get_password_data":false,"hibernation":null,"instance_type":"t3.micro","launch_template":[],"metadata_options":[{"http_endpoint":"enabled","http_protocol_ipv6":"disabled","http_tokens":"required"}],"region":"ap-northeast-1","root_block_device":[{"delete_on_termination":true,"encrypted":true,"tags":null,"volume_size":10,"volume_type":"gp3"}],"source_dest_check":true,"subnet_id":"subnet-00000000","tags":{"Name":"ec2-test-server"},"tags_all":{"Managed":"terraform","Name":"ec2-test-server","Project":"ec2_test_server"},"timeouts":null,"user_data":null,"user_data_replace_on_change":false,"volume_tags":null},"after_unknown":{"arn":true,"availability_zone":true,"capacity_reservation_specification":true,"cpu_options":true,"credit_specification":[],"disable_api_stop":true,"disable_api_termination":true,"ebs_block_device":true,"ebs_optimized":true,"enable_primary_ipv6":true,"enclave_options":true,"ephemeral_block_device":true,"host_id":true,"host_resource_group_arn":true,"iam_instance_profile":true,"id":true,"instance_initiated_shutdown_behavior":true,"instance_lifecycle":true,"instance_market_options":true,"instance_state":true,"ipv6_address_count":true,"ipv6_addresses":true,"key_name":true,"launch_template":[],"maintenance_options":true,"metadata_options":[{"http_put_response_hop_limit":true,"instance_metadata_tags":true}],"monitoring":true,"network_interface":true,"outpost_arn":true,"password_data":true,"placement_group":true,"placement_group_id":true,"placement_partition_number":true,"primary_network_interface":true,"primary_network_interface_id":true,"private_dns":true,"private_dns_name_options":true,"private_ip":true,"public_dns":true,"public_ip":true,"root_block_device":[{"device_name":true,"iops":true,"kms_key_id":true,"tags_all":true,"throughput":true,"volume_id":true}],"secondary_private_ips":true,"security_groups":true,"spot_instance_request_id":true,"tags":{},"tags_all":{},"tenancy":true,"user_data_base64":true,"vpc_security_group_ids":true},"before_sensitive":false,"after_sensitive":{"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"ebs_block_device":[],"enclave_options":[],"ephemeral_block_device":[],"instance_market_options":[],"ipv6_addresses":[],"launch_template":[],"maintenance_options":[],"metadata_options":[{}],"network_interface":[],"primary_network_interface":[],"private_dns_name_options":[],"root_block_device":[{"tags_all":{}}],"secondary_private_ips":[],"security_groups":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_security_group.web","mode":"managed","type":"aws_security_group","name":"web","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Allow SSH and web access from allowlisted CIDR","name_prefix":"ec2-test-server-","region":"ap-northeast-1","revoke_rules_on_delete":false,"tags":null,"tags_all":{"Managed":"terraform","Project":"ec2_test_server"},"timeouts":null,"vpc_id":"vpc-00000000"},"after_unknown":{"arn":true,"egress":true,"id":true,"ingress":true,"name":true,"owner_id":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"egress":[],"ingress":[],"tags_all":{}},"after_identity":{"account_id":null,"id":null,"region":null}}},{"address":"aws_vpc_security_group_egress_rule.all","mode":"managed","type":"aws_vpc_security_group_egress_rule","name":"all","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_ipv4":"0.0.0.0/0","cidr_ipv6":null,"description":"All outbound","from_port":null,"ip_protocol":"-1","prefix_list_id":null,"referenced_security_group_id":null,"region":"ap-northeast-1","tags":null,"tags_all":{"Managed":"terraform","Project":"ec2_test_server"},"to_port":null},"after_unknown":{"arn":true,"id":true,"security_group_id":true,"security_group_rule_id":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_vpc_security_group_ingress_rule.http","mode":"managed","type":"aws_vpc_security_group_ingress_rule","name":"http","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_ipv4":"193.5.234.233/32","cidr_ipv6":null,"description":"HTTP from allowlisted CIDR","from_port":80,"ip_protocol":"tcp","prefix_list_id":null,"referenced_security_group_id":null,"region":"ap-northeast-1","tags":null,"tags_all":{"Managed":"terraform","Project":"ec2_test_server"},"to_port":80},"after_unknown":{"arn":true,"id":true,"security_group_id":true,"security_group_rule_id":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_vpc_security_group_ingress_rule.ssh","mode":"managed","type":"aws_vpc_security_group_ingress_rule","name":"ssh","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_ipv4":"193.5.234.233/32","cidr_ipv6":null,"description":"SSH from allowlisted CIDR","from_port":22,"ip_protocol":"tcp","prefix_list_id":null,"referenced_security_group_id":null,"region":"ap-northeast-1","tags":null,"tags_all":{"Managed":"terraform","Project":"ec2_test_server"},"to_port":22},"after_unknown":{"arn":true,"id":true,"security_group_id":true,"security_group_rule_id":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}}],"output_changes":{"allowed_cidr":{"actions":["create"],"before":null,"after":"193.5.234.233/32","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"ami_id":{"actions":["create"],"before":null,"after":"ami-04681a1dbd79675a5","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"ec2_public_dns":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"ec2_public_ip":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"web_url":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.13.5","values":{"outputs":{"allowed_cidr":{"sensitive":false,"value":"193.5.234.233/32","type":"string"},"ami_id":{"sensitive":false,"value":"ami-04681a1dbd79675a5","type":"string"}},"root_module":{"resources":[{"address":"data.aws_ami.amazon_linux2","mode":"data","type":"aws_ami","name":"amazon_linux2","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"allow_unsafe_filter":null,"architecture":"x86_64","arn":"arn:aws:ec2:ap-northeast-1::image/ami-04681a1dbd79675a5","block_device_mappings":[{"device_name":"/dev/xvda","ebs":{"delete_on_termination":"false","encrypted":"false","iops":"0","snapshot_id":"snap-5e4d796b5980570a1","throughput":"0","volume_initialization_rate":"0","volume_size":"15","volume_type":"standard"},"no_device":"","virtual_name":""}],"boot_mode":"uefi","creation_date":"2026-01-27T00:29:41.000Z","deprecation_time":"","description":"Amazon Linux 2 AMI 2.0.20180810 x86_64 HVM gp2","ena_support":false,"executable_users":null,"filter":[{"name":"name","values":["amzn2-ami-hvm-*-x86_64-gp2"]},{"name":"virtualization-type","values":["hvm"]}],"hypervisor":"xen","id":"ami-04681a1dbd79675a5","image_id":"ami-04681a1dbd79675a5","image_location":"amazon/amzn2-ami-hvm-2.0.20180810-x86_64-gp2","image_owner_alias":"amazon","image_type":"machine","imds_support":"","include_deprecated":false,"kernel_id":"","last_launched_time":"","most_recent":true,"name":"amzn2-ami-hvm-2.0.20180810-x86_64-gp2","name_regex":null,"owner_id":"137112412989","owners":["amazon"],"platform":"Linux/UNIX","platform_details":"","product_codes":[],"public":true,"ramdisk_id":"","region":"ap-northeast-1","root_device_name":"/dev/xvda","root_device_type":"ebs","root_snapshot_id":"snap-5e4d796b5980570a1","sriov_net_support":"","state":"available","state_reason":{"code":"UNSET","message":"UNSET"},"tags":{},"timeouts":null,"tpm_support":"","uefi_data":null,"usage_operation":"","virtualization_type":"hvm"},"sensitive_values":{"block_device_mappings":[{"ebs":{}}],"filter":[{"values":[false]},{"values":[false]}],"owners":[false],"product_codes":[],"state_reason":{},"tags":{}}},{"address":"data.http.myip","mode":"data","type":"http","name":"myip","provider_name":"registry.terraform.io/hashicorp/http","schema_version":0,"values":{"body":"193.5.234.233\n","ca_cert_pem":null,"client_cert_pem":null,"client_key_pem":null,"id":"https://checkip.amazonaws.com/","insecure":null,"method":null,"request_body":null,"request_headers":null,"request_timeout_ms":null,"response_body":"193.5.234.233\n","response_body_base64":"MTkzLjUuMjM0LjIzMwo=","response_headers":{"Content-Length":"14","Content-Type":"text/plain;charset=UTF-8","Date":"Tue, 27 Jan 2026 00:29:38 GMT","Server":"nginx","Vary":"Origin, Access-Control-Request-Method, Access-Control-Request-Headers"},"retry":null,"status_code":200,"url":"https://checkip.amazonaws.com/"},"sensitive_values":{"response_headers":{}}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"~\u003e 6.27.0","expressions":{"default_tags":[{"tags":{"references":["var.tags"]}}],"region":{"references":["var.aws_region"]}}},"http":{"name":"http","full_name":"registry.terraform.io/hashicorp/http","version_constraint":"~\u003e 3.5"}},"root_module":{"outputs":{"allowed_cidr":{"expression":{"references":["local.allow_cidr"]},"description":"CIDR allowed to access the instance (auto-detected if not provided)."},"ami_id":{"expression":{"references":["data.aws_ami.amazon_linux2.id","data.aws_ami.amazon_linux2"]},"description":"AMI ID used for the instance."},"ec2_public_dns":{"expression":{"references":["aws_instance.web.public_dns","aws_instance.web"]},"description":"Public DNS name of the EC2 instance."},"ec2_public_ip":{"expression":{"references":["aws_instance.web.public_ip","aws_instance.web"]},"description":"Public IP of the EC2 instance."},"web_url":{"expression":{"references":["aws_instance.web.public_dns","aws_instance.web"]},"description":"HTTP URL for the web server."}},"resources":[{"address":"aws_instance.web","mode":"managed","type":"aws_instance","name":"web","provider_config_key":"aws","provisioners":[{"type":"file","expressions":{"destination":{"constant_value":"/tmp/nginx-php-inst.sh"},"source":{"references":["path.module"]}}},{"type":"remote-exec","expressions":{"inline":{"constant_value":["chmod +x /tmp/nginx-php-inst.sh","sudo /tmp/nginx-php-inst.sh"]}}}],"expressions":{"ami":{"references":["data.aws_ami.amazon_linux2.id","data.aws_ami.amazon_linux2"]},"associate_public_ip_address":{"references":["var.associate_public_ip"]},"instance_type":{"references":["var.instance_type"]},"key_name":{"references":["local.key_name_effective"]},"metadata_options":[{"http_endpoint":{"constant_value":"enabled"},"http_tokens":{"constant_value":"required"}}],"root_block_device":[{"encrypted":{"constant_value":true},"volume_size":{"references":["var.root_volume_size_gb"]},"volume_type":{"references":["var.root_volume_type"]}}],"subnet_id":{"references":["var.public_subnet_id"]},"tags":{"references":["var.name"]},"vpc_security_group_ids":{"references":["aws_security_group.web.id","aws_security_group.web"]}},"schema_version":2},{"address":"aws_key_pair.this","mode":"managed","type":"aws_key_pair","name":"this","provider_config_key":"aws","expressions":{"key_name":{"references":["var.name"]},"public_key":{"references":["var.public_key_path"]}},"schema_version":1,"count_expression":{"references":["var.key_pair_name","var.public_key_path"]}},{"address":"aws_security_group.web","mode":"managed","type":"aws_security_group","name":"web","provider_config_key":"aws","expressions":{"description":{"constant_value":"Allow SSH and web access from allowlisted CIDR"},"name_prefix":{"references":["var.name"]},"vpc_id":{"references":["var.vpc_id"]}},"schema_version":1},{"address":"aws_vpc_security_group_egress_rule.all","mode":"managed","type":"aws_vpc_security_group_egress_rule","name":"all","provider_config_key":"aws","expressions":{"cidr_ipv4":{"constant_value":"0.0.0.0/0"},"description":{"constant_value":"All outbound"},"ip_protocol":{"constant_value":"-1"},"security_group_id":{"references":["aws_security_group.web.id","aws_security_group.web"]}},"schema_version":0},{"address":"aws_vpc_security_group_ingress_rule.http","mode":"managed","type":"aws_vpc_security_group_ingress_rule","name":"http","provider_config_key":"aws","expressions":{"cidr_ipv4":{"references":["local.allow_cidr"]},"description":{"constant_value":"HTTP from allowlisted CIDR"},"from_port":{"constant_value":80},"ip_protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.web.id","aws_security_group.web"]},"to_port":{"constant_value":80}},"schema_version":0},{"address":"aws_vpc_security_group_ingress_rule.https","mode":"managed","type":"aws_vpc_security_group_ingress_rule","name":"https","provider_config_key":"aws","expressions":{"cidr_ipv4":{"references":["local.allow_cidr"]},"description":{"constant_value":"HTTPS from allowlisted CIDR"},"from_port":{"constant_value":443},"ip_protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.web.id","aws_security_group.web"]},"to_port":{"constant_value":443}},"schema_version":0,"count_expression":{"references":["var.enable_https"]}},{"address":"aws_vpc_security_group_ingress_rule.ssh","mode":"managed","type":"aws_vpc_security_group_ingress_rule","name":"ssh","provider_config_key":"aws","expressions":{"cidr_ipv4":{"references":["local.allow_cidr"]},"description":{"constant_value":"SSH from allowlisted CIDR"},"from_port":{"constant_value":22},"ip_protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.web.id","aws_security_group.web"]},"to_port":{"constant_value":22}},"schema_version":0},{"address":"data.aws_ami.amazon_linux2","mode":"data","type":"aws_ami","name":"amazon_linux2","provider_config_key":"aws","expressions":{"filter":[{"name":{"constant_value":"name"},"values":{"constant_value":["amzn2-ami-hvm-*-x86_64-gp2"]}},{"name":{"constant_value":"virtualization-type"},"values":{"constant_value":["hvm"]}}],"most_recent":{"constant_value":true},"owners":{"constant_value":["amazon"]}},"schema_version":0},{"address":"data.http.myip","mode":"data","type":"http","name":"myip","provider_config_key":"http","expressions":{"url":{"constant_value":"https://checkip.amazonaws.com/"}},"schema_version":0}],"variables":{"allowed_cidr":{"default":null,"description":"CIDR allowed to access the instance (SSH/HTTP/HTTPS). If null, it will be auto-detected from the runner public IP."},"associate_public_ip":{"default":true,"description":"Whether to associate a public IP address. Should be true for a public subnet."},"aws_region":{"default":"ap-northeast-1","description":"AWS region to deploy into."},"enable_https":{"default":false,"description":"Whether to open inbound 443. (TLS termination is not configured by default.)"},"instance_type":{"default":"t3.micro","description":"EC2 instance type."},"key_pair_name":{"default":null,"description":"Existing EC2 key pair name to attach to the instance. If set, Terraform will not create a key pair."},"name":{"default":"ec2-test-server","description":"Name prefix for resources."},"private_key_path":{"default":".security/my-net-keypair.id_rsa","description":"Path to the SSH private key used by Terraform provisioners to connect to the instance."},"public_key_path":{"default":null,"description":"Path to an SSH public key to register as an EC2 key pair (used when key_pair_name is null)."},"public_subnet_id":{"description":"Existing public subnet ID (must have route to an Internet Gateway) to place the instance in."},"root_volume_size_gb":{"default":10,"description":"Root EBS volume size in GiB."},"root_volume_type":{"default":"gp3","description":"Root EBS volume type."},"ssh_username":{"default":"ec2-user","description":"SSH username for the AMI. Amazon Linux 2 uses ec2-user."},"tags":{"default":{"Managed":"terraform","Project":"ec2_test_server"},"description":"Tags applied to all resources via provider default_tags."},"vpc_id":{"description":"Existing VPC ID to deploy into."}}}},"relevant_attributes":[{"resource":"data.aws_ami.amazon_linux2","attribute":["id"]},{"resource":"aws_security_group.web","attribute":["id"]},{"resource":"aws_instance.web","attribute":["public_dns"]},{"resource":"aws_instance.web","attribute":["public_ip"]},{"resource":"data.http.myip","attribute":["response_body"]},{"resource":"aws_key_pair.this[0]","attribute":["key_name"]}],"timestamp":"2026-01-27T00:29:38Z","applyable":true,"complete":true,"errored":false}
