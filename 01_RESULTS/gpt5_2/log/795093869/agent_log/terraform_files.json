{
  "files": [
    {
      "name": "versions.tf",
      "content": "terraform {\n  required_version = \">= 1.5.0\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 6.28\"\n    }\n    archive = {\n      source  = \"hashicorp/archive\"\n      version = \"~> 2.7\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"~> 3.8\"\n    }\n  }\n}\n"
    },
    {
      "name": "provider.tf",
      "content": "provider \"aws\" {\n  region = var.aws_region\n\n  default_tags {\n    tags = merge(\n      {\n        Project   = var.project_name\n        ManagedBy = \"terraform\"\n      },\n      var.tags\n    )\n  }\n}\n\ndata \"aws_caller_identity\" \"current\" {}\n\ndata \"aws_partition\" \"current\" {}\n\ndata \"aws_region\" \"current\" {}\n"
    },
    {
      "name": "variables.tf",
      "content": "variable \"project_name\" {\n  description = \"Project/name prefix used for resource naming.\"\n  type        = string\n  default     = \"trigger-mwaa-dag\"\n}\n\nvariable \"aws_region\" {\n  description = \"AWS region to deploy into.\"\n  type        = string\n  default     = \"us-east-1\"\n}\n\nvariable \"tags\" {\n  description = \"Additional tags to apply to all resources.\"\n  type        = map(string)\n  default     = {}\n}\n\nvariable \"mwaa_environment_name\" {\n  description = \"MWAA environment name.\"\n  type        = string\n  default     = \"trigger-mwaa\"\n}\n\nvariable \"airflow_version\" {\n  description = \"MWAA Airflow version.\"\n  type        = string\n  default     = \"2.9.2\"\n}\n\nvariable \"mwaa_environment_class\" {\n  description = \"MWAA environment class.\"\n  type        = string\n  default     = \"mw1.small\"\n}\n\nvariable \"mwaa_min_workers\" {\n  description = \"Minimum number of MWAA workers.\"\n  type        = number\n  default     = 1\n}\n\nvariable \"mwaa_max_workers\" {\n  description = \"Maximum number of MWAA workers.\"\n  type        = number\n  default     = 2\n}\n\nvariable \"mwaa_webserver_access_mode\" {\n  description = \"MWAA webserver access mode. Use PRIVATE_ONLY for best security.\"\n  type        = string\n  default     = \"PUBLIC_ONLY\"\n  validation {\n    condition     = contains([\"PUBLIC_ONLY\", \"PRIVATE_ONLY\"], var.mwaa_webserver_access_mode)\n    error_message = \"mwaa_webserver_access_mode must be PUBLIC_ONLY or PRIVATE_ONLY.\"\n  }\n}\n\nvariable \"lambda_log_level\" {\n  description = \"Lambda LOG_LEVEL env var.\"\n  type        = string\n  default     = \"INFO\"\n}\n\nvariable \"lambda_timeout_seconds\" {\n  description = \"Lambda timeout in seconds.\"\n  type        = number\n  default     = 30\n}\n\nvariable \"lambda_memory_mb\" {\n  description = \"Lambda memory in MB.\"\n  type        = number\n  default     = 256\n}\n\nvariable \"s3_trigger_prefix\" {\n  description = \"Optional S3 key prefix filter for triggering Lambda. Empty means no prefix filter.\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"s3_trigger_suffix\" {\n  description = \"Optional S3 key suffix filter for triggering Lambda. Empty means no suffix filter.\"\n  type        = string\n  default     = \"input.json\"\n}\n\nvariable \"mwaa_requirements_txt\" {\n  description = \"Contents of requirements.txt to be used by MWAA.\"\n  type        = string\n  default     = \"apache-airflow==2.9.3\\nboto3==1.34.2\\n\"\n}\n\nvariable \"mwaa_startup_script\" {\n  description = \"Optional MWAA startup script content. Empty disables.\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"vpc_cidr\" {\n  description = \"CIDR block for the VPC.\"\n  type        = string\n  default     = \"10.0.0.0/16\"\n}\n\nvariable \"private_subnet_cidrs\" {\n  description = \"Private subnet CIDRs (2 recommended).\"\n  type        = list(string)\n  default     = [\"10.0.0.0/20\", \"10.0.16.0/20\"]\n}\n\nvariable \"public_subnet_cidrs\" {\n  description = \"Public subnet CIDRs (2 recommended) for NAT gateways.\"\n  type        = list(string)\n  default     = [\"10.0.128.0/20\", \"10.0.144.0/20\"]\n}\n"
    },
    {
      "name": "locals.tf",
      "content": "locals {\n  name_prefix = var.project_name\n\n  # Keep bucket names globally unique.\n  bucket_suffix = \"${data.aws_region.current.id}-${data.aws_caller_identity.current.account_id}\"\n\n  input_bucket_name = \"input-${local.bucket_suffix}\"\n  mwaa_bucket_name  = \"mwaa-${local.bucket_suffix}\"\n\n  lambda_function_name = \"${local.name_prefix}-trigger-dag\"\n\n  # MWAA expects these paths inside the source bucket.\n  mwaa_dags_path         = \"dags\"\n  mwaa_requirements_path = \"requirements/requirements.txt\"\n  mwaa_startup_path      = \"startup/startup.sh\"\n}\n"
    },
    {
      "name": "network.tf",
      "content": "data \"aws_availability_zones\" \"available\" {\n  state = \"available\"\n}\n\nresource \"aws_vpc\" \"this\" {\n  cidr_block           = var.vpc_cidr\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  tags = {\n    Name = \"${local.name_prefix}-vpc\"\n  }\n}\n\nresource \"aws_internet_gateway\" \"this\" {\n  vpc_id = aws_vpc.this.id\n\n  tags = {\n    Name = \"${local.name_prefix}-igw\"\n  }\n}\n\nresource \"aws_subnet\" \"public\" {\n  for_each = { for idx, cidr in var.public_subnet_cidrs : idx => cidr }\n\n  vpc_id                  = aws_vpc.this.id\n  cidr_block              = each.value\n  availability_zone       = data.aws_availability_zones.available.names[tonumber(each.key)]\n  map_public_ip_on_launch = true\n\n  tags = {\n    Name = \"${local.name_prefix}-public-${each.key}\"\n    Tier = \"public\"\n  }\n}\n\nresource \"aws_subnet\" \"private\" {\n  for_each = { for idx, cidr in var.private_subnet_cidrs : idx => cidr }\n\n  vpc_id            = aws_vpc.this.id\n  cidr_block        = each.value\n  availability_zone = data.aws_availability_zones.available.names[tonumber(each.key)]\n\n  tags = {\n    Name = \"${local.name_prefix}-private-${each.key}\"\n    Tier = \"private\"\n  }\n}\n\nresource \"aws_route_table\" \"public\" {\n  vpc_id = aws_vpc.this.id\n\n  tags = {\n    Name = \"${local.name_prefix}-public-rt\"\n  }\n}\n\nresource \"aws_route\" \"public_internet\" {\n  route_table_id         = aws_route_table.public.id\n  destination_cidr_block = \"0.0.0.0/0\"\n  gateway_id             = aws_internet_gateway.this.id\n}\n\nresource \"aws_route_table_association\" \"public\" {\n  for_each = aws_subnet.public\n\n  subnet_id      = each.value.id\n  route_table_id = aws_route_table.public.id\n}\n\nresource \"aws_eip\" \"nat\" {\n  for_each = aws_subnet.public\n\n  domain = \"vpc\"\n\n  tags = {\n    Name = \"${local.name_prefix}-nat-eip-${each.key}\"\n  }\n}\n\nresource \"aws_nat_gateway\" \"this\" {\n  for_each = aws_subnet.public\n\n  allocation_id = aws_eip.nat[each.key].id\n  subnet_id     = each.value.id\n\n  tags = {\n    Name = \"${local.name_prefix}-nat-${each.key}\"\n  }\n\n  depends_on = [aws_internet_gateway.this]\n}\n\nresource \"aws_route_table\" \"private\" {\n  for_each = aws_subnet.private\n\n  vpc_id = aws_vpc.this.id\n\n  tags = {\n    Name = \"${local.name_prefix}-private-rt-${each.key}\"\n  }\n}\n\nresource \"aws_route\" \"private_nat\" {\n  for_each = aws_route_table.private\n\n  route_table_id         = each.value.id\n  destination_cidr_block = \"0.0.0.0/0\"\n  nat_gateway_id         = aws_nat_gateway.this[each.key].id\n}\n\nresource \"aws_route_table_association\" \"private\" {\n  for_each = aws_subnet.private\n\n  subnet_id      = each.value.id\n  route_table_id = aws_route_table.private[each.key].id\n}\n\n# S3 gateway endpoint so MWAA can access S3 privately.\nresource \"aws_vpc_endpoint\" \"s3\" {\n  vpc_id            = aws_vpc.this.id\n  service_name      = \"com.amazonaws.${data.aws_region.current.id}.s3\"\n  vpc_endpoint_type = \"Gateway\"\n\n  route_table_ids = concat(\n    [aws_route_table.public.id],\n    [for rt in aws_route_table.private : rt.id]\n  )\n\n  tags = {\n    Name = \"${local.name_prefix}-s3-endpoint\"\n  }\n}\n"
    },
    {
      "name": "s3.tf",
      "content": "resource \"aws_s3_bucket\" \"input\" {\n  bucket        = local.input_bucket_name\n  force_destroy = true\n\n  tags = {\n    Name = local.input_bucket_name\n  }\n}\n\nresource \"aws_s3_bucket_versioning\" \"input\" {\n  bucket = aws_s3_bucket.input.id\n  versioning_configuration {\n    status = \"Enabled\"\n  }\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"input\" {\n  bucket                  = aws_s3_bucket.input.id\n  block_public_acls       = true\n  block_public_policy     = true\n  ignore_public_acls      = true\n  restrict_public_buckets = true\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"input\" {\n  bucket = aws_s3_bucket.input.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}\n\nresource \"aws_s3_bucket_policy\" \"input_tls\" {\n  bucket = aws_s3_bucket.input.id\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Sid       = \"DenyInsecureTransport\"\n        Effect    = \"Deny\"\n        Principal = \"*\"\n        Action    = \"s3:*\"\n        Resource = [\n          aws_s3_bucket.input.arn,\n          \"${aws_s3_bucket.input.arn}/*\"\n        ]\n        Condition = {\n          Bool = {\n            \"aws:SecureTransport\" = \"false\"\n          }\n        }\n      }\n    ]\n  })\n}\n\n# MWAA source bucket (DAGs, requirements, plugins, startup script)\nresource \"aws_s3_bucket\" \"mwaa\" {\n  bucket        = local.mwaa_bucket_name\n  force_destroy = true\n\n  tags = {\n    Name = local.mwaa_bucket_name\n  }\n}\n\nresource \"aws_s3_bucket_versioning\" \"mwaa\" {\n  bucket = aws_s3_bucket.mwaa.id\n  versioning_configuration {\n    status = \"Enabled\"\n  }\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"mwaa\" {\n  bucket                  = aws_s3_bucket.mwaa.id\n  block_public_acls       = true\n  block_public_policy     = true\n  ignore_public_acls      = true\n  restrict_public_buckets = true\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"mwaa\" {\n  bucket = aws_s3_bucket.mwaa.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}\n\nresource \"aws_s3_bucket_policy\" \"mwaa_tls\" {\n  bucket = aws_s3_bucket.mwaa.id\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Sid       = \"DenyInsecureTransport\"\n        Effect    = \"Deny\"\n        Principal = \"*\"\n        Action    = \"s3:*\"\n        Resource = [\n          aws_s3_bucket.mwaa.arn,\n          \"${aws_s3_bucket.mwaa.arn}/*\"\n        ]\n        Condition = {\n          Bool = {\n            \"aws:SecureTransport\" = \"false\"\n          }\n        }\n      }\n    ]\n  })\n}\n\n# Upload the DAG from the repo into the MWAA bucket.\nresource \"aws_s3_object\" \"dag\" {\n  bucket = aws_s3_bucket.mwaa.id\n  key    = \"${local.mwaa_dags_path}/hello-world-dag.py\"\n\n  source       = \"${path.module}/../infra/src/dags/hello-world-dag.py\"\n  content_type = \"text/x-python\"\n\n  etag = filemd5(\"${path.module}/../infra/src/dags/hello-world-dag.py\")\n}\n\nresource \"aws_s3_object\" \"requirements\" {\n  bucket       = aws_s3_bucket.mwaa.id\n  key          = local.mwaa_requirements_path\n  content      = var.mwaa_requirements_txt\n  content_type = \"text/plain\"\n\n  etag = md5(var.mwaa_requirements_txt)\n}\n\nresource \"aws_s3_object\" \"startup\" {\n  count = length(trimspace(var.mwaa_startup_script)) > 0 ? 1 : 0\n\n  bucket       = aws_s3_bucket.mwaa.id\n  key          = local.mwaa_startup_path\n  content      = var.mwaa_startup_script\n  content_type = \"text/x-shellscript\"\n\n  etag = md5(var.mwaa_startup_script)\n}\n"
    },
    {
      "name": "iam.tf",
      "content": "data \"aws_iam_policy_document\" \"lambda_assume\" {\n  statement {\n    effect = \"Allow\"\n    actions = [\n      \"sts:AssumeRole\"\n    ]\n    principals {\n      type        = \"Service\"\n      identifiers = [\"lambda.amazonaws.com\"]\n    }\n  }\n}\n\nresource \"aws_iam_role\" \"lambda\" {\n  name               = \"${local.name_prefix}-lambda-role\"\n  assume_role_policy = data.aws_iam_policy_document.lambda_assume.json\n}\n\nresource \"aws_iam_role_policy_attachment\" \"lambda_basic\" {\n  role       = aws_iam_role.lambda.name\n  policy_arn = \"arn:${data.aws_partition.current.partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n}\n\ndata \"aws_iam_policy_document\" \"lambda_inline\" {\n  statement {\n    sid     = \"MwaaCreateCliToken\"\n    effect  = \"Allow\"\n    actions = [\"mwaa:CreateCliToken\"]\n    resources = [\n      aws_mwaa_environment.this.arn\n    ]\n  }\n\n  # Optional: allow Lambda to read the object if you later decide to validate payload.\n  statement {\n    sid     = \"ReadInputBucket\"\n    effect  = \"Allow\"\n    actions = [\"s3:GetObject\", \"s3:GetObjectVersion\"]\n    resources = [\n      \"${aws_s3_bucket.input.arn}/*\"\n    ]\n  }\n}\n\nresource \"aws_iam_role_policy\" \"lambda_inline\" {\n  name   = \"${local.name_prefix}-lambda-inline\"\n  role   = aws_iam_role.lambda.id\n  policy = data.aws_iam_policy_document.lambda_inline.json\n}\n\n# MWAA execution role\ndata \"aws_iam_policy_document\" \"mwaa_assume\" {\n  statement {\n    effect = \"Allow\"\n    actions = [\n      \"sts:AssumeRole\"\n    ]\n    principals {\n      type        = \"Service\"\n      identifiers = [\"airflow.amazonaws.com\", \"airflow-env.amazonaws.com\"]\n    }\n  }\n}\n\nresource \"aws_iam_role\" \"mwaa\" {\n  name               = \"${local.name_prefix}-mwaa-exec-role\"\n  assume_role_policy = data.aws_iam_policy_document.mwaa_assume.json\n}\n\n# Minimal MWAA permissions for this sample:\n# - read DAGs/requirements from MWAA bucket\n# - read input objects from input bucket\n# - write logs/metrics\n# - KMS not used (SSE-S3), so no decrypt needed\n# - SQS is used internally by MWAA; AWS recommends allowing it\n# - ECR not needed\n# - CloudWatch Logs and Metrics\n\ndata \"aws_iam_policy_document\" \"mwaa_inline\" {\n  statement {\n    sid    = \"S3ReadMwaaBucket\"\n    effect = \"Allow\"\n    actions = [\n      \"s3:GetObject\",\n      \"s3:GetObjectVersion\",\n      \"s3:ListBucket\"\n    ]\n    resources = [\n      aws_s3_bucket.mwaa.arn,\n      \"${aws_s3_bucket.mwaa.arn}/*\"\n    ]\n  }\n\n  statement {\n    sid    = \"S3ReadInputBucket\"\n    effect = \"Allow\"\n    actions = [\n      \"s3:GetObject\",\n      \"s3:GetObjectVersion\",\n      \"s3:ListBucket\"\n    ]\n    resources = [\n      aws_s3_bucket.input.arn,\n      \"${aws_s3_bucket.input.arn}/*\"\n    ]\n  }\n\n  statement {\n    sid    = \"CloudWatchLogs\"\n    effect = \"Allow\"\n    actions = [\n      \"logs:CreateLogGroup\",\n      \"logs:CreateLogStream\",\n      \"logs:PutLogEvents\",\n      \"logs:GetLogEvents\",\n      \"logs:GetLogRecord\",\n      \"logs:GetLogGroupFields\",\n      \"logs:GetQueryResults\",\n      \"logs:DescribeLogGroups\",\n      \"logs:DescribeLogStreams\",\n      \"logs:DescribeLogFields\",\n      \"logs:DescribeQueries\",\n      \"logs:FilterLogEvents\"\n    ]\n    resources = [\"*\"]\n  }\n\n  statement {\n    sid    = \"CloudWatchMetrics\"\n    effect = \"Allow\"\n    actions = [\n      \"cloudwatch:PutMetricData\"\n    ]\n    resources = [\"*\"]\n  }\n\n  statement {\n    sid    = \"SQSForCelery\"\n    effect = \"Allow\"\n    actions = [\n      \"sqs:ChangeMessageVisibility\",\n      \"sqs:DeleteMessage\",\n      \"sqs:GetQueueAttributes\",\n      \"sqs:GetQueueUrl\",\n      \"sqs:ReceiveMessage\",\n      \"sqs:SendMessage\"\n    ]\n    resources = [\"*\"]\n  }\n\n  statement {\n    sid    = \"KMSList\"\n    effect = \"Allow\"\n    actions = [\n      \"kms:DescribeKey\",\n      \"kms:ListAliases\",\n      \"kms:ListKeys\"\n    ]\n    resources = [\"*\"]\n  }\n}\n\nresource \"aws_iam_role_policy\" \"mwaa_inline\" {\n  name   = \"${local.name_prefix}-mwaa-inline\"\n  role   = aws_iam_role.mwaa.id\n  policy = data.aws_iam_policy_document.mwaa_inline.json\n}\n"
    },
    {
      "name": "mwaa.tf",
      "content": "resource \"aws_security_group\" \"mwaa\" {\n  name        = \"${local.name_prefix}-mwaa-sg\"\n  description = \"Security group for MWAA environment\"\n  vpc_id      = aws_vpc.this.id\n\n  # MWAA manages inbound rules; keep none here.\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${local.name_prefix}-mwaa-sg\"\n  }\n}\n\nresource \"aws_mwaa_environment\" \"this\" {\n  name              = var.mwaa_environment_name\n  airflow_version   = var.airflow_version\n  environment_class = var.mwaa_environment_class\n\n  source_bucket_arn = aws_s3_bucket.mwaa.arn\n  dag_s3_path       = local.mwaa_dags_path\n\n  requirements_s3_path = local.mwaa_requirements_path\n\n  startup_script_s3_path = length(trimspace(var.mwaa_startup_script)) > 0 ? local.mwaa_startup_path : null\n\n  execution_role_arn = aws_iam_role.mwaa.arn\n\n  min_workers = var.mwaa_min_workers\n  max_workers = var.mwaa_max_workers\n\n  webserver_access_mode = var.mwaa_webserver_access_mode\n\n  network_configuration {\n    security_group_ids = [aws_security_group.mwaa.id]\n    subnet_ids         = [for s in aws_subnet.private : s.id]\n  }\n\n  logging_configuration {\n    dag_processing_logs {\n      enabled   = true\n      log_level = \"INFO\"\n    }\n    scheduler_logs {\n      enabled   = true\n      log_level = \"INFO\"\n    }\n    task_logs {\n      enabled   = true\n      log_level = \"INFO\"\n    }\n    webserver_logs {\n      enabled   = true\n      log_level = \"INFO\"\n    }\n    worker_logs {\n      enabled   = true\n      log_level = \"INFO\"\n    }\n  }\n\n  depends_on = [\n    aws_s3_object.dag,\n    aws_s3_object.requirements,\n    aws_iam_role_policy.mwaa_inline,\n    aws_vpc_endpoint.s3\n  ]\n\n  tags = {\n    Name = var.mwaa_environment_name\n  }\n}\n"
    },
    {
      "name": "lambda.tf",
      "content": "data \"archive_file\" \"trigger_dag_zip\" {\n  type        = \"zip\"\n  source_dir  = \"${path.module}/../infra/src/lambda/trigger-dag\"\n  output_path = \"${path.module}/builds/trigger-dag.zip\"\n}\n\nresource \"aws_cloudwatch_log_group\" \"lambda\" {\n  name              = \"/aws/lambda/${local.lambda_function_name}\"\n  retention_in_days = 14\n}\n\nresource \"aws_lambda_function\" \"trigger_dag\" {\n  function_name = local.lambda_function_name\n  role          = aws_iam_role.lambda.arn\n\n  filename         = data.archive_file.trigger_dag_zip.output_path\n  source_code_hash = data.archive_file.trigger_dag_zip.output_base64sha256\n\n  handler = \"index.lambda_handler\"\n  runtime = \"python3.12\"\n\n  timeout     = var.lambda_timeout_seconds\n  memory_size = var.lambda_memory_mb\n\n  environment {\n    variables = {\n      LOG_LEVEL     = var.lambda_log_level\n      MWAA_ENV_NAME = aws_mwaa_environment.this.name\n    }\n  }\n\n  depends_on = [\n    aws_cloudwatch_log_group.lambda,\n    aws_iam_role_policy.lambda_inline,\n    aws_iam_role_policy_attachment.lambda_basic\n  ]\n}\n\nresource \"aws_lambda_permission\" \"allow_s3\" {\n  statement_id  = \"AllowExecutionFromS3\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.trigger_dag.function_name\n  principal     = \"s3.amazonaws.com\"\n  source_arn    = aws_s3_bucket.input.arn\n}\n\nresource \"aws_s3_bucket_notification\" \"input\" {\n  bucket = aws_s3_bucket.input.id\n\n  lambda_function {\n    lambda_function_arn = aws_lambda_function.trigger_dag.arn\n    events              = [\"s3:ObjectCreated:*\"]\n\n    filter_prefix = length(var.s3_trigger_prefix) > 0 ? var.s3_trigger_prefix : null\n    filter_suffix = length(var.s3_trigger_suffix) > 0 ? var.s3_trigger_suffix : null\n  }\n\n  depends_on = [aws_lambda_permission.allow_s3]\n}\n"
    },
    {
      "name": "outputs.tf",
      "content": "output \"input_bucket_id\" {\n  description = \"S3 input bucket name (used for testing uploads).\"\n  value       = aws_s3_bucket.input.id\n}\n\noutput \"mwaa_webserver_url\" {\n  description = \"MWAA webserver URL hostname.\"\n  value       = aws_mwaa_environment.this.webserver_url\n}\n\noutput \"mwaa_environment_arn\" {\n  description = \"MWAA environment ARN.\"\n  value       = aws_mwaa_environment.this.arn\n}\n\noutput \"lambda_function_name\" {\n  description = \"Lambda function name.\"\n  value       = aws_lambda_function.trigger_dag.function_name\n}\n\noutput \"mwaa_source_bucket\" {\n  description = \"S3 bucket used by MWAA for DAGs/requirements.\"\n  value       = aws_s3_bucket.mwaa.id\n}\n"
    },
    {
      "name": "terraform.tfvars",
      "content": "# Example values. Adjust as needed.\naws_region            = \"us-east-1\"\nproject_name          = \"trigger-mwaa-dag\"\nmwaa_environment_name = \"trigger-mwaa\"\n\n# For best security use PRIVATE_ONLY, but then you need private access to the webserver.\n# The sample README expects a public webserver URL.\nmwaa_webserver_access_mode = \"PUBLIC_ONLY\"\n\n# Trigger only when input.json is uploaded (matches README/test script)\ns3_trigger_suffix = \"input.json\"\n"
    }
  ]
}