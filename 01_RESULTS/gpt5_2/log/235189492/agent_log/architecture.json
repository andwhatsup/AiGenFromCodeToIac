{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\nskinparam shadowing false\nskinparam componentStyle rectangle\n\ntitle High-level Deployment Architecture (Go AWS Lambda + Step Functions)\n\nnode \"AWS Account\" as aws {\n\n  node \"AWS Step Functions\" as sfn_node {\n    artifact \"State Machine\\n(definition.json)\" as sfn_sm\n  }\n\n  node \"AWS Lambda\" as lambda_node {\n    artifact \"Iterator/Dispatcher Lambda\\nGo (aws-lambda-go)\\nmain.go\" as iterator_lambda\n    artifact \"Target Lambda\\n(External/Provided)\\nName from env: LAMBDA\" as target_lambda\n  }\n\n  node \"AWS IAM\" as iam_node {\n    artifact \"Lambda Execution Role\\n(assume_role_policy.json)\" as lambda_role\n  }\n\n  node \"Amazon S3\" as s3_node {\n    artifact \"Artifact Bucket/Object\\ns3://rockset-public/iterator.zip\" as s3_artifact\n  }\n\n  node \"CI/CD\" as cicd_node {\n    artifact \"CircleCI Pipeline\\n.circleci/config.yml\" as circleci\n  }\n}\n\n' Relationships\nsfn_sm --> iterator_lambda : Invoke on schedule\\n(~every 10s)\niterator_lambda --> target_lambda : Async invoke\\n(AWS SDK Go)\niterator_lambda ..> lambda_role : Assumes role\\nfor AWS API calls\ncircleci --> s3_artifact : Build + zip + upload\ns3_artifact --> iterator_lambda : Deployment package\\n(iterator.zip)\n\n@enduml",
  "svg_diagram": "<?plantuml 1.2026.2beta1?><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" contentStyleType=\"text/css\" data-diagram-type=\"DESCRIPTION\" height=\"770px\" preserveAspectRatio=\"none\" style=\"width:612px;height:770px;background:#FFFFFF;\" version=\"1.1\" viewBox=\"0 0 612 770\" width=\"612px\" zoomAndPan=\"magnify\"><title>High-level Deployment Architecture (Go AWS Lambda + Step Functions)</title><defs/><g><g class=\"title\" data-source-line=\"7\"><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"570.7324\" x=\"13.6338\" y=\"22.9951\">High-level Deployment Architecture (Go AWS Lambda + Step Functions)</text></g><!--cluster aws--><g class=\"cluster\" data-qualified-name=\"aws\" data-source-line=\"9\" id=\"ent0002\"><polygon fill=\"#FFFFFF\" points=\"16,53.2969,26,43.2969,595,43.2969,595,743.1169,585,753.1169,16,753.1169,16,53.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"585\" x2=\"595\" y1=\"53.2969\" y2=\"43.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"16\" x2=\"585\" y1=\"53.2969\" y2=\"53.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"585\" x2=\"585\" y1=\"53.2969\" y2=\"753.1169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"104.9111\" x=\"249.0444\" y=\"69.292\">AWS Account</text></g><!--cluster sfn_node--><g class=\"cluster\" data-qualified-name=\"aws.sfn_node\" data-source-line=\"11\" id=\"ent0003\"><polygon fill=\"#FFFFFF\" points=\"40,259.8869,50,249.8869,275,249.8869,275,351.4869,265,361.4869,40,361.4869,40,259.8869\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"265\" x2=\"275\" y1=\"259.8869\" y2=\"249.8869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"40\" x2=\"265\" y1=\"259.8869\" y2=\"259.8869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"265\" x2=\"265\" y1=\"259.8869\" y2=\"361.4869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"159.6055\" x=\"73.6973\" y=\"275.882\">AWS Step Functions</text></g><!--cluster lambda_node--><g class=\"cluster\" data-qualified-name=\"aws.lambda_node\" data-source-line=\"15\" id=\"ent0005\"><polygon fill=\"#FFFFFF\" points=\"49,432.4869,59,422.4869,305,422.4869,305,719.1169,295,729.1169,49,729.1169,49,432.4869\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"295\" x2=\"305\" y1=\"432.4869\" y2=\"422.4869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"49\" x2=\"295\" y1=\"432.4869\" y2=\"432.4869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"295\" x2=\"295\" y1=\"432.4869\" y2=\"729.1169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"103.6807\" x=\"121.1597\" y=\"448.482\">AWS Lambda</text></g><!--cluster iam_node--><g class=\"cluster\" data-qualified-name=\"aws.iam_node\" data-source-line=\"20\" id=\"ent0008\"><polygon fill=\"#FFFFFF\" points=\"329,619.3769,339,609.3769,571,609.3769,571,710.9669,561,720.9669,329,720.9669,329,619.3769\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"561\" x2=\"571\" y1=\"619.3769\" y2=\"609.3769\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"329\" x2=\"561\" y1=\"619.3769\" y2=\"619.3769\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"561\" x2=\"561\" y1=\"619.3769\" y2=\"720.9669\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"71.21\" x=\"410.395\" y=\"635.372\">AWS IAM</text></g><!--cluster s3_node--><g class=\"cluster\" data-qualified-name=\"aws.s3_node\" data-source-line=\"24\" id=\"ent0010\"><polygon fill=\"#FFFFFF\" points=\"299,259.8869,309,249.8869,571,249.8869,571,351.4869,561,361.4869,299,361.4869,299,259.8869\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"561\" x2=\"571\" y1=\"259.8869\" y2=\"249.8869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"299\" x2=\"561\" y1=\"259.8869\" y2=\"259.8869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"561\" x2=\"561\" y1=\"259.8869\" y2=\"361.4869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"87.3018\" x=\"387.3491\" y=\"275.882\">Amazon S3</text></g><!--cluster cicd_node--><g class=\"cluster\" data-qualified-name=\"aws.cicd_node\" data-source-line=\"28\" id=\"ent0012\"><polygon fill=\"#FFFFFF\" points=\"338,101.2969,348,91.2969,532,91.2969,532,192.8869,522,202.8869,338,202.8869,338,101.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"522\" x2=\"532\" y1=\"101.2969\" y2=\"91.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"338\" x2=\"522\" y1=\"101.2969\" y2=\"101.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"522\" x2=\"522\" y1=\"101.2969\" y2=\"202.8869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"42.4922\" x=\"409.7539\" y=\"117.292\">CI/CD</text></g><!--entity sfn_sm--><g class=\"entity\" data-qualified-name=\"aws.sfn_node.sfn_sm\" data-source-line=\"12\" id=\"ent0004\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"139.8945\" x=\"107.05\" y=\"289.8869\"/><polygon fill=\"#FFFFFF\" points=\"229.9445,294.8869,229.9445,308.8869,241.9445,308.8869,241.9445,300.8869,235.9445,294.8869,229.9445,294.8869\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"235.9445\" x2=\"235.9445\" y1=\"294.8869\" y2=\"300.8869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"241.9445\" x2=\"235.9445\" y1=\"300.8869\" y2=\"300.8869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"37.0576\" x=\"121.9411\" y=\"315.882\">State</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"158.9987\" y=\"315.882\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"58.6045\" x=\"163.4489\" y=\"315.882\">Machine</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"109.8945\" x=\"117.05\" y=\"332.1789\">(definition.json)</text></g><!--entity iterator_lambda--><g class=\"entity\" data-qualified-name=\"aws.lambda_node.iterator_lambda\" data-source-line=\"16\" id=\"ent0006\"><rect fill=\"#FFFFFF\" height=\"71.8906\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"223.7715\" x=\"65.11\" y=\"462.4869\"/><polygon fill=\"#FFFFFF\" points=\"271.8815,467.4869,271.8815,481.4869,283.8815,481.4869,283.8815,473.4869,277.8815,467.4869,271.8815,467.4869\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"277.8815\" x2=\"277.8815\" y1=\"467.4869\" y2=\"473.4869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"283.8815\" x2=\"277.8815\" y1=\"473.4869\" y2=\"473.4869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"132.9521\" x=\"75.11\" y=\"488.482\">Iterator/Dispatcher</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"208.0621\" y=\"488.482\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.3691\" x=\"212.5123\" y=\"488.482\">Lambda</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"19.4141\" x=\"100.9328\" y=\"504.7789\">Go</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"120.3468\" y=\"504.7789\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"118.2617\" x=\"124.797\" y=\"504.7789\">(aws-lambda-go)</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.8818\" x=\"143.5548\" y=\"521.0757\">main.go</text></g><!--entity target_lambda--><g class=\"entity\" data-qualified-name=\"aws.lambda_node.target_lambda\" data-source-line=\"17\" id=\"ent0007\"><rect fill=\"#FFFFFF\" height=\"71.8906\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"207.4473\" x=\"73.28\" y=\"641.2269\"/><polygon fill=\"#FFFFFF\" points=\"263.7273,646.2269,263.7273,660.2269,275.7273,660.2269,275.7273,652.2269,269.7273,646.2269,263.7273,646.2269\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"269.7273\" x2=\"269.7273\" y1=\"646.2269\" y2=\"652.2269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"275.7273\" x2=\"269.7273\" y1=\"652.2269\" y2=\"652.2269\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"45.876\" x=\"118.656\" y=\"667.222\">Target</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"164.532\" y=\"667.222\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.3691\" x=\"168.9821\" y=\"667.222\">Lambda</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"135.2969\" x=\"104.3552\" y=\"683.5189\">(External/Provided)</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"41.3027\" x=\"83.28\" y=\"699.8157\">Name</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"124.5827\" y=\"699.8157\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"32.8877\" x=\"129.0329\" y=\"699.8157\">from</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"161.9206\" y=\"699.8157\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"30.4883\" x=\"166.3708\" y=\"699.8157\">env:</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"196.8591\" y=\"699.8157\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"59.418\" x=\"201.3093\" y=\"699.8157\">LAMBDA</text></g><!--entity lambda_role--><g class=\"entity\" data-qualified-name=\"aws.iam_node.lambda_role\" data-source-line=\"21\" id=\"ent0009\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"210.3252\" x=\"344.84\" y=\"649.3769\"/><polygon fill=\"#FFFFFF\" points=\"538.1652,654.3769,538.1652,668.3769,550.1652,668.3769,550.1652,660.3769,544.1652,654.3769,538.1652,654.3769\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"544.1652\" x2=\"544.1652\" y1=\"654.3769\" y2=\"660.3769\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"550.1652\" x2=\"544.1652\" y1=\"660.3769\" y2=\"660.3769\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.3691\" x=\"362.404\" y=\"675.372\">Lambda</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"418.7731\" y=\"675.372\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"69.1318\" x=\"423.2233\" y=\"675.372\">Execution</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"492.3551\" y=\"675.372\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"30.7959\" x=\"496.8053\" y=\"675.372\">Role</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"180.3252\" x=\"354.84\" y=\"691.6689\">(assume_role_policy.json)</text></g><!--entity s3_artifact--><g class=\"entity\" data-qualified-name=\"aws.s3_node.s3_artifact\" data-source-line=\"25\" id=\"ent0011\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"240.4785\" x=\"314.76\" y=\"289.8869\"/><polygon fill=\"#FFFFFF\" points=\"538.2385,294.8869,538.2385,308.8869,550.2385,308.8869,550.2385,300.8869,544.2385,294.8869,538.2385,294.8869\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"544.2385\" x2=\"544.2385\" y1=\"294.8869\" y2=\"300.8869\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"550.2385\" x2=\"544.2385\" y1=\"300.8869\" y2=\"300.8869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"51.4063\" x=\"352.7224\" y=\"315.882\">Artifact</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"404.1287\" y=\"315.882\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"98.6973\" x=\"408.5788\" y=\"315.882\">Bucket/Object</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"210.4785\" x=\"324.76\" y=\"332.1789\">s3://rockset-public/iterator.zip</text></g><!--entity circleci--><g class=\"entity\" data-qualified-name=\"aws.cicd_node.circleci\" data-source-line=\"29\" id=\"ent0013\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"161.4004\" x=\"354.3\" y=\"131.2969\"/><polygon fill=\"#FFFFFF\" points=\"498.7004,136.2969,498.7004,150.2969,510.7004,150.2969,510.7004,142.2969,504.7004,136.2969,498.7004,136.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"504.7004\" x2=\"504.7004\" y1=\"136.2969\" y2=\"142.2969\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"510.7004\" x2=\"504.7004\" y1=\"142.2969\" y2=\"142.2969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"53.5254\" x=\"373.4636\" y=\"157.292\">CircleCI</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"426.989\" y=\"157.292\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"55.0977\" x=\"431.4392\" y=\"157.292\">Pipeline</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"131.4004\" x=\"364.3\" y=\"173.5889\">.circleci/config.yml</text></g><!--link sfn_sm to iterator_lambda--><g class=\"link\" data-entity-1=\"ent0004\" data-entity-2=\"ent0006\" data-link-type=\"dependency\" data-source-line=\"34\" id=\"lnk14\"><path d=\"M177,345.8369 C177,376.8869 177,421.8469 177,456.0069\" fill=\"none\" id=\"sfn_sm-to-iterator_lambda\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"177,462.0069,181,453.0069,177,457.0069,173,453.0069,177,462.0069\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"39.9199\" x=\"178\" y=\"389.6255\">Invoke</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"217.9199\" y=\"389.6255\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"14.9473\" x=\"221.7344\" y=\"389.6255\">on</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"236.6816\" y=\"389.6255\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"53.7773\" x=\"240.4961\" y=\"389.6255\">schedule</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"48.6387\" x=\"196.8086\" y=\"403.5943\">(~every</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"245.4473\" y=\"403.5943\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"26.2031\" x=\"249.2617\" y=\"403.5943\">10s)</text></g><!--link iterator_lambda to target_lambda--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0007\" data-link-type=\"dependency\" data-source-line=\"35\" id=\"lnk15\"><path d=\"M177,534.7669 C177,565.5969 177,604.0869 177,634.8869\" fill=\"none\" id=\"iterator_lambda-to-target_lambda\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"177,640.8869,181,631.8869,177,635.8869,173,631.8869,177,640.8869\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"35.7656\" x=\"181.3779\" y=\"576.5155\">Async</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"217.1436\" y=\"576.5155\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"39.7148\" x=\"220.958\" y=\"576.5155\">invoke</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"32.373\" x=\"178\" y=\"590.4843\">(AWS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"210.373\" y=\"590.4843\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"24.7266\" x=\"214.1875\" y=\"590.4843\">SDK</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"238.9141\" y=\"590.4843\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"21.3223\" x=\"242.7285\" y=\"590.4843\">Go)</text></g><!--link iterator_lambda to lambda_role--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0009\" data-link-type=\"dependency\" data-source-line=\"36\" id=\"lnk16\"><path d=\"M231.59,534.7669 C283.56,568.4169 355.6338,615.0755 402.9638,645.7255\" fill=\"none\" id=\"iterator_lambda-to-lambda_role\" style=\"stroke:#000000;stroke-width:2;stroke-dasharray:7,7;\"/><polygon fill=\"#000000\" points=\"408,648.9869,402.6199,640.7374,403.8031,646.2691,398.2714,647.4523,408,648.9869\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"53.6426\" x=\"332.5205\" y=\"576.5155\">Assumes</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"386.1631\" y=\"576.5155\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"22.9922\" x=\"389.9775\" y=\"576.5155\">role</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"16.5\" x=\"322\" y=\"590.4843\">for</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"338.5\" y=\"590.4843\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"27.6914\" x=\"342.3145\" y=\"590.4843\">AWS</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"370.0059\" y=\"590.4843\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"18.9844\" x=\"373.8203\" y=\"590.4843\">API</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"392.8047\" y=\"590.4843\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"26.8711\" x=\"396.6191\" y=\"590.4843\">calls</text></g><!--link circleci to s3_artifact--><g class=\"link\" data-entity-1=\"ent0013\" data-entity-2=\"ent0011\" data-link-type=\"dependency\" data-source-line=\"37\" id=\"lnk17\"><path d=\"M435,187.3669 C435,216.0269 435,254.8269 435,283.4569\" fill=\"none\" id=\"circleci-to-s3_artifact\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"435,289.4569,439,280.4569,435,284.4569,431,280.4569,435,289.4569\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"30.123\" x=\"436\" y=\"231.0255\">Build</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"466.123\" y=\"231.0255\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"10.0547\" x=\"469.9375\" y=\"231.0255\">+</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"479.9922\" y=\"231.0255\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"17.25\" x=\"483.8066\" y=\"231.0255\">zip</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"501.0566\" y=\"231.0255\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"10.0547\" x=\"504.8711\" y=\"231.0255\">+</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"514.9258\" y=\"231.0255\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"40.8691\" x=\"518.7402\" y=\"231.0255\">upload</text></g><!--link s3_artifact to iterator_lambda--><g class=\"link\" data-entity-1=\"ent0011\" data-entity-2=\"ent0006\" data-link-type=\"dependency\" data-source-line=\"38\" id=\"lnk18\"><path d=\"M395.82,345.8369 C350.99,376.8869 282.3721,424.4301 233.0621,458.5901\" fill=\"none\" id=\"s3_artifact-to-iterator_lambda\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"228.13,462.0069,237.806,460.1698,232.2401,459.1596,233.2503,453.5937,228.13,462.0069\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"73.4004\" x=\"345\" y=\"389.6255\">Deployment</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"418.4004\" y=\"389.6255\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"50.8711\" x=\"422.2148\" y=\"389.6255\">package</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"75.1172\" x=\"371.4844\" y=\"403.5943\">(iterator.zip)</text></g><?plantuml-src RLHBRzf04BxxLqnpAQYodJQt728vaAQeIOj2fLwGqB0Up8PzMBjh4XArlxtZ1H93kVYn-ptciRCVIbf8Gr3ydemRhM0PGkqlyzpXKrR9i6pcZISdh0baGYQipl79AvpxzfrAtl3fmhgqLcW22-JhB-VPULvA7v8FqWZLb6_YERy7Lcjhiff_ayIlfAdHeGQ_nD8-ILF10fMdpWvRrjQm-IHi584Z4T1KYf8aoC0BtsIrJ1MjIS6GQcKtch5GEB6KWR6D8-ZTsZO4k4CzBn4-mIHG3LyR8uBa-Fj9OYn7UTPY2Y5iOy8Pe0VE45wJ1E1z-v0PKNvXPX7moaW0T44kK0GucmGC1FV8aHYQcbwij6o9sQEtfl_6zfgPVmwDjh56Y8gVfpr6WHm6w_AXz3K6iIItequDPzrhcxJbfvNjJur6QRBAHbsvuywsW2FbN-Wg2czYlPjdXXjK-TZPjIofPBKVg0aMpceWixw4k-B-UbX4xH3Pxyf7sOsA-sq8g4_djMlLpJE9fgqOF5ZLrX2zRpJD7F_DQgkas7HgkIjKktbagV65DIONsv9VdFOizb_NZLXHo7_E7_a0JOs_QEV1YfMdaDRDd5tpVUso5rdlHVTAXzw3KJuOHeYGeZpjF91EA1gCO2nhKl6qP2Ak2PdpY2rabMsqsgbirwCB-to41r8OZ-DIrZxP7YX8qwlZ1iCbZCpQhWYu5fwFIjd4clxbuN4R-7pEat1CQMKEUiaYXTyO0J9ACJsEnV0xtDh_wLbsrUrA9BSDzE1YF_dcY9DPZ4SWK2cVxDEBpfsYClMwaQhawUMIyxFXMSSowK9Evzov5MeKAwpQeBlzw_y3?></g></svg>",
  "architecture_description": "## High-level architecture\n\n### Core runtime (AWS)\n- **AWS Step Functions state machine** (from `definition.json`)\n  - Acts as the orchestrator/scheduler.\n  - Configured to invoke the iterator/dispatcher Lambda on a tight cadence (noted as ~every 10 seconds).\n\n- **Iterator/Dispatcher AWS Lambda (Go)**\n  - Implemented in `main.go` using **github.com/aws/aws-lambda-go**.\n  - Uses **github.com/aws/aws-sdk-go** to call AWS APIs.\n  - Primary responsibility: on each invocation, it dispatches work by **asynchronously invoking a target Lambda**.\n\n- **Target AWS Lambda (external/provided)**\n  - Not implemented in this repo; it is referenced by name via the `LAMBDA` environment variable.\n  - Receives asynchronous invocations from the iterator/dispatcher.\n\n- **IAM execution role for the iterator Lambda**\n  - Trust policy defined in `assume_role_policy.json`.\n  - Grants the iterator Lambda permissions required to invoke the target Lambda (and any other AWS API calls it performs).\n\n### Build & artifact distribution (CI/CD)\n- **CircleCI pipeline** (from `/.circleci/config.yml`)\n  - Builds the Go binary, packages it as `iterator.zip`, and uploads it to S3.\n\n- **Amazon S3 artifact bucket/object**\n  - Stores the deployment artifact at `s3://rockset-public/iterator.zip` (as referenced by the CI config).\n  - Serves as the distribution point for the Lambda deployment package.\n\n### Key relationships / flow\n1. **CircleCI → S3**: build, zip, and upload `iterator.zip`.\n2. **S3 → Iterator Lambda**: deployment package is used to deploy/update the iterator Lambda.\n3. **Step Functions → Iterator Lambda**: scheduled invocations (~every 10s).\n4. **Iterator Lambda → Target Lambda**: asynchronous invocation using AWS SDK (function name from `LAMBDA` env var).\n5. **Iterator Lambda ↔ IAM Role**: Lambda runs under/assumes its execution role to authorize AWS API calls."
}