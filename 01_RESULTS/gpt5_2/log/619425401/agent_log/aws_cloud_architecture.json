{
  "aws_architecture_description": "### Proposed high-level AWS architecture (lean, secure, scalable)\n\n#### 1) Triggering / orchestration\n- **Amazon EventBridge (Scheduler / Scheduled Rule)** runs on a cron expression and invokes the Rust Lambda on the desired cadence (e.g., hourly/daily). The event payload is a CloudWatchEvent-compatible structure, matching the handler input.\n- Add **dead-letter handling** and **retry controls** at the invocation layer (EventBridge retry policy + DLQ) so failed maintenance runs are not silently lost.\n\n#### 2) Compute: Rust serverless job\n- **AWS Lambda (Rust, custom runtime on Amazon Linux 2 / provided.al2)** hosts the “Delta Lake Job”.\n- Configure:\n  - **Memory/CPU** sized for Parquet/Arrow work (start ~1024–2048 MB; tune with metrics).\n  - **Timeout** long enough for compaction/maintenance (often minutes; set explicitly).\n  - **Reserved concurrency = 1** (or low) to reduce the chance of concurrent writers; DynamoDB locking still provides correctness.\n  - **Environment variables** for `DATALAKE_LOCATION`, lock provider settings, lock table name, log level, etc.\n\n#### 3) Data layer\n- **Amazon S3** stores the Delta Lake table (Delta transaction log + Parquet files) under a dedicated prefix (e.g., `s3://<bucket>/<table-prefix>/`).\n- **Amazon DynamoDB** provides the lock table used by delta-rs’ S3 locking provider to coordinate safe commits.\n\n#### 4) Security\n- **IAM execution role for Lambda** with least-privilege permissions:\n  - S3: scoped to the specific bucket/prefix for Delta log + Parquet objects.\n  - DynamoDB: scoped to the single lock table (GetItem/PutItem/UpdateItem/DeleteItem/Query as required by the locking implementation).\n  - CloudWatch Logs: create log group/stream and put log events.\n- **S3 bucket security**:\n  - Block Public Access enabled.\n  - Default encryption (SSE-S3 or SSE-KMS).\n  - Bucket policy to enforce TLS (`aws:SecureTransport`) and optionally require SSE-KMS.\n- **DynamoDB encryption** enabled (AWS-owned key by default; optionally CMK).\n- If the S3 bucket uses a **VPC endpoint-only** access pattern, place Lambda in a VPC and use **Gateway Endpoint for S3** (and optionally Interface Endpoint for DynamoDB). Otherwise, keep Lambda out of VPC for simplicity and faster cold starts.\n\n#### 5) Observability / operations\n- **CloudWatch Logs** for application logs.\n- **CloudWatch Metrics + Alarms**:\n  - Lambda Errors, Throttles, Duration (p95/p99), IteratorAge not applicable here.\n  - EventBridge FailedInvocations.\n  - Optional custom metric for “maintenance succeeded/failed” emitted from the function.\n- **AWS X-Ray** (optional) for tracing if you need deeper latency breakdowns.\n\n#### 6) Deployment strategy\n- Package the Rust Lambda as a ZIP artifact (bootstrap + compiled binary) and deploy via IaC (CloudFormation/SAM/CDK/Terraform).\n- Use **versioning + alias** (e.g., `prod`) for safe rollouts; optionally enable **CodeDeploy linear/canary** deployments if failures are costly.\n\n---\n\n### End-to-end flow\n1. EventBridge scheduled rule fires on cron.\n2. EventBridge invokes the Rust Lambda.\n3. Lambda acquires a lock in DynamoDB.\n4. Lambda reads/writes Delta Lake transaction log + Parquet files in S3.\n5. Lambda releases the lock and emits logs/metrics.\n6. On failure, EventBridge retries; persistent failures go to DLQ and trigger an alarm.\n",
  "aws_resources": [
    "Amazon EventBridge Rule (Schedule/Cron)",
    "EventBridge Target: AWS Lambda",
    "AWS Lambda Function (Rust custom runtime)",
    "Lambda Version(s) and Alias (e.g., prod)",
    "IAM Role for Lambda Execution",
    "IAM Policies (least privilege for S3, DynamoDB, CloudWatch Logs)",
    "Amazon S3 Bucket (Delta Lake storage)",
    "S3 Bucket Policy (TLS-only, optional SSE-KMS enforcement)",
    "S3 Public Access Block configuration",
    "S3 Bucket Encryption configuration (SSE-S3 or SSE-KMS)",
    "Amazon DynamoDB Table (Delta-rs lock table)",
    "DynamoDB Encryption (default or KMS CMK)",
    "Amazon CloudWatch Log Group for Lambda",
    "CloudWatch Metric Alarms (Lambda Errors/Throttles/Duration; EventBridge FailedInvocations)",
    "Dead-Letter Queue (Amazon SQS) for failed EventBridge->Lambda invocations (recommended)",
    "AWS KMS Key (optional; if using CMK for S3 and/or DynamoDB)",
    "AWS X-Ray (optional; tracing configuration)",
    "(Optional, only if Lambda must run in VPC) Amazon VPC",
    "(Optional) VPC Subnets (private)",
    "(Optional) Security Group for Lambda ENIs",
    "(Optional) VPC Gateway Endpoint for S3",
    "(Optional) VPC Interface Endpoint for DynamoDB",
    "(Optional) Route Tables for endpoints"
  ]
}