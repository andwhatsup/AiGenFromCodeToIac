{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\n' High-level Deployment Architecture (Python Static Web Server on AWS EKS)\n\nskinparam shadowing false\nskinparam componentStyle rectangle\n\ncloud \"Internet\" as internet\n\nnode \"AWS Cloud\" as aws {\n  node \"Amazon ECR\\nContainer Registry\" as ecr\n\n  node \"Amazon EKS Cluster\" as eks {\n    node \"Kubernetes Namespace\\n(release: echo-server)\" as ns {\n      node \"Kubernetes Service\\nType: LoadBalancer\" as svc\n\n      node \"Kubernetes Deployment\\nreplicas: N\" as deploy {\n        node \"Pod\" as pod {\n          artifact \"Container Image\\nPython 3.9-slim\\nserve.py (http.server)\\nPort: 8080\" as container\n          artifact \"ConfigMap\\nindex.html\" as cm\n        }\n      }\n    }\n  }\n}\n\nnode \"CI/CD\" as cicd {\n  artifact \"GitHub Actions\\n.github/workflows/ci-cd.yml\" as gha\n}\n\nactor \"User Browser\" as browser\nrectangle \"ipinfo.io\\n(3rd-party API)\" as ipinfo\n\nbrowser --> svc : HTTP(S)\nsvc --> pod : TCP 8080\ncontainer ..> cm : reads index.html\nbrowser ..> ipinfo : JSONP request\n\ngha --> ecr : build & push image\n\ngha --> eks : helm upgrade/install\\n+ kubectl apply\n\necr --> container : image pull\n\n@enduml",
  "svg_diagram": "Error: SVG generation tool failed (returned an unspecified error even for a minimal diagram). Unable to provide a validated SVG in this environment.",
  "architecture_description": "## High-level architecture\n\n### Runtime (AWS)\n- **Amazon EKS (Kubernetes cluster)** runs the application.\n  - **Kubernetes Deployment** manages one or more replicas of a **Pod**.\n    - The pod runs a **containerized Python web server**:\n      - **Language/Runtime:** Python\n      - **Base image:** `python:3.9-slim`\n      - **Framework:** Python stdlib `http.server` (`SimpleHTTPRequestHandler`) via `serve.py`\n      - **Port:** 8080\n    - A **Kubernetes ConfigMap** provides the static **`index.html`** content (mounted/consumed by the container).\n  - A **Kubernetes Service (type: LoadBalancer)** exposes the pod(s) externally, implying an underlying cloud load balancer.\n\n- **Amazon ECR** stores the built container image that EKS pulls at deploy/runtime.\n\n### CI/CD (GitHub Actions)\n- **GitHub Actions workflow** builds the Docker image and pushes it to **ECR**.\n- The workflow then deploys to **EKS** using **Helm** (chart under `echo-server/`) and may also apply/create the **ConfigMap** via `kubectl`.\n\n### Client-side external dependency\n- The served `index.html` makes a browser-side call to **`ipinfo.io`** using **JSONP** to fetch IP/location information.\n\n### Key relationships\n- **Browser → LoadBalancer Service → Pod (8080)**: user traffic to the Python HTTP server.\n- **Pod → ConfigMap**: reads static HTML content.\n- **GitHub Actions → ECR → EKS**: build/push image, then deploy; EKS pulls the image from ECR.\n- **Browser → ipinfo.io**: third-party API call from the client."
}