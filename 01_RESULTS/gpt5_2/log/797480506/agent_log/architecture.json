{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\ntitle Rekognition Orchestration (AWS Step Functions) - Deployment\n\nskinparam shadowing false\nskinparam componentStyle rectangle\n\nactor \"Producer / Upstream System\" as Producer\n\nnode \"AWS Cloud\" as AWS {\n\n  node \"Amazon SQS\" as SQS {\n    queue \"Image Events Queue\" as ImageQueue\n  }\n\n  node \"AWS Step Functions\" as SFN {\n    artifact \"Parent State Machine\\nRekognition.json\\n(ASL JSON)\" as ParentSM\n    artifact \"Child State Machines\\nRekognitionDetect*.json\\n(ASL JSON)\" as ChildSMs\n  }\n\n  node \"Amazon Rekognition\" as Rek {\n    component \"DetectLabels\" as DetectLabels\n    component \"DetectFaces\" as DetectFaces\n    component \"DetectText\" as DetectText\n    component \"DetectModerationLabels\" as DetectModeration\n    component \"DetectProtectiveEquipment\" as DetectPPE\n  }\n\n  node \"Amazon S3\" as S3 {\n    database \"Input Images Bucket\" as InputBucket\n    database \"Output Results Bucket\\n(JSON)\" as OutputBucket\n  }\n\n  node \"AWS IAM\" as IAM {\n    component \"Step Functions Execution Role\\n(permissions: s3, rekognition, sfn:StartExecution)\" as SFNRole\n  }\n}\n\nProducer --> ImageQueue : Send message\\n(S3 event records)\nImageQueue --> ParentSM : Trigger execution\\n(via event source mapping / poller)\n\nParentSM --> ChildSMs : StartExecution\\n(nested workflows)\n\nParentSM --> InputBucket : headBucket/headObject\\ngetObjectAttributes\nChildSMs --> InputBucket : Read image metadata\\n(getObjectAttributes)\n\nChildSMs --> DetectLabels : aws-sdk integration\nChildSMs --> DetectFaces : aws-sdk integration\nChildSMs --> DetectText : aws-sdk integration\nChildSMs --> DetectModeration : aws-sdk integration\nChildSMs --> DetectPPE : aws-sdk integration\n\nChildSMs --> OutputBucket : putObject\\n(write JSON results)\n\nParentSM ..> SFNRole : AssumeRole\nChildSMs ..> SFNRole : AssumeRole\n\n@enduml",
  "svg_diagram": "<?plantuml 1.2026.2beta1?><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" contentStyleType=\"text/css\" data-diagram-type=\"DESCRIPTION\" height=\"964px\" preserveAspectRatio=\"none\" style=\"width:1660px;height:964px;background:#FFFFFF;\" version=\"1.1\" viewBox=\"0 0 1660 964\" width=\"1660px\" zoomAndPan=\"magnify\"><title>Rekognition Orchestration (AWS Step Functions) - Deployment</title><defs/><g><g class=\"title\" data-source-line=\"4\"><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"497.2188\" x=\"574.3906\" y=\"22.9951\">Rekognition Orchestration (AWS Step Functions) - Deployment</text></g><!--cluster AWS--><g class=\"cluster\" data-qualified-name=\"AWS\" data-source-line=\"11\" id=\"ent0003\"><polygon fill=\"#FFFFFF\" points=\"16,221.1469,26,211.1469,1643,211.1469,1643,937.7069,1633,947.7069,16,947.7069,16,221.1469\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1633\" x2=\"1643\" y1=\"221.1469\" y2=\"211.1469\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"16\" x2=\"1633\" y1=\"221.1469\" y2=\"221.1469\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1633\" x2=\"1633\" y1=\"221.1469\" y2=\"947.7069\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"85.9141\" x=\"782.543\" y=\"237.142\">AWS Cloud</text></g><!--cluster SQS--><g class=\"cluster\" data-qualified-name=\"AWS.SQS\" data-source-line=\"13\" id=\"ent0004\"><polygon fill=\"#FFFFFF\" points=\"799,269.1469,809,259.1469,997,259.1469,997,331.4369,987,341.4369,799,341.4369,799,269.1469\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"987\" x2=\"997\" y1=\"269.1469\" y2=\"259.1469\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"799\" x2=\"987\" y1=\"269.1469\" y2=\"269.1469\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"987\" x2=\"987\" y1=\"269.1469\" y2=\"341.4369\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"99.5449\" x=\"844.2275\" y=\"285.142\">Amazon SQS</text></g><!--cluster SFN--><g class=\"cluster\" data-qualified-name=\"AWS.SFN\" data-source-line=\"17\" id=\"ent0006\"><polygon fill=\"#FFFFFF\" points=\"771,426.4369,781,416.4369,1006,416.4369,1006,695.2269,996,705.2269,771,705.2269,771,426.4369\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"996\" x2=\"1006\" y1=\"426.4369\" y2=\"416.4369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"771\" x2=\"996\" y1=\"426.4369\" y2=\"426.4369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"996\" x2=\"996\" y1=\"426.4369\" y2=\"705.2269\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"159.6055\" x=\"804.6973\" y=\"442.432\">AWS Step Functions</text></g><!--cluster Rek--><g class=\"cluster\" data-qualified-name=\"AWS.Rek\" data-source-line=\"22\" id=\"ent0009\"><polygon fill=\"#FFFFFF\" points=\"40,808.8169,50,798.8169,932,798.8169,932,881.1169,922,891.1169,40,891.1169,40,808.8169\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"922\" x2=\"932\" y1=\"808.8169\" y2=\"798.8169\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"40\" x2=\"922\" y1=\"808.8169\" y2=\"808.8169\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"922\" x2=\"922\" y1=\"808.8169\" y2=\"891.1169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"162.5449\" x=\"400.7275\" y=\"824.812\">Amazon Rekognition</text></g><!--cluster S3--><g class=\"cluster\" data-qualified-name=\"AWS.S3\" data-source-line=\"30\" id=\"ent0015\"><polygon fill=\"#FFFFFF\" points=\"956,796.1669,966,786.1669,1365,786.1669,1365,893.7569,1355,903.7569,956,903.7569,956,796.1669\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1355\" x2=\"1365\" y1=\"796.1669\" y2=\"786.1669\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"956\" x2=\"1355\" y1=\"796.1669\" y2=\"796.1669\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1355\" x2=\"1355\" y1=\"796.1669\" y2=\"903.7569\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"87.3018\" x=\"1112.8491\" y=\"812.162\">Amazon S3</text></g><!--cluster IAM--><g class=\"cluster\" data-qualified-name=\"AWS.IAM\" data-source-line=\"35\" id=\"ent0018\"><polygon fill=\"#FFFFFF\" points=\"1389,776.2269,1399,766.2269,1619,766.2269,1619,913.7069,1609,923.7069,1389,923.7069,1389,776.2269\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1609\" x2=\"1619\" y1=\"776.2269\" y2=\"766.2269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1389\" x2=\"1609\" y1=\"776.2269\" y2=\"776.2269\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"1609\" x2=\"1609\" y1=\"776.2269\" y2=\"923.7069\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"71.21\" x=\"1464.395\" y=\"792.222\">AWS IAM</text></g><!--entity ImageQueue--><g class=\"entity\" data-qualified-name=\"AWS.SQS.ImageQueue\" data-source-line=\"14\" id=\"ent0005\"><path d=\"M819.93,299.1469 L976.0687,299.1469 C981.0687,299.1469 981.0687,312.2953 981.0687,312.2953 C981.0687,312.2953 981.0687,325.4438 976.0687,325.4438 L819.93,325.4438 C814.93,325.4438 814.93,312.2953 814.93,312.2953 C814.93,312.2953 814.93,299.1469 819.93,299.1469\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M976.0687,299.1469 C971.0687,299.1469 971.0687,312.2953 971.0687,312.2953 C971.0687,325.4438 976.0687,325.4438 976.0687,325.4438\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"43.8457\" x=\"819.93\" y=\"317.142\">Image</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"863.7757\" y=\"317.142\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"47.4004\" x=\"868.2259\" y=\"317.142\">Events</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"915.6263\" y=\"317.142\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"45.9922\" x=\"920.0765\" y=\"317.142\">Queue</text></g><!--entity ParentSM--><g class=\"entity\" data-qualified-name=\"AWS.SFN.ParentSM\" data-source-line=\"18\" id=\"ent0007\"><rect fill=\"#FFFFFF\" height=\"71.8906\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"180.3154\" x=\"807.84\" y=\"456.4369\"/><polygon fill=\"#FFFFFF\" points=\"971.1554,461.4369,971.1554,475.4369,983.1554,475.4369,983.1554,467.4369,977.1554,461.4369,971.1554,461.4369\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"977.1554\" x2=\"977.1554\" y1=\"461.4369\" y2=\"467.4369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"983.1554\" x2=\"977.1554\" y1=\"467.4369\" y2=\"467.4369\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"45.7529\" x=\"817.84\" y=\"482.432\">Parent</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"863.5929\" y=\"482.432\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"37.0576\" x=\"868.0431\" y=\"482.432\">State</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"905.1007\" y=\"482.432\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"58.6045\" x=\"909.5509\" y=\"482.432\">Machine</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"116.5527\" x=\"834.7213\" y=\"498.7289\">Rekognition.json</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"31.7256\" x=\"854.925\" y=\"515.0257\">(ASL</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"886.6505\" y=\"515.0257\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"39.9697\" x=\"891.1007\" y=\"515.0257\">JSON)</text></g><!--entity ChildSMs--><g class=\"entity\" data-qualified-name=\"AWS.SFN.ChildSMs\" data-source-line=\"19\" id=\"ent0008\"><rect fill=\"#FFFFFF\" height=\"71.8906\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"200.2354\" x=\"787.88\" y=\"617.3369\"/><polygon fill=\"#FFFFFF\" points=\"971.1154,622.3369,971.1154,636.3369,983.1154,636.3369,983.1154,628.3369,977.1154,622.3369,971.1154,622.3369\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"977.1154\" x2=\"977.1154\" y1=\"622.3369\" y2=\"628.3369\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"983.1154\" x2=\"977.1154\" y1=\"628.3369\" y2=\"628.3369\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"35.3145\" x=\"809.4122\" y=\"643.332\">Child</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"844.7267\" y=\"643.332\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"37.0576\" x=\"849.1769\" y=\"643.332\">State</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"886.2345\" y=\"643.332\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"65.8984\" x=\"890.6847\" y=\"643.332\">Machines</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"170.2354\" x=\"797.88\" y=\"659.6289\">RekognitionDetect*.json</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"31.7256\" x=\"844.9249\" y=\"675.9257\">(ASL</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"876.6505\" y=\"675.9257\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"39.9697\" x=\"881.1007\" y=\"675.9257\">JSON)</text></g><!--entity DetectLabels--><g class=\"entity\" data-qualified-name=\"AWS.Rek.DetectLabels\" data-source-line=\"23\" id=\"ent0010\"><rect fill=\"#FFFFFF\" height=\"36.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"111.7451\" x=\"56.13\" y=\"838.8169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"91.7451\" x=\"66.13\" y=\"861.812\">DetectLabels</text></g><!--entity DetectFaces--><g class=\"entity\" data-qualified-name=\"AWS.Rek.DetectFaces\" data-source-line=\"24\" id=\"ent0011\"><rect fill=\"#FFFFFF\" height=\"36.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"106.9189\" x=\"202.54\" y=\"838.8169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"86.9189\" x=\"212.54\" y=\"861.812\">DetectFaces</text></g><!--entity DetectText--><g class=\"entity\" data-qualified-name=\"AWS.Rek.DetectText\" data-source-line=\"25\" id=\"ent0012\"><rect fill=\"#FFFFFF\" height=\"36.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"97.6221\" x=\"344.19\" y=\"838.8169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"77.6221\" x=\"354.19\" y=\"861.812\">DetectText</text></g><!--entity DetectModeration--><g class=\"entity\" data-qualified-name=\"AWS.Rek.DetectModeration\" data-source-line=\"26\" id=\"ent0013\"><rect fill=\"#FFFFFF\" height=\"36.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"191.042\" x=\"476.48\" y=\"838.8169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"171.042\" x=\"486.48\" y=\"861.812\">DetectModerationLabels</text></g><!--entity DetectPPE--><g class=\"entity\" data-qualified-name=\"AWS.Rek.DetectPPE\" data-source-line=\"27\" id=\"ent0014\"><rect fill=\"#FFFFFF\" height=\"36.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"213.5186\" x=\"702.24\" y=\"838.8169\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"193.5186\" x=\"712.24\" y=\"861.812\">DetectProtectiveEquipment</text></g><!--entity InputBucket--><g class=\"entity\" data-qualified-name=\"AWS.S3.InputBucket\" data-source-line=\"31\" id=\"ent0016\"><path d=\"M1184.66,844.3169 C1184.66,834.3169 1266.9979,834.3169 1266.9979,834.3169 C1266.9979,834.3169 1349.3358,834.3169 1349.3358,844.3169 L1349.3358,869.6138 C1349.3358,879.6138 1266.9979,879.6138 1266.9979,879.6138 C1266.9979,879.6138 1184.66,879.6138 1184.66,869.6138 L1184.66,844.3169\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M1184.66,844.3169 C1184.66,854.3169 1266.9979,854.3169 1266.9979,854.3169 C1266.9979,854.3169 1349.3358,854.3169 1349.3358,844.3169\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"36.251\" x=\"1194.66\" y=\"871.312\">Input</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1230.911\" y=\"871.312\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"51.1396\" x=\"1235.3612\" y=\"871.312\">Images</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1286.5008\" y=\"871.312\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.3848\" x=\"1290.951\" y=\"871.312\">Bucket</text></g><!--entity OutputBucket--><g class=\"entity\" data-qualified-name=\"AWS.S3.OutputBucket\" data-source-line=\"32\" id=\"ent0017\"><path d=\"M972.45,836.1669 C972.45,826.1669 1060.9983,826.1669 1060.9983,826.1669 C1060.9983,826.1669 1149.5467,826.1669 1149.5467,836.1669 L1149.5467,877.7606 C1149.5467,887.7606 1060.9983,887.7606 1060.9983,887.7606 C1060.9983,887.7606 972.45,887.7606 972.45,877.7606 L972.45,836.1669\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M972.45,836.1669 C972.45,846.1669 1060.9983,846.1669 1060.9983,846.1669 C1060.9983,846.1669 1149.5467,846.1669 1149.5467,836.1669\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.6309\" x=\"982.45\" y=\"863.162\">Output</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1031.0809\" y=\"863.162\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"51.1807\" x=\"1035.5311\" y=\"863.162\">Results</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1086.7117\" y=\"863.162\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"48.3848\" x=\"1091.1619\" y=\"863.162\">Bucket</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"45.4316\" x=\"1038.2825\" y=\"879.4589\">(JSON)</text></g><!--entity SFNRole--><g class=\"entity\" data-qualified-name=\"AWS.IAM.SFNRole\" data-source-line=\"36\" id=\"ent0019\"><rect fill=\"#FFFFFF\" height=\"101.4844\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"197.5156\" x=\"1405.24\" y=\"806.2269\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"31.876\" x=\"1415.24\" y=\"829.222\">Step</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1447.116\" y=\"829.222\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"67.6074\" x=\"1451.5662\" y=\"829.222\">Functions</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1519.1736\" y=\"829.222\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"69.1318\" x=\"1523.6238\" y=\"829.222\">Execution</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"30.7959\" x=\"1488.5999\" y=\"845.5189\">Role</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"94.1719\" x=\"1444.3611\" y=\"861.8157\">(permissions:</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"1538.533\" y=\"861.8157\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"20.6514\" x=\"1542.9832\" y=\"861.8157\">s3,</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"83.959\" x=\"1462.0183\" y=\"878.1126\">rekognition,</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"134.6064\" x=\"1436.6946\" y=\"894.4095\">sfn:StartExecution)</text></g><!--entity Producer--><g class=\"entity\" data-qualified-name=\"Producer\" data-source-line=\"9\" id=\"ent0002\"><ellipse cx=\"898.005\" cy=\"51.2969\" fill=\"#FFFFFF\" rx=\"8\" ry=\"8\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><path d=\"M898.005,59.2969 L898.005,86.2969 M885.005,67.2969 L911.005,67.2969 M898.005,86.2969 L885.005,101.2969 M898.005,86.2969 L911.005,101.2969\" fill=\"none\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"62.5898\" x=\"825.65\" y=\"116.542\">Producer</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"888.2398\" y=\"116.542\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.7168\" x=\"892.69\" y=\"116.542\">/</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"897.4068\" y=\"116.542\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"68.5029\" x=\"901.857\" y=\"116.542\">Upstream</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"52.2061\" x=\"871.902\" y=\"132.8389\">System</text></g><!--link Producer to ImageQueue--><g class=\"link\" data-entity-1=\"ent0002\" data-entity-2=\"ent0005\" data-link-type=\"dependency\" data-source-line=\"40\" id=\"lnk20\"><path d=\"M898,136.4669 C898,188.1569 898,262.4769 898,292.9769\" fill=\"none\" id=\"Producer-to-ImageQueue\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"898,298.9769,902,289.9769,898,293.9769,894,289.9769,898,298.9769\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"30.2227\" x=\"910.7568\" y=\"178.2855\">Send</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"940.9795\" y=\"178.2855\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"53.9297\" x=\"944.7939\" y=\"178.2855\">message</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"19.9336\" x=\"899\" y=\"192.2543\">(S3</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"918.9336\" y=\"192.2543\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"34.1777\" x=\"922.748\" y=\"192.2543\">event</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"956.9258\" y=\"192.2543\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"49.7402\" x=\"960.7402\" y=\"192.2543\">records)</text></g><!--link ImageQueue to ParentSM--><g class=\"link\" data-entity-1=\"ent0005\" data-entity-2=\"ent0007\" data-link-type=\"dependency\" data-source-line=\"41\" id=\"lnk21\"><path d=\"M898,325.8169 C898,352.5769 898,410.1669 898,450.2869\" fill=\"none\" id=\"ImageQueue-to-ParentSM\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"898,456.2869,902,447.2869,898,451.2869,894,447.2869,898,456.2869\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"43.1484\" x=\"899\" y=\"369.5755\">Trigger</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"942.1484\" y=\"369.5755\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"59.0566\" x=\"945.9629\" y=\"369.5755\">execution</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"22.4707\" x=\"899.8145\" y=\"383.5443\">(via</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"922.2852\" y=\"383.5443\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"34.1777\" x=\"926.0996\" y=\"383.5443\">event</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"960.2773\" y=\"383.5443\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"40.1133\" x=\"964.0918\" y=\"383.5443\">source</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"52.834\" x=\"900.4443\" y=\"397.513\">mapping</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"953.2783\" y=\"397.513\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"4.043\" x=\"957.0928\" y=\"397.513\">/</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"961.1357\" y=\"397.513\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"38.625\" x=\"964.9502\" y=\"397.513\">poller)</text></g><!--link ParentSM to ChildSMs--><g class=\"link\" data-entity-1=\"ent0007\" data-entity-2=\"ent0008\" data-link-type=\"dependency\" data-source-line=\"43\" id=\"lnk22\"><path d=\"M895.78,528.6469 C894.13,554.8869 892.256,584.5687 890.606,610.8487\" fill=\"none\" id=\"ParentSM-to-ChildSMs\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"890.23,616.8369,894.7861,608.1052,890.5433,611.8467,886.8018,607.6039,890.23,616.8369\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"88.5703\" x=\"906.7793\" y=\"570.4755\">StartExecution</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"45.627\" x=\"894\" y=\"584.4443\">(nested</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"939.627\" y=\"584.4443\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"64.6875\" x=\"943.4414\" y=\"584.4443\">workflows)</text></g><!--link ParentSM to InputBucket--><g class=\"link\" data-entity-1=\"ent0007\" data-entity-2=\"ent0016\" data-link-type=\"dependency\" data-source-line=\"45\" id=\"lnk23\"><path d=\"M988.56,521.2669 C1076.43,553.6969 1204.79,616.6169 1263,721.2269 C1273.41,739.9369 1271.3826,794.7604 1269.1526,827.9204\" fill=\"none\" id=\"ParentSM-to-InputBucket\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"1268.75,833.9069,1273.3449,825.1956,1269.0855,828.9181,1265.3629,824.6588,1268.75,833.9069\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"144.5156\" x=\"1257\" y=\"650.9155\">headBucket/headObject</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"118.2363\" x=\"1270.1396\" y=\"664.8843\">getObjectAttributes</text></g><!--link ChildSMs to InputBucket--><g class=\"link\" data-entity-1=\"ent0008\" data-entity-2=\"ent0016\" data-link-type=\"dependency\" data-source-line=\"46\" id=\"lnk24\"><path d=\"M988.58,680.2669 C1021.33,690.7169 1057.16,704.3569 1088,721.2269 C1106.02,731.0869 1105.33,741.6369 1124,750.2269 C1141.66,758.3469 1149.75,749.2669 1167,758.2269 C1202.12,776.4569 1229.3586,806.3746 1247.1986,829.1346\" fill=\"none\" id=\"ChildSMs-to-InputBucket\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"1250.9,833.8569,1248.496,824.3059,1247.8155,829.9217,1242.1997,829.2412,1250.9,833.8569\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"30.6914\" x=\"1125\" y=\"733.3655\">Read</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1155.6914\" y=\"733.3655\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"37.377\" x=\"1159.5059\" y=\"733.3655\">image</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1196.8828\" y=\"733.3655\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"58.1602\" x=\"1200.6973\" y=\"733.3655\">metadata</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"127.5996\" x=\"1128.1289\" y=\"747.3343\">(getObjectAttributes)</text></g><!--link ChildSMs to DetectLabels--><g class=\"link\" data-entity-1=\"ent0008\" data-entity-2=\"ent0010\" data-link-type=\"dependency\" data-source-line=\"48\" id=\"lnk25\"><path d=\"M787.43,658.4769 C604.15,666.8969 230.04,687.9569 181,721.2269 C140.11,748.9569 123.3787,802.7736 116.6787,832.5136\" fill=\"none\" id=\"ChildSMs-to-DetectLabels\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"115.36,838.3669,121.2402,830.466,116.4589,833.4891,113.4358,828.7078,115.36,838.3669\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"48.5684\" x=\"182\" y=\"740.3655\">aws-sdk</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"230.5684\" y=\"740.3655\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"65.918\" x=\"234.3828\" y=\"740.3655\">integration</text></g><!--link ChildSMs to DetectFaces--><g class=\"link\" data-entity-1=\"ent0008\" data-entity-2=\"ent0011\" data-link-type=\"dependency\" data-source-line=\"49\" id=\"lnk26\"><path d=\"M787.5,656.4069 C650.28,661.0169 413.07,675.5469 341,721.2269 C297.08,749.0569 273.7988,803.0091 263.4788,832.7191\" fill=\"none\" id=\"ChildSMs-to-DetectFaces\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"261.51,838.3869,268.2417,831.1977,263.1506,833.6637,260.6846,828.5727,261.51,838.3869\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"48.5684\" x=\"342\" y=\"740.3655\">aws-sdk</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"390.5684\" y=\"740.3655\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"65.918\" x=\"394.3828\" y=\"740.3655\">integration</text></g><!--link ChildSMs to DetectText--><g class=\"link\" data-entity-1=\"ent0008\" data-entity-2=\"ent0012\" data-link-type=\"dependency\" data-source-line=\"50\" id=\"lnk27\"><path d=\"M787.41,659.7469 C709.16,666.8869 599.26,683.3269 510,721.2269 C455.53,744.3469 419.9677,802.6382 404.0177,833.4582\" fill=\"none\" id=\"ChildSMs-to-DetectText\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"401.26,838.7869,408.949,832.6323,403.5581,834.3463,401.8441,828.9554,401.26,838.7869\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"48.5684\" x=\"511\" y=\"740.3655\">aws-sdk</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"559.5684\" y=\"740.3655\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"65.918\" x=\"563.3828\" y=\"740.3655\">integration</text></g><!--link ChildSMs to DetectModeration--><g class=\"link\" data-entity-1=\"ent0008\" data-entity-2=\"ent0013\" data-link-type=\"dependency\" data-source-line=\"51\" id=\"lnk28\"><path d=\"M787.53,670.2869 C747.63,680.1969 703,696.0469 668,721.2269 C624.4,752.5869 595.8423,804.6063 582.2323,833.2863\" fill=\"none\" id=\"ChildSMs-to-DetectModeration\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"579.66,838.7069,587.1322,832.2908,581.8036,834.1897,579.9048,828.8611,579.66,838.7069\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"48.5684\" x=\"669\" y=\"740.3655\">aws-sdk</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"717.5684\" y=\"740.3655\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"65.918\" x=\"721.3828\" y=\"740.3655\">integration</text></g><!--link ChildSMs to DetectPPE--><g class=\"link\" data-entity-1=\"ent0008\" data-entity-2=\"ent0014\" data-link-type=\"dependency\" data-source-line=\"52\" id=\"lnk29\"><path d=\"M829.91,689.6769 C819.83,698.6369 810.75,709.1969 805,721.2269 C786.63,759.6469 794.8468,805.7414 802.0268,832.5314\" fill=\"none\" id=\"ChildSMs-to-DetectPPE\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"803.58,838.3269,805.1138,828.5982,802.2856,833.4973,797.3865,830.6692,803.58,838.3269\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"48.5684\" x=\"806\" y=\"740.3655\">aws-sdk</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"854.5684\" y=\"740.3655\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"65.918\" x=\"858.3828\" y=\"740.3655\">integration</text></g><!--link ChildSMs to OutputBucket--><g class=\"link\" data-entity-1=\"ent0008\" data-entity-2=\"ent0017\" data-link-type=\"dependency\" data-source-line=\"54\" id=\"lnk30\"><path d=\"M915.3,689.3369 C929.8,707.6869 948.08,730.4069 965,750.2269 C987.22,776.2469 1009.3012,800.5364 1028.7012,821.4664\" fill=\"none\" id=\"ChildSMs-to-OutputBucket\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"1032.78,825.8669,1029.5955,816.5471,1029.381,822.1999,1023.7283,821.9854,1032.78,825.8669\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"59.0098\" x=\"995.0977\" y=\"733.3655\">putObject</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"34.8516\" x=\"966\" y=\"747.3343\">(write</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1000.8516\" y=\"747.3343\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"29.5781\" x=\"1004.666\" y=\"747.3343\">JSON</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"1034.2441\" y=\"747.3343\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"45.1465\" x=\"1038.0586\" y=\"747.3343\">results)</text></g><!--link ParentSM to SFNRole--><g class=\"link\" data-entity-1=\"ent0007\" data-entity-2=\"ent0019\" data-link-type=\"dependency\" data-source-line=\"56\" id=\"lnk31\"><path d=\"M988.55,505.1469 C1118.12,523.6269 1347.67,563.0469 1410,617.3369 C1465.57,665.7269 1487.5675,745.3729 1496.8875,799.8129\" fill=\"none\" id=\"ParentSM-to-SFNRole\" style=\"stroke:#000000;stroke-width:2;stroke-dasharray:7,7;\"/><polygon fill=\"#000000\" points=\"1497.9,805.7269,1500.324,796.181,1497.0563,800.7986,1492.4387,797.5309,1497.9,805.7269\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"73.7871\" x=\"1473\" y=\"657.9155\">AssumeRole</text></g><!--link ChildSMs to SFNRole--><g class=\"link\" data-entity-1=\"ent0008\" data-entity-2=\"ent0019\" data-link-type=\"dependency\" data-source-line=\"57\" id=\"lnk32\"><path d=\"M988.18,671.7369 C1098.17,690.9469 1260.21,719.3569 1267,721.2269 C1311.9,733.5469 1323.85,736.4369 1365,758.2269 C1390.68,771.8169 1412.3145,785.916 1435.1945,802.426\" fill=\"none\" id=\"ChildSMs-to-SFNRole\" style=\"stroke:#000000;stroke-width:2;stroke-dasharray:7,7;\"/><polygon fill=\"#000000\" points=\"1440.06,805.9369,1435.1023,797.4268,1436.0054,803.0111,1430.4211,803.9142,1440.06,805.9369\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"73.7871\" x=\"1350\" y=\"740.3655\">AssumeRole</text></g><?plantuml-src ZLHDR-8m4BtdLqmvmQgGQdlZK8bjgTHLAPHqjPTUJ3845yTE_G7jhlQ_xzWXD40gbKiOptlFOyyRdsMuv19Xz3kPkKB0ojhI3EDOi-qWvtRb5iwWJfMqAEqWLKNCjaQmXV7VFgU4wI-LxfU2IKi2yURxnU0YphYnqHcNgN3PNZocxxKg2YK79OLHPBaL27DSgrnoovM4gKvNQAnc8UeI0HAB9TmwcVebquC-t60fr7j11KMHMNDPCiqAC2kMgIsNEIoPCDZ8KDMbaWHFx3ljfp6rJEO2euYbLcdepBJAN8eQOlXLqkv8fEJTM2mwm0pKwIYIYaxJyLLT2-MoaFNHtoW2s2KBzeTAJnwJaAKlPO5-hmuTvUyAbYECDrIEWKU_5d1XEOG4_jUGExc1IlRsOIVBjELBEWUTWcaI9JIp21EMhgYlpx9nkuCNe-Ipx8wIU_YPJ1zwrUa2BPaSgLslkCWEnSo1sWrQkiXlxQA1dKpCqM6gksc81335kyFiEmMTIlwUBL1KHsukj8DlMOfDR8ZReK_uPXj87xO39rHuvSQJKZvIxLIoZV_m3OvV7I-zNnlisMpSUZd9PTNWozsLPCoo1JFUER9qjZAAWHykNMEb5zQh-8WnTTPJvcYSi3M7UlNHfmgn9nyPxsuqgNOOJKuRTEXA6BzXwiBKpfKWttLBr0KtnYU7O2xFQUxsRJy7ivH3CfUsUrwlDhRdXrgeclrazljNZHc18IGeCoZG65gZtUY-qC-KdswbCzEB6cXFhcrEr2VDyvmqiTwQ-1lETW96EPqY5Ami_MCIGwc4GDsZOce9hrSxt9ToS0uIer6ncC5MwVLIgAqvvZOwHlGLigmAOlztkdWXUppB76trTsIjvWjdoSlxJKzLvaG57XwN0Ytp9g1AMaIec0EPvboHZd_MJRO6JYz-lhDt2pxCrjVXVi2-ZlwOhAzpQ9u-0H-Ycuud0lslBxoxrPmUEpySvA8mCit63GPNjJk9DpB65HYikfV_3F4V?></g></svg>",
  "architecture_description": "## High-level architecture\n\nThis repository defines an event-driven, serverless image-analysis pipeline on AWS using **AWS Step Functions (Amazon States Language JSON definitions)** to orchestrate multiple **Amazon Rekognition** detections and persist results to **Amazon S3**.\n\n### Core components\n- **Amazon SQS (Image Events Queue)**\n  - Entry point for work. Messages are expected to contain **S3 event records** (as implied by the parent state machine checking `eventSource == aws:sqs` and parsing `body`).\n\n- **AWS Step Functions**\n  - **Parent state machine (`state_machine/Rekognition.json`)**: orchestrates the overall workflow, validates/inspects S3 objects (via `headBucket`, `headObject`, `getObjectAttributes`), and starts nested executions.\n  - **Child state machines (`state_machine/RekognitionDetect*.json`)**: each performs a specific Rekognition call (DetectLabels, DetectFaces, DetectText, DetectModerationLabels, DetectProtectiveEquipment) using **Step Functions AWS SDK service integrations**.\n\n- **Amazon Rekognition**\n  - Managed service invoked by the child workflows for the various detection APIs.\n\n- **Amazon S3**\n  - **Input Images Bucket**: stores images referenced by the S3 event records.\n  - **Output Results Bucket**: receives JSON outputs written by the workflows via `s3:putObject`.\n\n- **AWS IAM**\n  - **Step Functions execution role** granting permissions to:\n    - call Rekognition APIs,\n    - read object/bucket metadata from S3,\n    - write results to S3,\n    - start nested Step Functions executions (`sfn:StartExecution`).\n\n### End-to-end flow\n1. An upstream producer sends an SQS message containing S3 event records for newly available images.\n2. The parent Step Functions state machine is triggered and validates/inspects the referenced S3 objects.\n3. The parent starts one or more child state machine executions.\n4. Child workflows call the appropriate Rekognition detection APIs.\n5. Child workflows write consolidated JSON results to the output S3 bucket.\n\n### Notes on implementation technologies\n- The deployable “application logic” is primarily **ASL JSON** (Step Functions definitions). Python in this repo is **dev tooling** (pre-commit, YAML helpers) rather than a deployed runtime service."
}