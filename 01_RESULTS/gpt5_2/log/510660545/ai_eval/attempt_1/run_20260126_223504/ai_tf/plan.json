{"format_version":"1.2","terraform_version":"1.13.5","variables":{"apply_role_allowed_branches":{"value":["refs/heads/main"]},"apply_role_name":{"value":"terraform-apply-role"},"aws_region":{"value":"us-east-1"},"environment":{"value":"dev"},"github_oidc_audience":{"value":"sts.amazonaws.com"},"github_oidc_thumbprints":{"value":["6938fd4d98bab03faadb97b34396831e3780aea1"]},"github_org":{"value":"ai-tf"},"github_repo":{"value":"ai-tf"},"lock_table_name":{"value":"terraform-locks"},"plan_role_name":{"value":"terraform-plan-role"},"project":{"value":"iac-platform"},"state_bucket_force_destroy":{"value":false},"state_bucket_key_prefix":{"value":""},"state_bucket_name":{"value":"ai-tf"},"tags":{"value":{}}},"planned_values":{"outputs":{"cloudtrail_s3_bucket_name":{"sensitive":false},"github_oidc_provider_arn":{"sensitive":false},"terraform_apply_role_arn":{"sensitive":false},"terraform_lock_table_name":{"sensitive":false,"type":"string","value":"terraform-locks"},"terraform_plan_role_arn":{"sensitive":false},"tfstate_bucket_arn":{"sensitive":false},"tfstate_bucket_name":{"sensitive":false},"tfstate_kms_key_arn":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_cloudtrail.main","mode":"managed","type":"aws_cloudtrail","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"advanced_event_selector":[],"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":false,"enable_logging":true,"event_selector":[{"data_resource":[],"exclude_management_event_sources":null,"include_management_events":true,"read_write_type":"All"}],"include_global_service_events":true,"insight_selector":[],"is_multi_region_trail":true,"is_organization_trail":false,"kms_key_id":null,"name":"iac-platform-dev-cloudtrail","s3_key_prefix":null,"sns_topic_name":null,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"}},"sensitive_values":{"advanced_event_selector":[],"event_selector":[{"data_resource":[]}],"insight_selector":[],"tags_all":{}}},{"address":"aws_dynamodb_table.terraform_locks","mode":"managed","type":"aws_dynamodb_table","name":"terraform_locks","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"attribute":[{"name":"LockID","type":"S"}],"billing_mode":"PAY_PER_REQUEST","deletion_protection_enabled":null,"global_secondary_index":[],"hash_key":"LockID","import_table":[],"local_secondary_index":[],"name":"terraform-locks","on_demand_throughput":[],"point_in_time_recovery":[{"enabled":true}],"range_key":null,"replica":[],"restore_date_time":null,"restore_source_name":null,"restore_source_table_arn":null,"restore_to_latest_time":null,"stream_enabled":null,"table_class":null,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"},"timeouts":null},"sensitive_values":{"attribute":[{}],"global_secondary_index":[],"import_table":[],"local_secondary_index":[],"on_demand_throughput":[],"point_in_time_recovery":[{}],"replica":[],"server_side_encryption":[],"tags_all":{},"ttl":[]}},{"address":"aws_iam_openid_connect_provider.github","mode":"managed","type":"aws_iam_openid_connect_provider","name":"github","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"client_id_list":["sts.amazonaws.com"],"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"},"thumbprint_list":["6938fd4d98bab03faadb97b34396831e3780aea1"],"url":"https://token.actions.githubusercontent.com"},"sensitive_values":{"client_id_list":[false],"tags_all":{},"thumbprint_list":[false]}},{"address":"aws_iam_policy.terraform_state_access","mode":"managed","type":"aws_iam_policy","name":"terraform_state_access","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"name":"iac-platform-dev-terraform-state-access","path":"/","tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"}},"sensitive_values":{"tags_all":{}}},{"address":"aws_iam_role.terraform_apply","mode":"managed","type":"aws_iam_role","name":"terraform_apply","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"terraform-apply-role","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}},{"address":"aws_iam_role.terraform_plan","mode":"managed","type":"aws_iam_role","name":"terraform_plan","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"terraform-plan-role","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}},{"address":"aws_iam_role_policy_attachment.apply_state","mode":"managed","type":"aws_iam_role_policy_attachment","name":"apply_state","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"terraform-apply-role"},"sensitive_values":{}},{"address":"aws_iam_role_policy_attachment.plan_state","mode":"managed","type":"aws_iam_role_policy_attachment","name":"plan_state","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"terraform-plan-role"},"sensitive_values":{}},{"address":"aws_kms_alias.tfstate","mode":"managed","type":"aws_kms_alias","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"alias/iac-platform-dev-tfstate"},"sensitive_values":{}},{"address":"aws_kms_key.tfstate","mode":"managed","type":"aws_kms_key","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bypass_policy_lockout_safety_check":false,"custom_key_store_id":null,"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":30,"description":"KMS key for Terraform remote state encryption (S3 SSE-KMS)","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"},"timeouts":null,"xks_key_id":null},"sensitive_values":{"tags_all":{}}},{"address":"aws_s3_bucket.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"iac-platform-dev-cloudtrail-logs-000000000000","force_destroy":false,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"},"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags_all":{},"versioning":[],"website":[]}},{"address":"aws_s3_bucket.tfstate","mode":"managed","type":"aws_s3_bucket","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"ai-tf","force_destroy":false,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"},"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags_all":{},"versioning":[],"website":[]}},{"address":"aws_s3_bucket_ownership_controls.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_ownership_controls","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"rule":[{"object_ownership":"BucketOwnerEnforced"}]},"sensitive_values":{"rule":[{}]}},{"address":"aws_s3_bucket_ownership_controls.tfstate","mode":"managed","type":"aws_s3_bucket_ownership_controls","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"rule":[{"object_ownership":"BucketOwnerEnforced"}]},"sensitive_values":{"rule":[{}]}},{"address":"aws_s3_bucket_policy.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_policy","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"sensitive_values":{}},{"address":"aws_s3_bucket_policy.tfstate","mode":"managed","type":"aws_s3_bucket_policy","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"sensitive_values":{}},{"address":"aws_s3_bucket_public_access_block.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"sensitive_values":{}},{"address":"aws_s3_bucket_public_access_block.tfstate","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"sensitive_values":{}},{"address":"aws_s3_bucket_server_side_encryption_configuration.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"bucket_key_enabled":null}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}},{"address":"aws_s3_bucket_server_side_encryption_configuration.tfstate","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":null}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}},{"address":"aws_s3_bucket_versioning.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_versioning","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"mfa":null,"versioning_configuration":[{"status":"Enabled"}]},"sensitive_values":{"versioning_configuration":[{}]}},{"address":"aws_s3_bucket_versioning.tfstate","mode":"managed","type":"aws_s3_bucket_versioning","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"mfa":null,"versioning_configuration":[{"status":"Enabled"}]},"sensitive_values":{"versioning_configuration":[{}]}},{"address":"data.aws_iam_policy_document.cloudtrail_bucket","mode":"data","type":"aws_iam_policy_document","name":"cloudtrail_bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["s3:GetBucketAcl"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["cloudtrail.amazonaws.com"],"type":"Service"}],"resources":[null],"sid":"AWSCloudTrailAclCheck"},{"actions":["s3:PutObject"],"condition":[{"test":"StringEquals","values":["bucket-owner-full-control"],"variable":"s3:x-amz-acl"}],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["cloudtrail.amazonaws.com"],"type":"Service"}],"resources":[null],"sid":"AWSCloudTrailWrite"},{"actions":["s3:*"],"condition":[{"test":"Bool","values":["false"],"variable":"aws:SecureTransport"}],"effect":"Deny","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["*"],"type":"*"}],"resources":[null,null],"sid":"DenyInsecureTransport"}],"version":null},"sensitive_values":{"statement":[{"actions":[false],"condition":[],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false]},{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false]},{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false,false]}]}},{"address":"data.aws_iam_policy_document.github_assume_apply","mode":"data","type":"aws_iam_policy_document","name":"github_assume_apply","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRoleWithWebIdentity"],"condition":[{"test":"StringEquals","values":["sts.amazonaws.com"],"variable":"token.actions.githubusercontent.com:aud"},{"test":"StringLike","values":["repo:ai-tf/ai-tf:ref:refs/heads/main"],"variable":"token.actions.githubusercontent.com:sub"}],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":[null],"type":"Federated"}],"resources":null,"sid":null}],"version":null},"sensitive_values":{"statement":[{"actions":[false],"condition":[{"values":[false]},{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}]}]}},{"address":"data.aws_iam_policy_document.github_assume_plan","mode":"data","type":"aws_iam_policy_document","name":"github_assume_plan","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRoleWithWebIdentity"],"condition":[{"test":"StringEquals","values":["sts.amazonaws.com"],"variable":"token.actions.githubusercontent.com:aud"},{"test":"StringLike","values":["repo:ai-tf/ai-tf:*"],"variable":"token.actions.githubusercontent.com:sub"}],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":[null],"type":"Federated"}],"resources":null,"sid":null}],"version":null},"sensitive_values":{"statement":[{"actions":[false],"condition":[{"values":[false]},{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}]}]}},{"address":"data.aws_iam_policy_document.kms_tfstate","mode":"data","type":"aws_iam_policy_document","name":"kms_tfstate","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["kms:*"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["arn:aws:iam::000000000000:root"],"type":"AWS"}],"resources":["*"],"sid":"EnableRootPermissions"},{"actions":["kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:GenerateDataKey*","kms:ReEncrypt*"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":[null,null],"type":"AWS"}],"resources":["*"],"sid":"AllowGitHubRolesUseKey"}],"version":null},"sensitive_values":{"statement":[{"actions":[false],"condition":[],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false]},{"actions":[false,false,false,false,false],"condition":[],"not_principals":[],"principals":[{"identifiers":[false,false]}],"resources":[false]}]}},{"address":"data.aws_iam_policy_document.terraform_state_access","mode":"data","type":"aws_iam_policy_document","name":"terraform_state_access","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["s3:GetBucketLocation","s3:ListBucket"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"ListStateBucket"},{"actions":["s3:AbortMultipartUpload","s3:DeleteObject","s3:GetObject","s3:GetObjectVersion","s3:ListBucketMultipartUploads","s3:ListMultipartUploadParts","s3:PutObject"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"StateObjectRW"},{"actions":["dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:PutItem","dynamodb:UpdateItem"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"DynamoDBLocking"},{"actions":["kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:GenerateDataKey*","kms:ReEncrypt*"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"KMSForState"}],"version":null},"sensitive_values":{"statement":[{"actions":[false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false,false,false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]}]}},{"address":"data.aws_iam_policy_document.tfstate_bucket","mode":"data","type":"aws_iam_policy_document","name":"tfstate_bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["s3:*"],"condition":[{"test":"Bool","values":["false"],"variable":"aws:SecureTransport"}],"effect":"Deny","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["*"],"type":"*"}],"resources":[null,null],"sid":"DenyInsecureTransport"}],"version":null},"sensitive_values":{"statement":[{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false,false]}]}}]}},"resource_changes":[{"address":"data.aws_iam_policy_document.cloudtrail_bucket","mode":"data","type":"aws_iam_policy_document","name":"cloudtrail_bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["s3:GetBucketAcl"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["cloudtrail.amazonaws.com"],"type":"Service"}],"resources":[null],"sid":"AWSCloudTrailAclCheck"},{"actions":["s3:PutObject"],"condition":[{"test":"StringEquals","values":["bucket-owner-full-control"],"variable":"s3:x-amz-acl"}],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["cloudtrail.amazonaws.com"],"type":"Service"}],"resources":[null],"sid":"AWSCloudTrailWrite"},{"actions":["s3:*"],"condition":[{"test":"Bool","values":["false"],"variable":"aws:SecureTransport"}],"effect":"Deny","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["*"],"type":"*"}],"resources":[null,null],"sid":"DenyInsecureTransport"}],"version":null},"after_unknown":{"id":true,"json":true,"minified_json":true,"statement":[{"actions":[false],"condition":[],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[true]},{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[true]},{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[true,true]}]},"before_sensitive":false,"after_sensitive":{"statement":[{"actions":[false],"condition":[],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false]},{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false]},{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false,false]}]}},"action_reason":"read_because_config_unknown"},{"address":"data.aws_iam_policy_document.github_assume_apply","mode":"data","type":"aws_iam_policy_document","name":"github_assume_apply","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRoleWithWebIdentity"],"condition":[{"test":"StringEquals","values":["sts.amazonaws.com"],"variable":"token.actions.githubusercontent.com:aud"},{"test":"StringLike","values":["repo:ai-tf/ai-tf:ref:refs/heads/main"],"variable":"token.actions.githubusercontent.com:sub"}],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":[null],"type":"Federated"}],"resources":null,"sid":null}],"version":null},"after_unknown":{"id":true,"json":true,"minified_json":true,"statement":[{"actions":[false],"condition":[{"values":[false]},{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[true]}]}]},"before_sensitive":false,"after_sensitive":{"statement":[{"actions":[false],"condition":[{"values":[false]},{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}]}]}},"action_reason":"read_because_config_unknown"},{"address":"data.aws_iam_policy_document.github_assume_plan","mode":"data","type":"aws_iam_policy_document","name":"github_assume_plan","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRoleWithWebIdentity"],"condition":[{"test":"StringEquals","values":["sts.amazonaws.com"],"variable":"token.actions.githubusercontent.com:aud"},{"test":"StringLike","values":["repo:ai-tf/ai-tf:*"],"variable":"token.actions.githubusercontent.com:sub"}],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":[null],"type":"Federated"}],"resources":null,"sid":null}],"version":null},"after_unknown":{"id":true,"json":true,"minified_json":true,"statement":[{"actions":[false],"condition":[{"values":[false]},{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[true]}]}]},"before_sensitive":false,"after_sensitive":{"statement":[{"actions":[false],"condition":[{"values":[false]},{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}]}]}},"action_reason":"read_because_config_unknown"},{"address":"data.aws_iam_policy_document.kms_tfstate","mode":"data","type":"aws_iam_policy_document","name":"kms_tfstate","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["kms:*"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["arn:aws:iam::000000000000:root"],"type":"AWS"}],"resources":["*"],"sid":"EnableRootPermissions"},{"actions":["kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:GenerateDataKey*","kms:ReEncrypt*"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":[null,null],"type":"AWS"}],"resources":["*"],"sid":"AllowGitHubRolesUseKey"}],"version":null},"after_unknown":{"id":true,"json":true,"minified_json":true,"statement":[{"actions":[false],"condition":[],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false]},{"actions":[false,false,false,false,false],"condition":[],"not_principals":[],"principals":[{"identifiers":[true,true]}],"resources":[false]}]},"before_sensitive":false,"after_sensitive":{"statement":[{"actions":[false],"condition":[],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false]},{"actions":[false,false,false,false,false],"condition":[],"not_principals":[],"principals":[{"identifiers":[false,false]}],"resources":[false]}]}},"action_reason":"read_because_config_unknown"},{"address":"data.aws_iam_policy_document.terraform_state_access","mode":"data","type":"aws_iam_policy_document","name":"terraform_state_access","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["s3:GetBucketLocation","s3:ListBucket"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"ListStateBucket"},{"actions":["s3:AbortMultipartUpload","s3:DeleteObject","s3:GetObject","s3:GetObjectVersion","s3:ListBucketMultipartUploads","s3:ListMultipartUploadParts","s3:PutObject"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"StateObjectRW"},{"actions":["dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:PutItem","dynamodb:UpdateItem"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"DynamoDBLocking"},{"actions":["kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:GenerateDataKey*","kms:ReEncrypt*"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"KMSForState"}],"version":null},"after_unknown":{"id":true,"json":true,"minified_json":true,"statement":[{"actions":[false,false],"condition":[],"not_principals":[],"principals":[],"resources":[true]},{"actions":[false,false,false,false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[true]},{"actions":[false,false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[true]},{"actions":[false,false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[true]}]},"before_sensitive":false,"after_sensitive":{"statement":[{"actions":[false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false,false,false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]}]}},"action_reason":"read_because_config_unknown"},{"address":"data.aws_iam_policy_document.tfstate_bucket","mode":"data","type":"aws_iam_policy_document","name":"tfstate_bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["s3:*"],"condition":[{"test":"Bool","values":["false"],"variable":"aws:SecureTransport"}],"effect":"Deny","not_actions":null,"not_principals":[],"not_resources":null,"principals":[{"identifiers":["*"],"type":"*"}],"resources":[null,null],"sid":"DenyInsecureTransport"}],"version":null},"after_unknown":{"id":true,"json":true,"minified_json":true,"statement":[{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[true,true]}]},"before_sensitive":false,"after_sensitive":{"statement":[{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[{"identifiers":[false]}],"resources":[false,false]}]}},"action_reason":"read_because_config_unknown"},{"address":"aws_cloudtrail.main","mode":"managed","type":"aws_cloudtrail","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"advanced_event_selector":[],"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":false,"enable_logging":true,"event_selector":[{"data_resource":[],"exclude_management_event_sources":null,"include_management_events":true,"read_write_type":"All"}],"include_global_service_events":true,"insight_selector":[],"is_multi_region_trail":true,"is_organization_trail":false,"kms_key_id":null,"name":"iac-platform-dev-cloudtrail","s3_key_prefix":null,"sns_topic_name":null,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"}},"after_unknown":{"advanced_event_selector":[],"arn":true,"event_selector":[{"data_resource":[]}],"home_region":true,"id":true,"insight_selector":[],"s3_bucket_name":true,"sns_topic_arn":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"advanced_event_selector":[],"event_selector":[{"data_resource":[]}],"insight_selector":[],"tags_all":{}}}},{"address":"aws_dynamodb_table.terraform_locks","mode":"managed","type":"aws_dynamodb_table","name":"terraform_locks","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"attribute":[{"name":"LockID","type":"S"}],"billing_mode":"PAY_PER_REQUEST","deletion_protection_enabled":null,"global_secondary_index":[],"hash_key":"LockID","import_table":[],"local_secondary_index":[],"name":"terraform-locks","on_demand_throughput":[],"point_in_time_recovery":[{"enabled":true}],"range_key":null,"replica":[],"restore_date_time":null,"restore_source_name":null,"restore_source_table_arn":null,"restore_to_latest_time":null,"stream_enabled":null,"table_class":null,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"},"timeouts":null},"after_unknown":{"arn":true,"attribute":[{}],"global_secondary_index":[],"id":true,"import_table":[],"local_secondary_index":[],"on_demand_throughput":[],"point_in_time_recovery":[{"recovery_period_in_days":true}],"read_capacity":true,"replica":[],"server_side_encryption":true,"stream_arn":true,"stream_label":true,"stream_view_type":true,"tags_all":{},"ttl":true,"write_capacity":true},"before_sensitive":false,"after_sensitive":{"attribute":[{}],"global_secondary_index":[],"import_table":[],"local_secondary_index":[],"on_demand_throughput":[],"point_in_time_recovery":[{}],"replica":[],"server_side_encryption":[],"tags_all":{},"ttl":[]}}},{"address":"aws_iam_openid_connect_provider.github","mode":"managed","type":"aws_iam_openid_connect_provider","name":"github","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"client_id_list":["sts.amazonaws.com"],"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"},"thumbprint_list":["6938fd4d98bab03faadb97b34396831e3780aea1"],"url":"https://token.actions.githubusercontent.com"},"after_unknown":{"arn":true,"client_id_list":[false],"id":true,"tags_all":{},"thumbprint_list":[false]},"before_sensitive":false,"after_sensitive":{"client_id_list":[false],"tags_all":{},"thumbprint_list":[false]}}},{"address":"aws_iam_policy.terraform_state_access","mode":"managed","type":"aws_iam_policy","name":"terraform_state_access","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"name":"iac-platform-dev-terraform-state-access","path":"/","tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"}},"after_unknown":{"arn":true,"attachment_count":true,"id":true,"name_prefix":true,"policy":true,"policy_id":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_iam_role.terraform_apply","mode":"managed","type":"aws_iam_role","name":"terraform_apply","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"terraform-apply-role","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"}},"after_unknown":{"arn":true,"assume_role_policy":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}}},{"address":"aws_iam_role.terraform_plan","mode":"managed","type":"aws_iam_role","name":"terraform_plan","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"terraform-plan-role","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"}},"after_unknown":{"arn":true,"assume_role_policy":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}}},{"address":"aws_iam_role_policy_attachment.apply_state","mode":"managed","type":"aws_iam_role_policy_attachment","name":"apply_state","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"terraform-apply-role"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_iam_role_policy_attachment.plan_state","mode":"managed","type":"aws_iam_role_policy_attachment","name":"plan_state","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"terraform-plan-role"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_kms_alias.tfstate","mode":"managed","type":"aws_kms_alias","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"alias/iac-platform-dev-tfstate"},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"target_key_arn":true,"target_key_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_kms_key.tfstate","mode":"managed","type":"aws_kms_key","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bypass_policy_lockout_safety_check":false,"custom_key_store_id":null,"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":30,"description":"KMS key for Terraform remote state encryption (S3 SSE-KMS)","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"},"timeouts":null,"xks_key_id":null},"after_unknown":{"arn":true,"id":true,"key_id":true,"multi_region":true,"policy":true,"rotation_period_in_days":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_s3_bucket.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"iac-platform-dev-cloudtrail-logs-000000000000","force_destroy":false,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"},"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"region":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags_all":{},"versioning":[],"website":[]}}},{"address":"aws_s3_bucket.tfstate","mode":"managed","type":"aws_s3_bucket","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"ai-tf","force_destroy":false,"tags":null,"tags_all":{"Env":"dev","ManagedBy":"Terraform","Project":"iac-platform"},"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"region":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags_all":{},"versioning":[],"website":[]}}},{"address":"aws_s3_bucket_ownership_controls.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_ownership_controls","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"rule":[{"object_ownership":"BucketOwnerEnforced"}]},"after_unknown":{"bucket":true,"id":true,"rule":[{}]},"before_sensitive":false,"after_sensitive":{"rule":[{}]}}},{"address":"aws_s3_bucket_ownership_controls.tfstate","mode":"managed","type":"aws_s3_bucket_ownership_controls","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"rule":[{"object_ownership":"BucketOwnerEnforced"}]},"after_unknown":{"bucket":true,"id":true,"rule":[{}]},"before_sensitive":false,"after_sensitive":{"rule":[{}]}}},{"address":"aws_s3_bucket_policy.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_policy","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{},"after_unknown":{"bucket":true,"id":true,"policy":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_policy.tfstate","mode":"managed","type":"aws_s3_bucket_policy","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{},"after_unknown":{"bucket":true,"id":true,"policy":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_public_access_block.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_public_access_block.tfstate","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_server_side_encryption_configuration.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"bucket_key_enabled":null}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{}]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}},{"address":"aws_s3_bucket_server_side_encryption_configuration.tfstate","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":null}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":true}]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}},{"address":"aws_s3_bucket_versioning.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_versioning","name":"cloudtrail_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"mfa":null,"versioning_configuration":[{"status":"Enabled"}]},"after_unknown":{"bucket":true,"id":true,"versioning_configuration":[{"mfa_delete":true}]},"before_sensitive":false,"after_sensitive":{"versioning_configuration":[{}]}}},{"address":"aws_s3_bucket_versioning.tfstate","mode":"managed","type":"aws_s3_bucket_versioning","name":"tfstate","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"mfa":null,"versioning_configuration":[{"status":"Enabled"}]},"after_unknown":{"bucket":true,"id":true,"versioning_configuration":[{"mfa_delete":true}]},"before_sensitive":false,"after_sensitive":{"versioning_configuration":[{}]}}}],"output_changes":{"cloudtrail_s3_bucket_name":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"github_oidc_provider_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"terraform_apply_role_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"terraform_lock_table_name":{"actions":["create"],"before":null,"after":"terraform-locks","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"terraform_plan_role_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"tfstate_bucket_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"tfstate_bucket_name":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"tfstate_kms_key_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.13.5","values":{"outputs":{"terraform_lock_table_name":{"sensitive":false,"value":"terraform-locks","type":"string"}},"root_module":{"resources":[{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"000000000000","arn":"arn:aws:iam::000000000000:root","id":"000000000000","user_id":"AKIAIOSFODNN7EXAMPLE"},"sensitive_values":{}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"~\u003e 5.0","expressions":{"default_tags":[{"tags":{"references":["var.project","var.environment","var.tags"]}}],"region":{"references":["var.aws_region"]}}}},"root_module":{"outputs":{"cloudtrail_s3_bucket_name":{"expression":{"references":["aws_s3_bucket.cloudtrail_logs.id","aws_s3_bucket.cloudtrail_logs"]},"description":"S3 bucket name where CloudTrail logs are delivered."},"github_oidc_provider_arn":{"expression":{"references":["aws_iam_openid_connect_provider.github.arn","aws_iam_openid_connect_provider.github"]},"description":"ARN of the GitHub Actions OIDC provider in IAM."},"terraform_apply_role_arn":{"expression":{"references":["aws_iam_role.terraform_apply.arn","aws_iam_role.terraform_apply"]},"description":"ARN of the GitHub Actions Terraform apply role."},"terraform_lock_table_name":{"expression":{"references":["aws_dynamodb_table.terraform_locks.name","aws_dynamodb_table.terraform_locks"]},"description":"DynamoDB table name used for Terraform state locking."},"terraform_plan_role_arn":{"expression":{"references":["aws_iam_role.terraform_plan.arn","aws_iam_role.terraform_plan"]},"description":"ARN of the GitHub Actions Terraform plan role."},"tfstate_bucket_arn":{"expression":{"references":["aws_s3_bucket.tfstate.arn","aws_s3_bucket.tfstate"]},"description":"Terraform remote state S3 bucket ARN."},"tfstate_bucket_name":{"expression":{"references":["aws_s3_bucket.tfstate.id","aws_s3_bucket.tfstate"]},"description":"Terraform remote state S3 bucket name."},"tfstate_kms_key_arn":{"expression":{"references":["aws_kms_key.tfstate.arn","aws_kms_key.tfstate"]},"description":"KMS key ARN used for S3 SSE-KMS encryption of tfstate."}},"resources":[{"address":"aws_cloudtrail.main","mode":"managed","type":"aws_cloudtrail","name":"main","provider_config_key":"aws","expressions":{"enable_logging":{"constant_value":true},"event_selector":[{"include_management_events":{"constant_value":true},"read_write_type":{"constant_value":"All"}}],"include_global_service_events":{"constant_value":true},"is_multi_region_trail":{"constant_value":true},"name":{"references":["local.name_prefix"]},"s3_bucket_name":{"references":["aws_s3_bucket.cloudtrail_logs.id","aws_s3_bucket.cloudtrail_logs"]}},"schema_version":1,"depends_on":["aws_s3_bucket_policy.cloudtrail_logs"]},{"address":"aws_dynamodb_table.terraform_locks","mode":"managed","type":"aws_dynamodb_table","name":"terraform_locks","provider_config_key":"aws","expressions":{"attribute":[{"name":{"constant_value":"LockID"},"type":{"constant_value":"S"}}],"billing_mode":{"constant_value":"PAY_PER_REQUEST"},"hash_key":{"constant_value":"LockID"},"name":{"references":["var.lock_table_name"]},"point_in_time_recovery":[{"enabled":{"constant_value":true}}]},"schema_version":1},{"address":"aws_iam_openid_connect_provider.github","mode":"managed","type":"aws_iam_openid_connect_provider","name":"github","provider_config_key":"aws","expressions":{"client_id_list":{"references":["var.github_oidc_audience"]},"thumbprint_list":{"references":["var.github_oidc_thumbprints"]},"url":{"constant_value":"https://token.actions.githubusercontent.com"}},"schema_version":0},{"address":"aws_iam_policy.terraform_state_access","mode":"managed","type":"aws_iam_policy","name":"terraform_state_access","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"policy":{"references":["data.aws_iam_policy_document.terraform_state_access.json","data.aws_iam_policy_document.terraform_state_access"]}},"schema_version":0},{"address":"aws_iam_role.terraform_apply","mode":"managed","type":"aws_iam_role","name":"terraform_apply","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.github_assume_apply.json","data.aws_iam_policy_document.github_assume_apply"]},"name":{"references":["var.apply_role_name"]}},"schema_version":0},{"address":"aws_iam_role.terraform_plan","mode":"managed","type":"aws_iam_role","name":"terraform_plan","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.github_assume_plan.json","data.aws_iam_policy_document.github_assume_plan"]},"name":{"references":["var.plan_role_name"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.apply_state","mode":"managed","type":"aws_iam_role_policy_attachment","name":"apply_state","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.terraform_state_access.arn","aws_iam_policy.terraform_state_access"]},"role":{"references":["aws_iam_role.terraform_apply.name","aws_iam_role.terraform_apply"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.plan_state","mode":"managed","type":"aws_iam_role_policy_attachment","name":"plan_state","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.terraform_state_access.arn","aws_iam_policy.terraform_state_access"]},"role":{"references":["aws_iam_role.terraform_plan.name","aws_iam_role.terraform_plan"]}},"schema_version":0},{"address":"aws_kms_alias.tfstate","mode":"managed","type":"aws_kms_alias","name":"tfstate","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"target_key_id":{"references":["aws_kms_key.tfstate.key_id","aws_kms_key.tfstate"]}},"schema_version":0},{"address":"aws_kms_key.tfstate","mode":"managed","type":"aws_kms_key","name":"tfstate","provider_config_key":"aws","expressions":{"deletion_window_in_days":{"constant_value":30},"description":{"constant_value":"KMS key for Terraform remote state encryption (S3 SSE-KMS)"},"enable_key_rotation":{"constant_value":true},"policy":{"references":["data.aws_iam_policy_document.kms_tfstate.json","data.aws_iam_policy_document.kms_tfstate"]}},"schema_version":0},{"address":"aws_s3_bucket.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket","name":"cloudtrail_logs","provider_config_key":"aws","expressions":{"bucket":{"references":["local.name_prefix","data.aws_caller_identity.current.account_id","data.aws_caller_identity.current"]}},"schema_version":0},{"address":"aws_s3_bucket.tfstate","mode":"managed","type":"aws_s3_bucket","name":"tfstate","provider_config_key":"aws","expressions":{"bucket":{"references":["var.state_bucket_name"]},"force_destroy":{"references":["var.state_bucket_force_destroy"]}},"schema_version":0},{"address":"aws_s3_bucket_ownership_controls.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_ownership_controls","name":"cloudtrail_logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.cloudtrail_logs.id","aws_s3_bucket.cloudtrail_logs"]},"rule":[{"object_ownership":{"constant_value":"BucketOwnerEnforced"}}]},"schema_version":0},{"address":"aws_s3_bucket_ownership_controls.tfstate","mode":"managed","type":"aws_s3_bucket_ownership_controls","name":"tfstate","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.tfstate.id","aws_s3_bucket.tfstate"]},"rule":[{"object_ownership":{"constant_value":"BucketOwnerEnforced"}}]},"schema_version":0},{"address":"aws_s3_bucket_policy.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_policy","name":"cloudtrail_logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.cloudtrail_logs.id","aws_s3_bucket.cloudtrail_logs"]},"policy":{"references":["data.aws_iam_policy_document.cloudtrail_bucket.json","data.aws_iam_policy_document.cloudtrail_bucket"]}},"schema_version":0},{"address":"aws_s3_bucket_policy.tfstate","mode":"managed","type":"aws_s3_bucket_policy","name":"tfstate","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.tfstate.id","aws_s3_bucket.tfstate"]},"policy":{"references":["data.aws_iam_policy_document.tfstate_bucket.json","data.aws_iam_policy_document.tfstate_bucket"]}},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"cloudtrail_logs","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.cloudtrail_logs.id","aws_s3_bucket.cloudtrail_logs"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.tfstate","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"tfstate","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.tfstate.id","aws_s3_bucket.tfstate"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"cloudtrail_logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.cloudtrail_logs.id","aws_s3_bucket.cloudtrail_logs"]},"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":{"constant_value":"AES256"}}]}]},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.tfstate","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"tfstate","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.tfstate.id","aws_s3_bucket.tfstate"]},"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":{"references":["aws_kms_key.tfstate.arn","aws_kms_key.tfstate"]},"sse_algorithm":{"constant_value":"aws:kms"}}]}]},"schema_version":0},{"address":"aws_s3_bucket_versioning.cloudtrail_logs","mode":"managed","type":"aws_s3_bucket_versioning","name":"cloudtrail_logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.cloudtrail_logs.id","aws_s3_bucket.cloudtrail_logs"]},"versioning_configuration":[{"status":{"constant_value":"Enabled"}}]},"schema_version":0},{"address":"aws_s3_bucket_versioning.tfstate","mode":"managed","type":"aws_s3_bucket_versioning","name":"tfstate","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.tfstate.id","aws_s3_bucket.tfstate"]},"versioning_configuration":[{"status":{"constant_value":"Enabled"}}]},"schema_version":0},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"aws","schema_version":0},{"address":"data.aws_iam_policy_document.cloudtrail_bucket","mode":"data","type":"aws_iam_policy_document","name":"cloudtrail_bucket","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["s3:GetBucketAcl"]},"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"constant_value":["cloudtrail.amazonaws.com"]},"type":{"constant_value":"Service"}}],"resources":{"references":["aws_s3_bucket.cloudtrail_logs.arn","aws_s3_bucket.cloudtrail_logs"]},"sid":{"constant_value":"AWSCloudTrailAclCheck"}},{"actions":{"constant_value":["s3:PutObject"]},"condition":[{"test":{"constant_value":"StringEquals"},"values":{"constant_value":["bucket-owner-full-control"]},"variable":{"constant_value":"s3:x-amz-acl"}}],"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"constant_value":["cloudtrail.amazonaws.com"]},"type":{"constant_value":"Service"}}],"resources":{"references":["aws_s3_bucket.cloudtrail_logs.arn","aws_s3_bucket.cloudtrail_logs","data.aws_caller_identity.current.account_id","data.aws_caller_identity.current"]},"sid":{"constant_value":"AWSCloudTrailWrite"}},{"actions":{"constant_value":["s3:*"]},"condition":[{"test":{"constant_value":"Bool"},"values":{"constant_value":["false"]},"variable":{"constant_value":"aws:SecureTransport"}}],"effect":{"constant_value":"Deny"},"principals":[{"identifiers":{"constant_value":["*"]},"type":{"constant_value":"*"}}],"resources":{"references":["aws_s3_bucket.cloudtrail_logs.arn","aws_s3_bucket.cloudtrail_logs","aws_s3_bucket.cloudtrail_logs.arn","aws_s3_bucket.cloudtrail_logs"]},"sid":{"constant_value":"DenyInsecureTransport"}}]},"schema_version":0},{"address":"data.aws_iam_policy_document.github_assume_apply","mode":"data","type":"aws_iam_policy_document","name":"github_assume_apply","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRoleWithWebIdentity"]},"condition":[{"test":{"constant_value":"StringEquals"},"values":{"references":["var.github_oidc_audience"]},"variable":{"constant_value":"token.actions.githubusercontent.com:aud"}},{"test":{"constant_value":"StringLike"},"values":{"references":["local.apply_branch_subs"]},"variable":{"constant_value":"token.actions.githubusercontent.com:sub"}}],"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"references":["aws_iam_openid_connect_provider.github.arn","aws_iam_openid_connect_provider.github"]},"type":{"constant_value":"Federated"}}]}]},"schema_version":0},{"address":"data.aws_iam_policy_document.github_assume_plan","mode":"data","type":"aws_iam_policy_document","name":"github_assume_plan","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRoleWithWebIdentity"]},"condition":[{"test":{"constant_value":"StringEquals"},"values":{"references":["var.github_oidc_audience"]},"variable":{"constant_value":"token.actions.githubusercontent.com:aud"}},{"test":{"constant_value":"StringLike"},"values":{"references":["local.github_repo_sub"]},"variable":{"constant_value":"token.actions.githubusercontent.com:sub"}}],"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"references":["aws_iam_openid_connect_provider.github.arn","aws_iam_openid_connect_provider.github"]},"type":{"constant_value":"Federated"}}]}]},"schema_version":0},{"address":"data.aws_iam_policy_document.kms_tfstate","mode":"data","type":"aws_iam_policy_document","name":"kms_tfstate","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["kms:*"]},"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"references":["data.aws_caller_identity.current.account_id","data.aws_caller_identity.current"]},"type":{"constant_value":"AWS"}}],"resources":{"constant_value":["*"]},"sid":{"constant_value":"EnableRootPermissions"}},{"actions":{"constant_value":["kms:Encrypt","kms:Decrypt","kms:ReEncrypt*","kms:GenerateDataKey*","kms:DescribeKey"]},"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"references":["aws_iam_role.terraform_plan.arn","aws_iam_role.terraform_plan","aws_iam_role.terraform_apply.arn","aws_iam_role.terraform_apply"]},"type":{"constant_value":"AWS"}}],"resources":{"constant_value":["*"]},"sid":{"constant_value":"AllowGitHubRolesUseKey"}}]},"schema_version":0},{"address":"data.aws_iam_policy_document.terraform_state_access","mode":"data","type":"aws_iam_policy_document","name":"terraform_state_access","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["s3:ListBucket","s3:GetBucketLocation"]},"effect":{"constant_value":"Allow"},"resources":{"references":["aws_s3_bucket.tfstate.arn","aws_s3_bucket.tfstate"]},"sid":{"constant_value":"ListStateBucket"}},{"actions":{"constant_value":["s3:GetObject","s3:PutObject","s3:DeleteObject","s3:GetObjectVersion","s3:ListBucketMultipartUploads","s3:AbortMultipartUpload","s3:ListMultipartUploadParts"]},"effect":{"constant_value":"Allow"},"resources":{"references":["local.state_prefix_normalized","aws_s3_bucket.tfstate.arn","aws_s3_bucket.tfstate","aws_s3_bucket.tfstate.arn","aws_s3_bucket.tfstate","local.state_prefix_arn"]},"sid":{"constant_value":"StateObjectRW"}},{"actions":{"constant_value":["dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:PutItem","dynamodb:DeleteItem","dynamodb:UpdateItem"]},"effect":{"constant_value":"Allow"},"resources":{"references":["aws_dynamodb_table.terraform_locks.arn","aws_dynamodb_table.terraform_locks"]},"sid":{"constant_value":"DynamoDBLocking"}},{"actions":{"constant_value":["kms:Encrypt","kms:Decrypt","kms:ReEncrypt*","kms:GenerateDataKey*","kms:DescribeKey"]},"effect":{"constant_value":"Allow"},"resources":{"references":["aws_kms_key.tfstate.arn","aws_kms_key.tfstate"]},"sid":{"constant_value":"KMSForState"}}]},"schema_version":0},{"address":"data.aws_iam_policy_document.tfstate_bucket","mode":"data","type":"aws_iam_policy_document","name":"tfstate_bucket","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["s3:*"]},"condition":[{"test":{"constant_value":"Bool"},"values":{"constant_value":["false"]},"variable":{"constant_value":"aws:SecureTransport"}}],"effect":{"constant_value":"Deny"},"principals":[{"identifiers":{"constant_value":["*"]},"type":{"constant_value":"*"}}],"resources":{"references":["aws_s3_bucket.tfstate.arn","aws_s3_bucket.tfstate","aws_s3_bucket.tfstate.arn","aws_s3_bucket.tfstate"]},"sid":{"constant_value":"DenyInsecureTransport"}}]},"schema_version":0}],"variables":{"apply_role_allowed_branches":{"default":["refs/heads/main"],"description":"Branches allowed to assume the apply role. Use refs/heads/\u003cbranch\u003e."},"apply_role_name":{"default":"terraform-apply-role","description":"IAM role name for GitHub Actions apply (write) operations."},"aws_region":{"default":"us-east-1","description":"AWS region to deploy into."},"environment":{"default":"dev","description":"Environment name (e.g., dev, stage, prod)."},"github_oidc_audience":{"default":"sts.amazonaws.com","description":"OIDC audience for GitHub Actions. Typically sts.amazonaws.com."},"github_oidc_thumbprints":{"default":["6938fd4d98bab03faadb97b34396831e3780aea1"],"description":"Thumbprints for GitHub Actions OIDC provider. Leave default unless you have a specific requirement."},"github_org":{"description":"GitHub organization or user that owns the repository."},"github_repo":{"description":"GitHub repository name (without org)."},"lock_table_name":{"default":"terraform-locks","description":"DynamoDB table name for Terraform state locking."},"plan_role_name":{"default":"terraform-plan-role","description":"IAM role name for GitHub Actions plan (read-only-ish) operations."},"project":{"default":"iac-platform","description":"Project/name prefix used for tagging and resource naming."},"state_bucket_force_destroy":{"default":false,"description":"If true, allow Terraform to delete the state bucket even if it contains objects (DANGEROUS)."},"state_bucket_key_prefix":{"default":"","description":"Optional prefix within the state bucket to scope access (e.g., live/)."},"state_bucket_name":{"description":"S3 bucket name for Terraform remote state (e.g., \u003cprofile\u003e-terraform-state). Must be globally unique."},"tags":{"default":{},"description":"Additional tags to apply to all resources."}}}},"relevant_attributes":[{"resource":"data.aws_iam_policy_document.tfstate_bucket","attribute":["json"]},{"resource":"data.aws_iam_policy_document.cloudtrail_bucket","attribute":["json"]},{"resource":"aws_iam_role.terraform_apply","attribute":["name"]},{"resource":"aws_kms_key.tfstate","attribute":["arn"]},{"resource":"data.aws_caller_identity.current","attribute":["account_id"]},{"resource":"data.aws_iam_policy_document.github_assume_apply","attribute":["json"]},{"resource":"aws_iam_openid_connect_provider.github","attribute":["arn"]},{"resource":"data.aws_iam_policy_document.kms_tfstate","attribute":["json"]},{"resource":"aws_dynamodb_table.terraform_locks","attribute":["arn"]},{"resource":"data.aws_iam_policy_document.github_assume_plan","attribute":["json"]},{"resource":"aws_s3_bucket.cloudtrail_logs","attribute":["arn"]},{"resource":"aws_s3_bucket.tfstate","attribute":["arn"]},{"resource":"data.aws_iam_policy_document.terraform_state_access","attribute":["json"]},{"resource":"aws_iam_role.terraform_apply","attribute":["arn"]},{"resource":"aws_iam_role.terraform_plan","attribute":["arn"]},{"resource":"aws_s3_bucket.tfstate","attribute":["id"]},{"resource":"aws_dynamodb_table.terraform_locks","attribute":["name"]},{"resource":"aws_iam_policy.terraform_state_access","attribute":["arn"]},{"resource":"aws_s3_bucket.cloudtrail_logs","attribute":["id"]},{"resource":"aws_iam_role.terraform_plan","attribute":["name"]},{"resource":"aws_kms_key.tfstate","attribute":["key_id"]}],"timestamp":"2026-01-26T21:35:25Z","applyable":true,"complete":true,"errored":false}
