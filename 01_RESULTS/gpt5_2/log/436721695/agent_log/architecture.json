{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\nskinparam shadowing false\nskinparam componentStyle rectangle\nskinparam wrapWidth 220\nskinparam maxMessageSize 120\n\ntitle URL Shortener (Flask) - High Level Deployment\n\nactor \"End User / Client\" as user\n\nnode \"Compute Instance / VM\\n(Linux)\" as vm {\n  artifact \"systemd service\\nflask.service\" as systemd\n  node \"Application Runtime\" as runtime {\n    component \"Flask Web App\\n(Python, Flask)\" as webapp\n    component \"ORM & Migrations\\n(Flask-SQLAlchemy, Flask-Migrate)\" as orm\n  }\n  database \"SQLite DB File\\n/opt/url-shortener/test.db\" as sqlite\n  artifact \"Config / Env Vars\\nSECRET_KEY, SQLALCHEMY_DATABASE_URI, DEBUG\" as config\n}\n\nnode \"Deployment Automation\" as deploy {\n  component \"Ansible Playbook\\nansible/playbooks/install-app.yml\" as ansible\n  artifact \"Dockerfile\\n(optional container build)\" as dockerfile\n}\n\nuser --> webapp : HTTP(S)\nwebapp --> orm : uses\norm --> sqlite : read/write\nwebapp ..> config : loads\n\nansible --> vm : provision & deploy\nansible --> systemd : install/enable/start\nansible --> config : template/set\nansible --> sqlite : initdb.py / migrations\n\nnote right of sqlite\nDefault: SQLite file on VM.\nCan be replaced by external RDBMS\nvia SQLALCHEMY_DATABASE_URI.\nend note\n\n@enduml",
  "svg_diagram": "",
  "architecture_description": "## High-level architecture (deployment view)\n\n### Components\n- **Client (End User / API Consumer)**\n  - Sends HTTP/HTTPS requests to the application.\n\n- **Compute Instance / VM (Linux)**\n  - **Flask Web App (Python, Flask)**: Serves the URL shortener web UI / HTTP API (routes in `app/routes.py`).\n  - **ORM & Migrations (Flask-SQLAlchemy, Flask-Migrate)**: Data access layer and schema migration tooling.\n  - **SQLite database file**: Default persistence is a local SQLite file (configured as `/opt/url-shortener/test.db`).\n  - **Configuration / Secrets**: Environment variables / config values such as `SECRET_KEY`, `SQLALCHEMY_DATABASE_URI`, `DEBUG`.\n  - **systemd service (`flask.service`)**: Manages the Flask app process lifecycle (start/stop/restart, enable on boot).\n\n- **Deployment Automation**\n  - **Ansible playbook (`ansible/playbooks/install-app.yml`)**: Provisions the VM, installs dependencies, deploys the app, configures systemd, and can initialize the database (e.g., via `initdb.py` / migrations).\n  - **Dockerfile (optional)**: Present for container image builds, but the primary deployment implied by the repo is VM + systemd + Ansible.\n\n### Key relationships / flows\n- Client → **Flask Web App** over **HTTP(S)**.\n- Flask Web App → **SQLAlchemy ORM** for persistence operations.\n- ORM → **SQLite DB file** for reads/writes.\n- Flask Web App → **Config/Env** for secrets and runtime configuration.\n- **Ansible** → VM/systemd/config/db initialization for automated deployment.\n\n### Notes\n- While SQLite is the default, the app supports switching to an external RDBMS by setting `SQLALCHEMY_DATABASE_URI` (e.g., PostgreSQL/MySQL) without changing the application architecture—only the database deployment target changes.\n\n---\n\n## SVG\nThe PlantUML-to-SVG conversion tool returned an error without details (no line number/message), so an SVG could not be generated in this run."
}