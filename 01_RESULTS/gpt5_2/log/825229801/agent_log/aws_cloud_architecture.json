{
  "aws_architecture_description": "## Proposed high-level AWS architecture (lean, secure, scalable)\n\n### 1) Runtime / Production path (EKS)\n**Goal:** Keep your current deployment model (Nginx container + Kubernetes manifests) but make it “AWS-native” and production-ready.\n\n1. **Networking (VPC across 2+ AZs)**\n   - Create a dedicated **VPC** spanning **at least two Availability Zones**.\n   - Use **public subnets** for internet-facing load balancers.\n   - Use **private subnets** for EKS worker nodes and Pods; outbound internet access goes through **NAT Gateway(s)**.\n   - This matches EKS best practices: nodes in private subnets, load balancers in public subnets. ([docs.aws.amazon.com](https://docs.aws.amazon.com/eks/latest/best-practices/subnets.html?utm_source=openai))\n\n2. **Amazon EKS cluster**\n   - Provision an **EKS control plane**.\n   - Add an **EKS Managed Node Group** (EC2) in private subnets (simple and cost-effective for this workload).\n   - Deploy your existing Kubernetes objects:\n     - `Deployment` with **2 replicas** running the `nginx:alpine`-based image.\n     - `Service` to expose the app.\n\n3. **Ingress / Load Balancing (recommended adjustment)**\n   Your repo currently uses a `Service: LoadBalancer` with an annotation implying ALB. In AWS, the cleanest/most common pattern is:\n   - Use **AWS Load Balancer Controller** to provision an **Application Load Balancer (ALB)** from a **Kubernetes Ingress** (HTTP/HTTPS routing, TLS, host/path rules). AWS recommends using the AWS Load Balancer Controller for Service/Ingress reconciliation rather than the legacy service controller. ([docs.aws.amazon.com](https://docs.aws.amazon.com/eks/latest/best-practices/load-balancing.html?utm_source=openai))\n\n   **Traffic flow:**\n   End user → Route 53 (optional) → ALB (HTTPS) → Kubernetes Ingress → Service (ClusterIP/NodePort) → Nginx Pods.\n\n   Notes:\n   - If you truly want to keep `Service type: LoadBalancer`, AWS can provision NLB/CLB depending on controller/mode/annotations; but for a static web app, **ALB + Ingress** is typically the best fit.\n\n4. **TLS and DNS**\n   - Use **ACM** to issue/renew TLS certs.\n   - Use **Route 53** to map a domain (e.g., `game.example.com`) to the ALB.\n\n5. **Container registry strategy (recommended)**\n   Today you push to Docker Hub. For AWS deployments, you have two good options:\n   - **Option A (best):** Push images to **Amazon ECR** and pull from ECR in EKS.\n   - **Option B (minimal change):** Keep Docker Hub as the source, but configure **ECR Pull Through Cache** for Docker Hub to reduce external dependency and improve reliability/performance. ([aws.amazon.com](https://aws.amazon.com/about-aws/whats-new/2023/11/amazon-ecr-pull-through-cache-additional-upstream-registries/?utm_source=openai))\n\n6. **IAM and cluster add-ons**\n   - Enable **IRSA (IAM Roles for Service Accounts)** so Kubernetes service accounts can securely call AWS APIs without node-wide credentials. ([docs.aws.amazon.com](https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html?utm_source=openai))\n   - Use IRSA for the **AWS Load Balancer Controller** (and any future add-ons).\n\n7. **Observability and security**\n   - **CloudWatch Logs** for EKS control plane logs and container logs (via Fluent Bit add-on).\n   - **CloudWatch Container Insights** (optional) for metrics.\n   - **AWS WAF** on the ALB (optional but recommended if internet-facing) for basic L7 protection.\n   - **Security Groups** tightly scoped:\n     - ALB SG: allow 443/80 from the internet.\n     - Node SG: allow only required traffic from ALB to NodePorts / Pod networking.\n\n\n### 2) CI/CD on AWS (optional, but clean consolidation)\nYou can keep GitHub Actions + Jenkins as-is. If you want AWS-managed CI/CD:\n- **CodeBuild** to build and scan images.\n- **CodePipeline** to orchestrate build → deploy.\n- Deploy step uses `kubectl` (via CodeBuild) or GitOps (Argo CD) later.\n\nGiven your current setup already works, the lean approach is:\n- Keep Jenkins/GitHub Actions, but switch registry to **ECR** (or ECR pull-through cache) and deploy to EKS.\n\n\n## Key implementation notes (to align with AWS behavior)\n- Prefer **Ingress + AWS Load Balancer Controller** for ALB provisioning and HTTP routing. ([docs.aws.amazon.com](https://docs.aws.amazon.com/eks/latest/best-practices/load-balancing.html?utm_source=openai))\n- Place **nodes in private subnets** and **load balancers in public subnets**. ([docs.aws.amazon.com](https://docs.aws.amazon.com/eks/latest/best-practices/subnets.html?utm_source=openai))\n- Use **IRSA** for controller permissions and future AWS integrations. ([docs.aws.amazon.com](https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html?utm_source=openai))\n- Consider **ECR pull-through cache** if you must keep Docker Hub as the upstream. ([aws.amazon.com](https://aws.amazon.com/about-aws/whats-new/2023/11/amazon-ecr-pull-through-cache-additional-upstream-registries/?utm_source=openai))",
  "aws_resources": [
    "VPC",
    "Public subnets (2+ AZs)",
    "Private subnets (2+ AZs)",
    "Internet Gateway (IGW)",
    "NAT Gateway (1 per AZ recommended)",
    "Elastic IPs (for NAT Gateways)",
    "Route tables (public/private)",
    "VPC endpoints (recommended): ECR (api + dkr), S3 gateway endpoint, CloudWatch Logs endpoint (optional)",
    "Security Groups (ALB SG, EKS node SG, control plane rules as needed)",
    "Network ACLs (optional; default acceptable for lean setup)",
    "Amazon EKS Cluster (control plane)",
    "EKS Managed Node Group (EC2)",
    "EKS Add-ons: VPC CNI, CoreDNS, kube-proxy",
    "EKS Add-on: Amazon EKS Pod Identity Agent or IRSA prerequisites (OIDC provider)",
    "IAM OIDC Provider for the EKS cluster (for IRSA)",
    "IAM roles: EKS cluster role, node group role",
    "IAM roles for service accounts (IRSA) for: AWS Load Balancer Controller (and logging agent if used)",
    "AWS Load Balancer Controller (Helm deployment into cluster)",
    "Application Load Balancer (provisioned by controller)",
    "ALB Target Group(s) (provisioned by controller)",
    "ALB Listener(s) (80/443) (provisioned by controller)",
    "AWS Certificate Manager (ACM) certificate (for HTTPS)",
    "Amazon Route 53 Hosted Zone + DNS record (A/AAAA alias to ALB)",
    "Amazon ECR repository (if migrating from Docker Hub)",
    "(Alternative) Amazon ECR Pull Through Cache rule for Docker Hub + AWS Secrets Manager secret for Docker Hub credentials",
    "CloudWatch Log Groups (EKS control plane logs; application logs if shipped)",
    "CloudWatch Container Insights (optional)",
    "AWS WAFv2 Web ACL associated to ALB (optional but recommended for public endpoint)",
    "AWS KMS key (optional; for EKS secrets encryption and/or ECR encryption)",
    "AWS Systems Manager Parameter Store or Secrets Manager (for any future app/config secrets)"
  ]
}