{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\nnode \"AWS EC2 Instance\\n(amazon-linux)\" as ec2 {\n  node \"nginx Web Server\" as nginx {\n    artifact \"php-fpm\\n(PHP 8.2)\" as phpfpm\n  }\n}\n\nnode \"Docker Container\" as docker {\n  artifact \"Terraform CLI\\n(hashicorp/terraform:1.4.5)\" as terraform\n}\n\nartifact \"SSH Key\\n(my-net-keypair.id_rsa)\" as sshkey\n\nnginx --> phpfpm : Forwards HTTP requests\nterraform --> ec2 : Provisions\nsshkey --> ec2 : SSH Access\n\ndocker --> terraform : Runs\n\nekec2 -[hidden]-> docker\n@enduml",
  "svg_diagram": "<?plantuml 1.2026.1beta5?><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" contentStyleType=\"text/css\" data-diagram-type=\"DESCRIPTION\" height=\"672px\" preserveAspectRatio=\"none\" style=\"width:628px;height:672px;background:#FFFFFF;\" version=\"1.1\" viewBox=\"0 0 628 672\" width=\"628px\" zoomAndPan=\"magnify\"><defs/><g><!--cluster ec2--><g class=\"cluster\" data-qualified-name=\"ec2\" data-source-line=\"4\" id=\"ent0002\"><polygon fill=\"#FFFFFF\" points=\"16,358.32,26,348.32,320,348.32,320,645.63,310,655.63,16,655.63,16,358.32\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"310\" x2=\"320\" y1=\"358.32\" y2=\"348.32\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"16\" x2=\"310\" y1=\"358.32\" y2=\"358.32\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"310\" x2=\"310\" y1=\"358.32\" y2=\"655.63\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"143.0967\" x=\"92.4517\" y=\"374.3151\">AWS EC2 Instance</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"118.3848\" x=\"104.8076\" y=\"390.612\">(amazon-linux)</text></g><!--cluster nginx--><g class=\"cluster\" data-qualified-name=\"ec2.nginx\" data-source-line=\"5\" id=\"ent0003\"><polygon fill=\"#FFFFFF\" points=\"56,438.32,66,428.32,272,428.32,272,605.63,262,615.63,56,615.63,56,438.32\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"262\" x2=\"272\" y1=\"438.32\" y2=\"428.32\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"56\" x2=\"262\" y1=\"438.32\" y2=\"438.32\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"262\" x2=\"262\" y1=\"438.32\" y2=\"615.63\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"140.499\" x=\"89.7505\" y=\"454.3151\">nginx Web Server</text></g><!--cluster docker--><g class=\"cluster\" data-qualified-name=\"docker\" data-source-line=\"10\" id=\"ent0005\"><polygon fill=\"#FFFFFF\" points=\"341,108,351,98,611,98,611,275.32,601,285.32,341,285.32,341,108\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"601\" x2=\"611\" y1=\"108\" y2=\"98\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"341\" x2=\"601\" y1=\"108\" y2=\"108\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"601\" x2=\"601\" y1=\"108\" y2=\"285.32\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"137.2861\" x=\"403.3569\" y=\"123.9951\">Docker Container</text></g><!--entity phpfpm--><g class=\"entity\" data-qualified-name=\"ec2.nginx.phpfpm\" data-source-line=\"6\" id=\"ent0004\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"95.0508\" x=\"80.47\" y=\"536.04\"/><polygon fill=\"#FFFFFF\" points=\"158.5208,541.04,158.5208,555.04,170.5208,555.04,170.5208,547.04,164.5208,541.04,158.5208,541.04\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"164.5208\" x2=\"164.5208\" y1=\"541.04\" y2=\"547.04\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"170.5208\" x2=\"164.5208\" y1=\"547.04\" y2=\"547.04\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"59.1514\" x=\"93.4197\" y=\"562.0351\">php-fpm</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"32.874\" x=\"90.47\" y=\"578.332\">(PHP</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"123.344\" y=\"578.332\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"27.7266\" x=\"127.7942\" y=\"578.332\">8.2)</text></g><!--entity terraform--><g class=\"entity\" data-qualified-name=\"docker.terraform\" data-source-line=\"11\" id=\"ent0006\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"221.4746\" x=\"365.26\" y=\"205.72\"/><polygon fill=\"#FFFFFF\" points=\"569.7346,210.72,569.7346,224.72,581.7346,224.72,581.7346,216.72,575.7346,210.72,569.7346,210.72\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"575.7346\" x2=\"575.7346\" y1=\"210.72\" y2=\"216.72\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"581.7346\" x2=\"575.7346\" y1=\"216.72\" y2=\"216.72\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"70.1436\" x=\"422.8484\" y=\"231.7151\">Terraform</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"492.9919\" y=\"231.7151\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"21.7041\" x=\"497.4421\" y=\"231.7151\">CLI</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"191.4746\" x=\"375.26\" y=\"248.012\">(hashicorp/terraform:1.4.5)</text></g><!--entity sshkey--><g class=\"entity\" data-qualified-name=\"sshkey\" data-source-line=\"14\" id=\"ent0007\"><rect fill=\"#FFFFFF\" height=\"55.5938\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"193.8984\" x=\"123.05\" y=\"205.72\"/><polygon fill=\"#FFFFFF\" points=\"299.9484,210.72,299.9484,224.72,311.9484,224.72,311.9484,216.72,305.9484,210.72,299.9484,210.72\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"305.9484\" x2=\"305.9484\" y1=\"210.72\" y2=\"216.72\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"311.9484\" x2=\"305.9484\" y1=\"216.72\" y2=\"216.72\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"28.3008\" x=\"185.5842\" y=\"231.7151\">SSH</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"213.885\" y=\"231.7151\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"26.0791\" x=\"218.3352\" y=\"231.7151\">Key</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"163.8984\" x=\"133.05\" y=\"248.012\">(my-net-keypair.id_rsa)</text></g><!--entity ekec2--><g class=\"entity\" data-qualified-name=\"ekec2\" data-source-line=\"22\" id=\"ent0012\"><ellipse cx=\"476\" cy=\"14\" fill=\"#FFFFFF\" rx=\"8\" ry=\"8\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"41.9385\" x=\"455.0308\" y=\"43.9951\">ekec2</text></g><!--link nginx to phpfpm--><g class=\"link\" data-entity-1=\"ent0003\" data-entity-2=\"ent0004\" data-link-type=\"dependency\" data-source-line=\"16\" id=\"lnk8\"><path d=\"M117.03,461.33 C117.45,465.21 121.3143,501.0148 124.4243,529.7448\" fill=\"none\" id=\"nginx-to-phpfpm\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"125.07,535.71,128.0782,526.3318,124.5319,530.739,120.1246,527.1928,125.07,535.71\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"55.1484\" x=\"123\" y=\"503.1787\">Forwards</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"178.1484\" y=\"503.1787\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"30.9199\" x=\"181.9629\" y=\"503.1787\">HTTP</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"212.8828\" y=\"503.1787\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"52.1309\" x=\"216.6973\" y=\"503.1787\">requests</text></g><!--link terraform to ec2--><g class=\"link\" data-entity-1=\"ent0006\" data-entity-2=\"ent0002\" data-link-type=\"dependency\" data-source-line=\"17\" id=\"lnk9\"><path d=\"M456.22,261.68 C434.75,291.155 399.4775,339.58 369.19,381.1613 C354.0463,401.9519 340.1488,421.0316 329.8459,435.1761 C327.2702,438.7122 324.9192,441.9399 322.8295,444.8088 C322.3071,445.526 321.801,446.2208 321.3119,446.8923 C321.0673,447.2281 320.8269,447.5581 320.5908,447.8822 C320.4728,448.0442 323.8885,443.355 323.7726,443.5141\" fill=\"none\" id=\"terraform-to-ec2\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"320.24,448.3639,328.7721,443.4442,323.1838,444.3224,322.3057,438.7341,320.24,448.3639\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"60.7324\" x=\"419\" y=\"321.4587\">Provisions</text></g><!--link sshkey to ec2--><g class=\"link\" data-entity-1=\"ent0007\" data-entity-2=\"ent0002\" data-link-type=\"dependency\" data-source-line=\"18\" id=\"lnk10\"><path d=\"M239.7,261.55 C252.74,280.54 269.34,306.98 280,332.32 C281.3925,335.6294 282.7348,339.0136 284.0277,342.4509 C284.6742,344.1696 285.3083,345.9015 285.9302,347.644 C286.008,347.8618 284.0801,342.4249 284.1575,342.643\" fill=\"none\" id=\"sshkey-to-ec2\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"286.1629,348.298,286.9247,338.4786,284.4917,343.5855,279.3848,341.1525,286.1629,348.298\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"24.2578\" x=\"278\" y=\"321.4587\">SSH</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"302.2578\" y=\"321.4587\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"41.291\" x=\"306.0723\" y=\"321.4587\">Access</text></g><!--link docker to terraform--><g class=\"link\" data-entity-1=\"ent0005\" data-entity-2=\"ent0006\" data-link-type=\"dependency\" data-source-line=\"20\" id=\"lnk11\"><path d=\"M476,131.01 C476,134.9 476,170.67 476,199.4\" fill=\"none\" id=\"docker-to-terraform\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"476,205.4,480,196.4,476,200.4,472,196.4,476,205.4\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"29.8008\" x=\"477\" y=\"172.8587\">Runs</text></g><!--link ekec2 to docker--><?plantuml-src JP7BJiCm44Nt_effLx1mKYgGK1P8g81QmIAYbLW0Ggup9LOJEtYSFa3yEvEw3rPMxhrpvf5UWGjZ4MvVfdbRLr26q52MfbwjaqyJodRU4dhjR40R4ktgLAsfKdFgNcdO8BbmNZQLie41wMeuI0PfOIY8dh6wQeiZFELtvEhQsQJXJo6iOxFFAjoFXZ2n59JL-6RFLAs-dPMLiUtcl0-A0FKGVWH0BB6VncxW1USmHRz2luj4iGi1A1_CGka0_QPivAAf6PgFSxXEXf77CgkS_HM_Xq7kd5wYXn4lg_WcaLf4iSEUe3FqNl7QDOoU9emk5PLy2z-auU1a5ybbSXMR7SMkruaodOxX4RTSNs-bnI2Nk6sKyOafFZofM4jKiimZxhQJycO_EcJmuFnQ-O9WF9lbuF6hHGeaZjrswUvm6UJUhGmP_biY0lzvtHYtMYEH4FjjE_E4oU2vvKA1owv0lfQcAD2-SoR6_m00?></g></svg>",
  "architecture_description": "This architecture represents a deployment pipeline for a PHP application using nginx and php-fpm, provisioned on AWS EC2 via Terraform, with Docker used for running Terraform commands.\n\n**Components:**\n\n1. **AWS EC2 Instance (amazon-linux):**\n   - Hosts the application stack.\n   - Runs an nginx web server and a php-fpm (PHP 8.2) application server.\n   - nginx forwards HTTP requests to php-fpm for PHP processing.\n\n2. **nginx Web Server:**\n   - Handles incoming HTTP requests.\n   - Forwards requests to php-fpm for dynamic PHP content.\n\n3. **php-fpm (PHP 8.2):**\n   - Processes PHP application logic.\n   - Runs as a service behind nginx.\n\n4. **Docker Container:**\n   - Used to run the Terraform CLI (hashicorp/terraform:1.4.5) in an isolated environment.\n   - Ensures consistent infrastructure provisioning.\n\n5. **Terraform CLI:**\n   - Provisions the AWS EC2 instance and related resources.\n   - Managed and executed within the Docker container.\n\n6. **SSH Key (my-net-keypair.id_rsa):**\n   - Used for secure SSH access to the EC2 instance.\n\n**Relationships:**\n- nginx forwards HTTP requests to php-fpm.\n- Terraform (in Docker) provisions the EC2 instance.\n- The SSH key is used to access the EC2 instance via SSH.\n- Docker runs the Terraform CLI for infrastructure management.\n\nThis setup provides a reproducible, automated infrastructure deployment for a PHP web application on AWS, leveraging Docker for IaC tooling and secure access via SSH keys."
}