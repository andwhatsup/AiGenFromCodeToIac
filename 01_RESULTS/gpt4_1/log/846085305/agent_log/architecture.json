{
  "plantuml_diagram": "@startuml\n!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v20.0/dist\n!include AWSPuml/AWSCommon.puml\n\nnode \"AWS Lambda\\n(Python, tinytuya, influxdb-client)\" as lambda {\n  artifact \"main.py\" as mainpy\n}\n\ncloud \"Tuya Cloud API\" as tuya\n\nnode \"InfluxDB\" as influxdb\n\nnode \"Grafana\" as grafana\n\nlambda --> tuya : Uses API\nlambda --> influxdb : Writes Data\ninfluxdb --> grafana : Data Source\n\n@enduml",
  "svg_diagram": "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" contentStyleType=\"text/css\" data-diagram-type=\"DESCRIPTION\" height=\"386px\" preserveAspectRatio=\"none\" style=\"width:478px;height:386px;background:#FFFFFF;\" version=\"1.1\" viewBox=\"0 0 478 386\" width=\"478px\" zoomAndPan=\"magnify\"><defs/><g><!--cluster lambda--><g class=\"cluster\" data-qualified-name=\"lambda\" data-source-line=\"4\" id=\"ent0002\"><polygon fill=\"#FFFFFF\" points=\"16,16,26,6,361,6,361,123.3,351,133.3,16,133.3,16,16\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"351\" x2=\"361\" y1=\"16\" y2=\"6\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"16\" x2=\"351\" y1=\"16\" y2=\"16\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"351\" x2=\"351\" y1=\"16\" y2=\"133.3\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"103.6807\" x=\"132.6597\" y=\"31.9951\">AWS Lambda</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" font-weight=\"bold\" lengthAdjust=\"spacing\" textLength=\"269.1855\" x=\"49.9072\" y=\"48.292\">(Python, tinytuya, influxdb-client)</text></g><!--entity mainpy--><g class=\"entity\" data-qualified-name=\"lambda.mainpy\" data-source-line=\"5\" id=\"ent0003\"><rect fill=\"#FFFFFF\" height=\"39.2969\" style=\"stroke:#7D8998;stroke-width:1.25;\" width=\"86.6016\" x=\"134.7\" y=\"70\"/><polygon fill=\"#FFFFFF\" points=\"204.3016,75,204.3016,89,216.3016,89,216.3016,81,210.3016,75,204.3016,75\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"210.3016\" x2=\"210.3016\" y1=\"75\" y2=\"81\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"216.3016\" x2=\"210.3016\" y1=\"81\" y2=\"81\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.6016\" x=\"144.7\" y=\"95.9951\">main.py</text></g><!--entity tuya--><g class=\"entity\" data-qualified-name=\"tuya\" data-source-line=\"8\" id=\"ent0004\"><path d=\"M185.5177,212.383 C188.8341,206.072 193.1628,205.706 197.6993,211.1148 C199.9788,204.6263 204.9005,205.3431 208.7927,209.4217 C212.2978,203.8245 216.0975,203.7169 220.3049,208.654 C224.833,202.7083 230.2452,202.9166 234.1663,209.3345 C237.2268,204.2755 240.582,204.1399 244.1594,208.8032 C247.675,202.5058 253.5558,202.0697 257.736,208.0695 C262.6609,203.8743 267.2249,202.8937 269.9796,210.35 C272.4493,205.3708 276.6866,204.8164 279.9516,209.532 C283.6501,202.6665 290.3304,203.066 293.4774,210.0698 C297.2127,205.1907 303.0195,204.6755 305.4711,211.3971 C316.0756,210.8814 317.8602,218.1489 314.2261,226.1075 C319.5831,235.0397 315.0891,241.5583 305.2802,241.899 C302.4573,248.6665 295.858,249.7345 291.9035,243.0219 C290.0441,248.8936 285.4843,248.8588 281.5109,245.3686 C277.5778,251.783 272.119,252.3093 268.2975,245.2592 C266.2061,251.0172 261.0956,252.0024 256.7074,247.9812 C253.0832,255.216 249.0139,254.3734 244.0195,249.406 C240.1929,254.881 236.1443,254.1193 233.2761,248.4794 C228.5239,253.5315 224.0529,252.8293 221.04,246.5939 C217.1398,251.1539 212.1088,252.0338 209.1025,245.6215 C204.5303,249.9763 199.924,248.7873 197.2448,243.3331 C192.2147,249.1476 188.613,248.7471 185.4008,241.6637 C175.3477,241.4832 173.1604,234.6371 177.2623,226.7382 C172.102,217.4557 175.4501,212.9081 185.5177,212.383\" fill=\"#FFFFFF\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"34.2891\" x=\"191.34\" y=\"230.2951\">Tuya</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"225.6291\" y=\"230.2951\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"39.9902\" x=\"230.0793\" y=\"230.2951\">Cloud</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"4.4502\" x=\"270.0695\" y=\"230.2951\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"22.1484\" x=\"274.5197\" y=\"230.2951\">API</text></g><!--entity influxdb--><g class=\"entity\" data-qualified-name=\"influxdb\" data-source-line=\"10\" id=\"ent0005\"><polygon fill=\"#FFFFFF\" points=\"346.32,212.3,356.32,202.3,445.6833,202.3,445.6833,238.5969,435.6833,248.5969,346.32,248.5969,346.32,212.3\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"435.6833\" x2=\"445.6833\" y1=\"212.3\" y2=\"202.3\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"346.32\" x2=\"435.6833\" y1=\"212.3\" y2=\"212.3\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"435.6833\" x2=\"435.6833\" y1=\"212.3\" y2=\"248.5969\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"59.3633\" x=\"361.32\" y=\"235.2951\">InfluxDB</text></g><!--entity grafana--><g class=\"entity\" data-qualified-name=\"grafana\" data-source-line=\"12\" id=\"ent0006\"><polygon fill=\"#FFFFFF\" points=\"347.93,333.59,357.93,323.59,444.0736,323.59,444.0736,359.8869,434.0736,369.8869,347.93,369.8869,347.93,333.59\" style=\"stroke:#7D8998;stroke-width:1.25;\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"434.0736\" x2=\"444.0736\" y1=\"333.59\" y2=\"323.59\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"347.93\" x2=\"434.0736\" y1=\"333.59\" y2=\"333.59\"/><line style=\"stroke:#7D8998;stroke-width:1.25;\" x1=\"434.0736\" x2=\"434.0736\" y1=\"333.59\" y2=\"369.8869\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"14\" lengthAdjust=\"spacing\" textLength=\"56.1436\" x=\"362.93\" y=\"356.5851\">Grafana</text></g><!--link lambda to tuya--><g class=\"link\" data-entity-1=\"ent0002\" data-entity-2=\"ent0004\" data-link-type=\"dependency\" data-source-line=\"14\" id=\"lnk7\"><path d=\"M281.6533,133.3599 C281.4153,133.8236 281.1774,134.2885 280.9395,134.7544 C277.1338,142.2088 273.3525,149.9225 270,157.3 C263.38,171.86 258.9524,183.0193 254.1124,196.1693\" fill=\"none\" id=\"lambda-to-tuya\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"252.04,201.8,258.9025,194.7356,253.767,197.1077,251.3949,191.9723,252.04,201.8\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"28.6699\" x=\"271\" y=\"169.4387\">Uses</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"299.6699\" y=\"169.4387\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"18.9844\" x=\"303.4844\" y=\"169.4387\">API</text></g><!--link lambda to influxdb--><g class=\"link\" data-entity-1=\"ent0002\" data-entity-2=\"ent0005\" data-link-type=\"dependency\" data-source-line=\"15\" id=\"lnk8\"><path d=\"M334.1813,133.555 C349.69,156.3575 364.7406,178.4838 377.4156,197.1188\" fill=\"none\" id=\"lambda-to-influxdb\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"380.79,202.08,379.0358,192.3886,377.978,197.9457,372.4209,196.8879,380.79,202.08\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"38.4727\" x=\"359\" y=\"169.4387\">Writes</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"397.4727\" y=\"169.4387\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"28.6523\" x=\"401.2871\" y=\"169.4387\">Data</text></g><!--link influxdb to grafana--><g class=\"link\" data-entity-1=\"ent0005\" data-entity-2=\"ent0006\" data-link-type=\"dependency\" data-source-line=\"16\" id=\"lnk9\"><path d=\"M396,248.88 C396,270.21 396,296.11 396,317.4\" fill=\"none\" id=\"influxdb-to-grafana\" style=\"stroke:#000000;stroke-width:2;\"/><polygon fill=\"#000000\" points=\"396,323.4,400,314.4,396,318.4,392,314.4,396,323.4\" style=\"stroke:#000000;stroke-width:2;\"/><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"28.6523\" x=\"397\" y=\"290.7287\">Data</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"3.8145\" x=\"425.6523\" y=\"290.7287\">&#160;</text><text fill=\"#000000\" font-family=\"sans-serif\" font-size=\"12\" lengthAdjust=\"spacing\" textLength=\"41.4785\" x=\"429.4668\" y=\"290.7287\">Source</text></g><!--SRC=[JOxBQiCm44Nt-eg9Lot4LkWoYq8UK09T1DAIJJTZoOu5UXXfrDIK_dibDGvTpUDSpin2Thso7MpEfsCq6WQYCQmvztXjBeg6sCRGUU4iTPOQuGp7Qz3OXbnhbK2eU-VhKQEb9E2VJwjcnQKAn1RA2XtbNSvJtJbZd6t6D39cNO9Lsi8hcbRYXtquJZGukmHITg8uuHAKxNNyacqjj4e_F5Q00NJ9mpS3G4-gHq5G6LJ9F9L0xiU9_J0cj8iIghSaWrtfDyT3oMJ__CIXNDbl2vXFpl35OuyM2xlyzOpTNgZhvoA2DRo7BcJvVpIh4ZvxHIcmHq9sN-VCJPaYcS79HI-wNm00]--></g></svg>",
  "architecture_description": "This architecture represents a Python-based serverless application deployed on AWS Lambda. The Lambda function (using the tinytuya and influxdb-client libraries) interacts with the Tuya Cloud API to collect or control IoT device data. The Lambda function writes the collected data to an InfluxDB instance for time-series storage. Grafana is connected to InfluxDB to visualize and analyze the stored data. The main relationships are:\n\n- AWS Lambda (Python, tinytuya, influxdb-client): Executes the main application logic, interacts with Tuya Cloud API, and writes data to InfluxDB.\n- Tuya Cloud API: Provides IoT device data and control endpoints, accessed by the Lambda function.\n- InfluxDB: Stores time-series data received from Lambda.\n- Grafana: Connects to InfluxDB as a data source for visualization and dashboards.\n\nThis setup is suitable for IoT data collection, storage, and visualization, leveraging serverless compute and managed data services."
}