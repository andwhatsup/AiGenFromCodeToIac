{"format_version":"1.2","terraform_version":"1.13.5","variables":{"form_url":{"value":"terraform"},"region":{"value":"ca-central-1"}},"planned_values":{"root_module":{"resources":[{"address":"aws_cloudwatch_event_rule.every_15_minutes","mode":"managed","type":"aws_cloudwatch_event_rule","name":"every_15_minutes","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Trigger every 15 minutes","event_bus_name":"default","event_pattern":null,"force_destroy":false,"is_enabled":null,"name":"every-15-minutes","role_arn":null,"schedule_expression":"rate(15 minutes)","state":null,"tags":null},"sensitive_values":{"tags_all":{}}},{"address":"aws_cloudwatch_event_target.playwright_lambda","mode":"managed","type":"aws_cloudwatch_event_target","name":"playwright_lambda","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"appsync_target":[],"batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","force_destroy":false,"http_target":[],"input":"{\"url\":\"terraform\"}","input_path":null,"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"role_arn":null,"rule":"every-15-minutes","run_command_targets":[],"sagemaker_pipeline_target":[],"sqs_target":[],"target_id":"playwright-lambda"},"sensitive_values":{"appsync_target":[],"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"run_command_targets":[],"sagemaker_pipeline_target":[],"sqs_target":[]}},{"address":"aws_ecr_repository.playwright_lambda","mode":"managed","type":"aws_ecr_repository","name":"playwright_lambda","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"encryption_configuration":[],"force_delete":null,"image_scanning_configuration":[{"scan_on_push":true}],"image_tag_mutability":"MUTABLE","name":"playwright-lambda","tags":{"CostCentre":"sre","Terraform":"true"},"tags_all":{"CostCentre":"sre","Terraform":"true"},"timeouts":null},"sensitive_values":{"encryption_configuration":[],"image_scanning_configuration":[{}],"tags":{},"tags_all":{}}},{"address":"aws_lambda_permission.eventbridge","mode":"managed","type":"aws_lambda_permission","name":"eventbridge","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"playwright-lambda","function_url_auth_type":null,"principal":"events.amazonaws.com","principal_org_id":null,"qualifier":null,"source_account":null,"statement_id":"AllowExecutionFromEventBridge"},"sensitive_values":{}}],"child_modules":[{"resources":[{"address":"module.playwright_lambda.aws_cloudwatch_log_group.this","mode":"managed","type":"aws_cloudwatch_log_group","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"kms_key_id":null,"name":"/aws/lambda/playwright-lambda","retention_in_days":14,"skip_destroy":false,"tags":{"CostCentre":"sre","Terraform":"true"},"tags_all":{"CostCentre":"sre","Terraform":"true"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.playwright_lambda.aws_cloudwatch_query_definition.lambda_statistics","mode":"managed","type":"aws_cloudwatch_query_definition","name":"lambda_statistics","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_names":["/aws/lambda/playwright-lambda"],"name":"Lambda Statistics / playwright-lambda","query_string":"filter @type = “REPORT”\n| stats\ncount(@type) as countInvocations,\ncount(@initDuration) as countColdStarts, (count(@initDuration)/count(@type))*100 as percentageColdStarts,\nmax(@initDuration) as maxColdStartTime,\navg(@duration) as averageDuration,\nmax(@duration) as maxDuration,\nmin(@duration) as minDuration,\navg(@maxMemoryUsed) as averageMemoryUsed,\nmax(@memorySize) as memoryAllocated, (avg(@maxMemoryUsed)/max(@memorySize))*100 as percentageMemoryUsed\nby bin(1h) as timeFrame\n"},"sensitive_values":{"log_group_names":[false]}},{"address":"module.playwright_lambda.aws_iam_policy.non_vpc_policies[0]","mode":"managed","type":"aws_iam_policy","name":"non_vpc_policies","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"name":"playwright-lambda_non_vpc","path":"/","tags":{"CostCentre":"sre","Terraform":"true"},"tags_all":{"CostCentre":"sre","Terraform":"true"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.playwright_lambda.aws_iam_role.this","mode":"managed","type":"aws_iam_role","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"playwright-lambda","path":"/","permissions_boundary":null,"tags":{"CostCentre":"sre","Terraform":"true"},"tags_all":{"CostCentre":"sre","Terraform":"true"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}},{"address":"module.playwright_lambda.aws_iam_role_policy_attachment.lambda_insights[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_insights","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/CloudWatchLambdaInsightsExecutionRolePolicy","role":"playwright-lambda"},"sensitive_values":{}},{"address":"module.playwright_lambda.aws_iam_role_policy_attachment.non_vpc_policies[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"non_vpc_policies","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"playwright-lambda"},"sensitive_values":{}},{"address":"module.playwright_lambda.aws_lambda_function.this","mode":"managed","type":"aws_lambda_function","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"architectures":["x86_64"],"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[],"ephemeral_storage":[{"size":512}],"file_system_config":[],"filename":null,"function_name":"playwright-lambda","handler":null,"image_config":[],"kms_key_arn":null,"layers":null,"memory_size":2048,"package_type":"Image","publish":false,"replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"runtime":null,"s3_bucket":null,"s3_key":null,"s3_object_version":null,"skip_destroy":false,"snap_start":[],"tags":{"CostCentre":"sre","Terraform":"true"},"tags_all":{"CostCentre":"sre","Terraform":"true"},"timeout":300,"timeouts":null,"tracing_config":[{"mode":"PassThrough"}],"vpc_config":[{"ipv6_allowed_for_dual_stack":false,"security_group_ids":null,"subnet_ids":null}]},"sensitive_values":{"architectures":[false],"dead_letter_config":[],"environment":[],"ephemeral_storage":[{}],"file_system_config":[],"image_config":[],"logging_config":[],"snap_start":[],"tags":{},"tags_all":{},"tracing_config":[{}],"vpc_config":[{}]}},{"address":"module.playwright_lambda.data.aws_iam_policy_document.non_vpc_policies[0]","mode":"data","type":"aws_iam_policy_document","name":"non_vpc_policies","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":["*"],"sid":"CloudWatchAccess"},{"actions":["ecr:BatchGetImage","ecr:GetDownloadUrlForlayer"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"ECRImageAccess"}],"version":null},"sensitive_values":{"statement":[{"actions":[false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]}]}}],"address":"module.playwright_lambda"}]}},"resource_changes":[{"address":"aws_cloudwatch_event_rule.every_15_minutes","mode":"managed","type":"aws_cloudwatch_event_rule","name":"every_15_minutes","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Trigger every 15 minutes","event_bus_name":"default","event_pattern":null,"force_destroy":false,"is_enabled":null,"name":"every-15-minutes","role_arn":null,"schedule_expression":"rate(15 minutes)","state":null,"tags":null},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_cloudwatch_event_target.playwright_lambda","mode":"managed","type":"aws_cloudwatch_event_target","name":"playwright_lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"appsync_target":[],"batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","force_destroy":false,"http_target":[],"input":"{\"url\":\"terraform\"}","input_path":null,"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"role_arn":null,"rule":"every-15-minutes","run_command_targets":[],"sagemaker_pipeline_target":[],"sqs_target":[],"target_id":"playwright-lambda"},"after_unknown":{"appsync_target":[],"arn":true,"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"id":true,"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"run_command_targets":[],"sagemaker_pipeline_target":[],"sqs_target":[]},"before_sensitive":false,"after_sensitive":{"appsync_target":[],"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"run_command_targets":[],"sagemaker_pipeline_target":[],"sqs_target":[]}}},{"address":"aws_ecr_repository.playwright_lambda","mode":"managed","type":"aws_ecr_repository","name":"playwright_lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"encryption_configuration":[],"force_delete":null,"image_scanning_configuration":[{"scan_on_push":true}],"image_tag_mutability":"MUTABLE","name":"playwright-lambda","tags":{"CostCentre":"sre","Terraform":"true"},"tags_all":{"CostCentre":"sre","Terraform":"true"},"timeouts":null},"after_unknown":{"arn":true,"encryption_configuration":[],"id":true,"image_scanning_configuration":[{}],"registry_id":true,"repository_url":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"encryption_configuration":[],"image_scanning_configuration":[{}],"tags":{},"tags_all":{}}}},{"address":"aws_lambda_permission.eventbridge","mode":"managed","type":"aws_lambda_permission","name":"eventbridge","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"playwright-lambda","function_url_auth_type":null,"principal":"events.amazonaws.com","principal_org_id":null,"qualifier":null,"source_account":null,"statement_id":"AllowExecutionFromEventBridge"},"after_unknown":{"id":true,"source_arn":true,"statement_id_prefix":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.playwright_lambda.data.aws_iam_policy_document.non_vpc_policies[0]","module_address":"module.playwright_lambda","mode":"data","type":"aws_iam_policy_document","name":"non_vpc_policies","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":["*"],"sid":"CloudWatchAccess"},{"actions":["ecr:BatchGetImage","ecr:GetDownloadUrlForlayer"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"ECRImageAccess"}],"version":null},"after_unknown":{"id":true,"json":true,"minified_json":true,"statement":[{"actions":[false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false],"condition":[],"not_principals":[],"principals":[],"resources":[true]}]},"before_sensitive":false,"after_sensitive":{"statement":[{"actions":[false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]}]}},"action_reason":"read_because_config_unknown"},{"address":"module.playwright_lambda.aws_cloudwatch_log_group.this","module_address":"module.playwright_lambda","mode":"managed","type":"aws_cloudwatch_log_group","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"kms_key_id":null,"name":"/aws/lambda/playwright-lambda","retention_in_days":14,"skip_destroy":false,"tags":{"CostCentre":"sre","Terraform":"true"},"tags_all":{"CostCentre":"sre","Terraform":"true"}},"after_unknown":{"arn":true,"id":true,"log_group_class":true,"name_prefix":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.playwright_lambda.aws_cloudwatch_query_definition.lambda_statistics","module_address":"module.playwright_lambda","mode":"managed","type":"aws_cloudwatch_query_definition","name":"lambda_statistics","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_names":["/aws/lambda/playwright-lambda"],"name":"Lambda Statistics / playwright-lambda","query_string":"filter @type = “REPORT”\n| stats\ncount(@type) as countInvocations,\ncount(@initDuration) as countColdStarts, (count(@initDuration)/count(@type))*100 as percentageColdStarts,\nmax(@initDuration) as maxColdStartTime,\navg(@duration) as averageDuration,\nmax(@duration) as maxDuration,\nmin(@duration) as minDuration,\navg(@maxMemoryUsed) as averageMemoryUsed,\nmax(@memorySize) as memoryAllocated, (avg(@maxMemoryUsed)/max(@memorySize))*100 as percentageMemoryUsed\nby bin(1h) as timeFrame\n"},"after_unknown":{"id":true,"log_group_names":[false],"query_definition_id":true},"before_sensitive":false,"after_sensitive":{"log_group_names":[false]}}},{"address":"module.playwright_lambda.aws_iam_policy.non_vpc_policies[0]","module_address":"module.playwright_lambda","mode":"managed","type":"aws_iam_policy","name":"non_vpc_policies","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"name":"playwright-lambda_non_vpc","path":"/","tags":{"CostCentre":"sre","Terraform":"true"},"tags_all":{"CostCentre":"sre","Terraform":"true"}},"after_unknown":{"arn":true,"attachment_count":true,"id":true,"name_prefix":true,"policy":true,"policy_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.playwright_lambda.aws_iam_role.this","module_address":"module.playwright_lambda","mode":"managed","type":"aws_iam_role","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"playwright-lambda","path":"/","permissions_boundary":null,"tags":{"CostCentre":"sre","Terraform":"true"},"tags_all":{"CostCentre":"sre","Terraform":"true"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}}},{"address":"module.playwright_lambda.aws_iam_role_policy_attachment.lambda_insights[0]","module_address":"module.playwright_lambda","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_insights","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/CloudWatchLambdaInsightsExecutionRolePolicy","role":"playwright-lambda"},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.playwright_lambda.aws_iam_role_policy_attachment.non_vpc_policies[0]","module_address":"module.playwright_lambda","mode":"managed","type":"aws_iam_role_policy_attachment","name":"non_vpc_policies","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"playwright-lambda"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.playwright_lambda.aws_lambda_function.this","module_address":"module.playwright_lambda","mode":"managed","type":"aws_lambda_function","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"architectures":["x86_64"],"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[],"ephemeral_storage":[{"size":512}],"file_system_config":[],"filename":null,"function_name":"playwright-lambda","handler":null,"image_config":[],"kms_key_arn":null,"layers":null,"memory_size":2048,"package_type":"Image","publish":false,"replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"runtime":null,"s3_bucket":null,"s3_key":null,"s3_object_version":null,"skip_destroy":false,"snap_start":[],"tags":{"CostCentre":"sre","Terraform":"true"},"tags_all":{"CostCentre":"sre","Terraform":"true"},"timeout":300,"timeouts":null,"tracing_config":[{"mode":"PassThrough"}],"vpc_config":[{"ipv6_allowed_for_dual_stack":false,"security_group_ids":null,"subnet_ids":null}]},"after_unknown":{"architectures":[false],"arn":true,"code_sha256":true,"dead_letter_config":[],"environment":[],"ephemeral_storage":[{}],"file_system_config":[],"id":true,"image_config":[],"image_uri":true,"invoke_arn":true,"last_modified":true,"logging_config":true,"qualified_arn":true,"qualified_invoke_arn":true,"role":true,"signing_job_arn":true,"signing_profile_version_arn":true,"snap_start":[],"source_code_hash":true,"source_code_size":true,"tags":{},"tags_all":{},"tracing_config":[{}],"version":true,"vpc_config":[{"vpc_id":true}]},"before_sensitive":false,"after_sensitive":{"architectures":[false],"dead_letter_config":[],"environment":[],"ephemeral_storage":[{}],"file_system_config":[],"image_config":[],"logging_config":[],"snap_start":[],"tags":{},"tags_all":{},"tracing_config":[{}],"vpc_config":[{}]}}}],"prior_state":{"format_version":"1.0","terraform_version":"1.13.5","values":{"root_module":{"resources":[{"address":"data.archive_file.lambda_dummy","mode":"data","type":"archive_file","name":"lambda_dummy","provider_name":"registry.terraform.io/hashicorp/archive","schema_version":0,"values":{"exclude_symlink_directories":null,"excludes":null,"id":"58e93fade67637870be5af38eff8d5aa66c7da49","output_base64sha256":"wmbalFzzY/wG3ivChKElOZB3+B4gptmQyIat05p+fU4=","output_base64sha512":"BQYAg1LwEY4tDmry1VoRx6StX0vjH+7LpfB5KAZLVvfJQjioPbBv1QxI6QF6P2U614fU3h9XKBCb9z5Y1ornqA==","output_file_mode":null,"output_md5":"a0dbd832a6a977d6d5b28ea5c85e30fb","output_path":"./.dummy/lambda.zip","output_sha":"58e93fade67637870be5af38eff8d5aa66c7da49","output_sha256":"c266da945cf363fc06de2bc284a125399077f81e20a6d990c886add39a7e7d4e","output_sha512":"0506008352f0118e2d0e6af2d55a11c7a4ad5f4be31feecba5f07928064b56f7c94238a83db06fd50c48e9017a3f653ad787d4de1f5728109bf73e58d68ae7a8","output_size":246,"source":[{"content":"exports.handler = async (event) =\u003e {\n  console.log(\"Dummy lambda invoked\");\n  return { statusCode: 200, body: \"dummy\" };\n};\n","filename":"index.js"}],"source_content":null,"source_content_filename":null,"source_dir":null,"source_file":null,"type":"zip"},"sensitive_values":{"source":[{}]}}],"child_modules":[{"resources":[{"address":"module.playwright_lambda.data.aws_iam_policy.lambda_insights[0]","mode":"data","type":"aws_iam_policy","name":"lambda_insights","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::aws:policy/CloudWatchLambdaInsightsExecutionRolePolicy","attachment_count":0,"description":"","id":"arn:aws:iam::aws:policy/CloudWatchLambdaInsightsExecutionRolePolicy","name":"CloudWatchLambdaInsightsExecutionRolePolicy","path":"/","path_prefix":null,"policy":"{\"Statement\": [{\"Action\": \"logs:CreateLogGroup\", \"Effect\": \"Allow\", \"Resource\": \"*\"}, {\"Action\": [\"logs:CreateLogStream\", \"logs:PutLogEvents\"], \"Effect\": \"Allow\", \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/lambda-insights:*\"}], \"Version\": \"2012-10-17\"}","policy_id":"AOJ6O6QSUQJ7148PL3XF5","tags":{}},"sensitive_values":{"tags":{}}},{"address":"module.playwright_lambda.data.aws_iam_policy_document.service_principal","mode":"data","type":"aws_iam_policy_document","name":"service_principal","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"2690255455","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRole\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["lambda.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_values":{"statement":[{"actions":[false],"condition":[],"not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":[false]}],"resources":[]}]}}],"address":"module.playwright_lambda"}]}}},"configuration":{"provider_config":{"archive":{"name":"archive","full_name":"registry.terraform.io/hashicorp/archive"},"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"~\u003e 5.0","expressions":{"region":{"references":["var.region"]}}}},"root_module":{"resources":[{"address":"aws_cloudwatch_event_rule.every_15_minutes","mode":"managed","type":"aws_cloudwatch_event_rule","name":"every_15_minutes","provider_config_key":"aws","expressions":{"description":{"constant_value":"Trigger every 15 minutes"},"name":{"constant_value":"every-15-minutes"},"schedule_expression":{"constant_value":"rate(15 minutes)"}},"schema_version":1},{"address":"aws_cloudwatch_event_target.playwright_lambda","mode":"managed","type":"aws_cloudwatch_event_target","name":"playwright_lambda","provider_config_key":"aws","expressions":{"arn":{"references":["module.playwright_lambda.function_arn","module.playwright_lambda"]},"input":{"references":["var.form_url"]},"rule":{"references":["aws_cloudwatch_event_rule.every_15_minutes.name","aws_cloudwatch_event_rule.every_15_minutes"]},"target_id":{"constant_value":"playwright-lambda"}},"schema_version":1},{"address":"aws_ecr_repository.playwright_lambda","mode":"managed","type":"aws_ecr_repository","name":"playwright_lambda","provider_config_key":"aws","expressions":{"image_scanning_configuration":[{"scan_on_push":{"constant_value":true}}],"image_tag_mutability":{"constant_value":"MUTABLE"},"name":{"constant_value":"playwright-lambda"},"tags":{"constant_value":{"CostCentre":"sre","Terraform":true}}},"schema_version":0},{"address":"aws_lambda_permission.eventbridge","mode":"managed","type":"aws_lambda_permission","name":"eventbridge","provider_config_key":"aws","expressions":{"action":{"constant_value":"lambda:InvokeFunction"},"function_name":{"references":["module.playwright_lambda.function_name","module.playwright_lambda"]},"principal":{"constant_value":"events.amazonaws.com"},"source_arn":{"references":["aws_cloudwatch_event_rule.every_15_minutes.arn","aws_cloudwatch_event_rule.every_15_minutes"]},"statement_id":{"constant_value":"AllowExecutionFromEventBridge"}},"schema_version":0},{"address":"data.archive_file.lambda_dummy","mode":"data","type":"archive_file","name":"lambda_dummy","provider_config_key":"archive","expressions":{"output_path":{"references":["local.lambda_dummy_zip"]},"source":[{"content":{"constant_value":"exports.handler = async (event) =\u003e {\n  console.log(\"Dummy lambda invoked\");\n  return { statusCode: 200, body: \"dummy\" };\n};\n"},"filename":{"constant_value":"index.js"}}],"type":{"constant_value":"zip"}},"schema_version":0}],"module_calls":{"playwright_lambda":{"source":"github.com/cds-snc/terraform-modules//lambda?ref=v9.6.2","expressions":{"billing_tag_value":{"constant_value":"sre"},"ecr_arn":{"references":["aws_ecr_repository.playwright_lambda.arn","aws_ecr_repository.playwright_lambda"]},"image_uri":{"references":["aws_ecr_repository.playwright_lambda.repository_url","aws_ecr_repository.playwright_lambda"]},"memory":{"constant_value":2048},"name":{"constant_value":"playwright-lambda"},"timeout":{"constant_value":300}},"module":{"outputs":{"function_arn":{"expression":{"references":["aws_lambda_function.this.arn","aws_lambda_function.this"]},"description":"ARN of the Lambda function."},"function_name":{"expression":{"references":["aws_lambda_function.this.function_name","aws_lambda_function.this"]},"description":"Name of the Lambda function."},"function_role_arn":{"expression":{"references":["aws_iam_role.this.arn","aws_iam_role.this"]},"description":"ARN of the Lambda function execution role."},"function_version":{"expression":{"references":["aws_lambda_function.this.version","aws_lambda_function.this"]},"description":"Version of the Lambda function."},"invoke_arn":{"expression":{"references":["aws_lambda_function.this.invoke_arn","aws_lambda_function.this"]},"description":"ARN used to invoke the Lambda function."}},"resources":[{"address":"aws_cloudwatch_log_group.this","mode":"managed","type":"aws_cloudwatch_log_group","name":"this","provider_config_key":"aws","expressions":{"name":{"references":["var.name"]},"retention_in_days":{"references":["var.log_group_retention_period"]},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_cloudwatch_query_definition.lambda_statistics","mode":"managed","type":"aws_cloudwatch_query_definition","name":"lambda_statistics","provider_config_key":"aws","expressions":{"log_group_names":{"references":["aws_cloudwatch_log_group.this.name","aws_cloudwatch_log_group.this"]},"name":{"references":["var.name"]},"query_string":{"constant_value":"filter @type = “REPORT”\n| stats\ncount(@type) as countInvocations,\ncount(@initDuration) as countColdStarts, (count(@initDuration)/count(@type))*100 as percentageColdStarts,\nmax(@initDuration) as maxColdStartTime,\navg(@duration) as averageDuration,\nmax(@duration) as maxDuration,\nmin(@duration) as minDuration,\navg(@maxMemoryUsed) as averageMemoryUsed,\nmax(@memorySize) as memoryAllocated, (avg(@maxMemoryUsed)/max(@memorySize))*100 as percentageMemoryUsed\nby bin(1h) as timeFrame\n"}},"schema_version":0},{"address":"aws_iam_policy.non_vpc_policies","mode":"managed","type":"aws_iam_policy","name":"non_vpc_policies","provider_config_key":"aws","expressions":{"name":{"references":["var.name"]},"path":{"constant_value":"/"},"policy":{"references":["data.aws_iam_policy_document.non_vpc_policies[0].json","data.aws_iam_policy_document.non_vpc_policies[0]","data.aws_iam_policy_document.non_vpc_policies"]},"tags":{"references":["local.common_tags"]}},"schema_version":0,"count_expression":{"references":["local.use_vpc"]}},{"address":"aws_iam_policy.policies","mode":"managed","type":"aws_iam_policy","name":"policies","provider_config_key":"aws","expressions":{"name":{"references":["var.name","count.index"]},"path":{"constant_value":"/"},"policy":{"references":["var.policies","count.index"]},"tags":{"references":["local.common_tags"]}},"schema_version":0,"count_expression":{"references":["var.policies"]}},{"address":"aws_iam_policy.vpc_policies","mode":"managed","type":"aws_iam_policy","name":"vpc_policies","provider_config_key":"aws","expressions":{"name":{"references":["var.name"]},"path":{"constant_value":"/"},"policy":{"references":["data.aws_iam_policy_document.vpc_policies[0].json","data.aws_iam_policy_document.vpc_policies[0]","data.aws_iam_policy_document.vpc_policies"]},"tags":{"references":["local.common_tags"]}},"schema_version":0,"count_expression":{"references":["local.use_vpc"]}},{"address":"aws_iam_role.this","mode":"managed","type":"aws_iam_role","name":"this","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.service_principal.json","data.aws_iam_policy_document.service_principal"]},"name":{"references":["var.name"]},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.AWSLambdaVPCAccessExecutionRole","mode":"managed","type":"aws_iam_role_policy_attachment","name":"AWSLambdaVPCAccessExecutionRole","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":"arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"},"role":{"references":["aws_iam_role.this.name","aws_iam_role.this"]}},"schema_version":0,"count_expression":{"references":["local.use_vpc"]}},{"address":"aws_iam_role_policy_attachment.attachments","mode":"managed","type":"aws_iam_role_policy_attachment","name":"attachments","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.policies","count.index"]},"role":{"references":["aws_iam_role.this.name","aws_iam_role.this"]}},"schema_version":0,"count_expression":{"references":["aws_iam_policy.policies"]}},{"address":"aws_iam_role_policy_attachment.lambda_insights","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_insights","provider_config_key":"aws","expressions":{"policy_arn":{"references":["data.aws_iam_policy.lambda_insights[0].arn","data.aws_iam_policy.lambda_insights[0]","data.aws_iam_policy.lambda_insights"]},"role":{"references":["aws_iam_role.this.name","aws_iam_role.this"]}},"schema_version":0,"count_expression":{"references":["var.enable_lambda_insights"]}},{"address":"aws_iam_role_policy_attachment.non_vpc_policies","mode":"managed","type":"aws_iam_role_policy_attachment","name":"non_vpc_policies","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.non_vpc_policies[0].arn","aws_iam_policy.non_vpc_policies[0]","aws_iam_policy.non_vpc_policies"]},"role":{"references":["aws_iam_role.this.name","aws_iam_role.this"]}},"schema_version":0,"count_expression":{"references":["local.use_vpc"]}},{"address":"aws_iam_role_policy_attachment.vpc_policies","mode":"managed","type":"aws_iam_role_policy_attachment","name":"vpc_policies","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.vpc_policies[0].arn","aws_iam_policy.vpc_policies[0]","aws_iam_policy.vpc_policies"]},"role":{"references":["aws_iam_role.this.name","aws_iam_role.this"]}},"schema_version":0,"count_expression":{"references":["local.use_vpc"]}},{"address":"aws_lambda_alias.this","mode":"managed","type":"aws_lambda_alias","name":"this","provider_config_key":"aws","expressions":{"description":{"constant_value":"The most recently deployed version of the API"},"function_name":{"references":["aws_lambda_function.this.function_name","aws_lambda_function.this"]},"function_version":{"references":["aws_lambda_function.this.version","aws_lambda_function.this"]},"name":{"references":["var.alias_name"]}},"schema_version":0,"count_expression":{"references":["var.alias_name"]}},{"address":"aws_lambda_function.this","mode":"managed","type":"aws_lambda_function","name":"this","provider_config_key":"aws","expressions":{"architectures":{"references":["var.architectures"]},"ephemeral_storage":[{"size":{"references":["var.ephemeral_storage"]}}],"function_name":{"references":["var.name"]},"image_uri":{"references":["var.image_uri"]},"memory_size":{"references":["var.memory"]},"package_type":{"constant_value":"Image"},"publish":{"references":["var.publish"]},"reserved_concurrent_executions":{"references":["var.reserved_concurrent_executions"]},"role":{"references":["aws_iam_role.this.arn","aws_iam_role.this"]},"tags":{"references":["local.common_tags"]},"timeout":{"references":["var.timeout"]},"tracing_config":[{"mode":{"constant_value":"PassThrough"}}],"vpc_config":[{"security_group_ids":{"references":["var.vpc.security_group_ids","var.vpc"]},"subnet_ids":{"references":["var.vpc.subnet_ids","var.vpc"]}}]},"schema_version":0},{"address":"aws_lambda_permission.api_gateway","mode":"managed","type":"aws_lambda_permission","name":"api_gateway","provider_config_key":"aws","expressions":{"action":{"constant_value":"lambda:InvokeFunction"},"function_name":{"references":["aws_lambda_function.this.function_name","aws_lambda_function.this"]},"principal":{"constant_value":"apigateway.amazonaws.com"},"source_arn":{"references":["var.api_gateway_source_arn"]},"statement_id":{"constant_value":"AllowAPIGatewayInvoke"}},"schema_version":0,"count_expression":{"references":["var.allow_api_gateway_invoke"]}},{"address":"aws_lambda_permission.s3_execution","mode":"managed","type":"aws_lambda_permission","name":"s3_execution","provider_config_key":"aws","expressions":{"action":{"constant_value":"lambda:InvokeFunction"},"function_name":{"references":["aws_lambda_function.this.function_name","aws_lambda_function.this"]},"principal":{"constant_value":"s3.amazonaws.com"},"source_arn":{"references":["var.bucket.arn","var.bucket"]},"statement_id":{"constant_value":"AllowExecutionFromS3Bucket"}},"schema_version":0,"count_expression":{"references":["var.allow_s3_execution"]}},{"address":"aws_lambda_permission.sns","mode":"managed","type":"aws_lambda_permission","name":"sns","provider_config_key":"aws","expressions":{"action":{"constant_value":"lambda:InvokeFunction"},"function_name":{"references":["aws_lambda_function.this.function_name","aws_lambda_function.this"]},"principal":{"constant_value":"sns.amazonaws.com"},"source_arn":{"references":["var.sns_topic_arns","count.index"]},"statement_id":{"references":["count.index"]}},"schema_version":0,"count_expression":{"references":["var.sns_topic_arns"]}},{"address":"aws_s3_bucket_notification.this","mode":"managed","type":"aws_s3_bucket_notification","name":"this","provider_config_key":"aws","expressions":{"bucket":{"references":["var.bucket.id","var.bucket"]},"lambda_function":[{"events":{"constant_value":["s3:ObjectCreated:*"]},"filter_suffix":{"constant_value":".json"},"lambda_function_arn":{"references":["aws_lambda_function.this.arn","aws_lambda_function.this"]}}]},"schema_version":0,"count_expression":{"references":["var.allow_s3_execution"]},"depends_on":["aws_lambda_permission.s3_execution"]},{"address":"data.aws_iam_policy.lambda_insights","mode":"data","type":"aws_iam_policy","name":"lambda_insights","provider_config_key":"aws","expressions":{"name":{"constant_value":"CloudWatchLambdaInsightsExecutionRolePolicy"}},"schema_version":0,"count_expression":{"references":["var.enable_lambda_insights"]}},{"address":"data.aws_iam_policy_document.non_vpc_policies","mode":"data","type":"aws_iam_policy_document","name":"non_vpc_policies","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"]},"effect":{"constant_value":"Allow"},"resources":{"constant_value":["*"]},"sid":{"constant_value":"CloudWatchAccess"}},{"actions":{"constant_value":["ecr:GetDownloadUrlForlayer","ecr:BatchGetImage"]},"effect":{"constant_value":"Allow"},"resources":{"references":["var.ecr_arn"]},"sid":{"constant_value":"ECRImageAccess"}}]},"schema_version":0,"count_expression":{"references":["local.use_vpc"]}},{"address":"data.aws_iam_policy_document.service_principal","mode":"data","type":"aws_iam_policy_document","name":"service_principal","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"constant_value":["lambda.amazonaws.com"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0},{"address":"data.aws_iam_policy_document.vpc_policies","mode":"data","type":"aws_iam_policy_document","name":"vpc_policies","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["ecr:GetDownloadUrlForlayer","ecr:BatchGetImage"]},"effect":{"constant_value":"Allow"},"resources":{"references":["var.ecr_arn"]},"sid":{"constant_value":"ECRImageAccess"}}]},"schema_version":0,"count_expression":{"references":["local.use_vpc"]}}],"variables":{"alias_name":{"default":"","description":"(Optional, default '') Lambda function's alias name"},"allow_api_gateway_invoke":{"default":false,"description":"(Optional) Allow API Gateway to invoke the lambda"},"allow_s3_execution":{"default":false,"description":"(Optional) Allow S3 to execute the lambda"},"api_gateway_source_arn":{"default":"","description":"(Optional) The api gateway rest point that can call the lambda"},"architectures":{"default":["x86_64"],"description":"(Optional) The architectures that the lambda can run on"},"billing_tag_key":{"default":"CostCentre","description":"(Optional, default 'CostCentre') The name of the billing tag"},"billing_tag_value":{"description":"(Required) The value of the billing tag"},"bucket":{"default":{"arn":"","id":""},"description":"(Optional) S3 bucket that is triggering the lambda"},"dead_letter_queue_arn":{"default":"","description":"(Optional) The arn of the dead letter queue"},"ecr_arn":{"description":"(Optional) The arn of the ecr repository the image resides in the lambda will be given access to pull images and layers from this registry"},"enable_lambda_insights":{"default":true,"description":"(Optional) Enable Lambda Insights"},"environment_variables":{"default":{},"description":"(Optional) Environment variables to pass to the lambda"},"ephemeral_storage":{"default":512,"description":"(Optional) Set the Lambda function's ephemeral storage to a value between 512MB and 10240MB."},"file_system_config":{"default":{},"description":"(Optional) Configuration to connect EFS to a Lambda function."},"image_uri":{"description":"(Required) Docker image URI"},"log_group_retention_period":{"default":14,"description":"(Optional) Override the retention period for the lambda log group"},"memory":{"default":128,"description":"(Optional) Memory in MB"},"name":{"description":"(Required) Name of the lambda"},"policies":{"default":[],"description":"(Optional) List of policies to attach to the Lambda function"},"publish":{"default":false,"description":"(Optional, default 'false') Whether to publish creation/change as new Lambda Function Version."},"reserved_concurrent_executions":{"default":-1,"description":"(Optional) Amount of reserved concurrent executions for this lambda function. A value of 0 disables lambda from being triggered and -1 removes any concurrency limitations. Defaults to Unreserved Concurrency Limits -1. See [Managing Concurrency](https://docs.aws.amazon.com/lambda/latest/dg/concurrent-executions.html)"},"sns_topic_arns":{"default":[],"description":"(Optional) SNS triggers to attach to the Lambda function"},"timeout":{"default":3,"description":"(Optional) Timeout in seconds"},"vpc":{"default":{"security_group_ids":[],"subnet_ids":[]},"description":"(Optional) VPC to attach to the Lambda function \u003cbr/\u003e **Please Note if this is set it will also attach the AWSLambdaVPCAccessExecutionRole to the lmabda this will enable creation of VPC ENI's as well as reading and writing to logfiles"}}}}},"variables":{"form_url":{"description":"The URL of the form to submit."},"region":{"default":"ca-central-1","description":"The AWS region to deploy the Lambda function to."}}}},"relevant_attributes":[{"resource":"module.playwright_lambda.aws_cloudwatch_log_group.this","attribute":["name"]},{"resource":"module.playwright_lambda.aws_lambda_function.this","attribute":["arn"]},{"resource":"module.playwright_lambda.aws_lambda_function.this","attribute":["version"]},{"resource":"module.playwright_lambda.aws_iam_policy.non_vpc_policies[0]","attribute":["arn"]},{"resource":"aws_cloudwatch_event_rule.every_15_minutes","attribute":["arn"]},{"resource":"module.playwright_lambda.aws_iam_role.this","attribute":["arn"]},{"resource":"module.playwright_lambda.aws_iam_role.this","attribute":["name"]},{"resource":"aws_cloudwatch_event_rule.every_15_minutes","attribute":["name"]},{"resource":"module.playwright_lambda.data.aws_iam_policy_document.non_vpc_policies[0]","attribute":["json"]},{"resource":"module.playwright_lambda.data.aws_iam_policy_document.service_principal","attribute":["json"]},{"resource":"module.playwright_lambda.aws_lambda_function.this","attribute":["function_name"]},{"resource":"module.playwright_lambda.data.aws_iam_policy.lambda_insights[0]","attribute":["arn"]},{"resource":"aws_ecr_repository.playwright_lambda","attribute":["arn"]},{"resource":"aws_ecr_repository.playwright_lambda","attribute":["repository_url"]},{"resource":"module.playwright_lambda.aws_lambda_function.this","attribute":["invoke_arn"]}],"checks":[{"address":{"kind":"var","module":"module.playwright_lambda","name":"ephemeral_storage","to_display":"module.playwright_lambda.var.ephemeral_storage"},"status":"pass","instances":[{"address":{"module":"module.playwright_lambda","to_display":"module.playwright_lambda.var.ephemeral_storage"},"status":"pass"}]}],"timestamp":"2026-01-19T15:02:27Z","applyable":true,"complete":true,"errored":false}
