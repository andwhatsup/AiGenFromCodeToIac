{
  "version": 4,
  "terraform_version": "1.13.5",
  "serial": 3,
  "lineage": "b52aeb2e-54b0-ea72-2091-0cc283877126",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "aws_iam_policy_document",
      "name": "sfn_assume",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "4022981484",
            "json": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"states.amazonaws.com\"\n      }\n    }\n  ]\n}",
            "minified_json": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRole\",\"Principal\":{\"Service\":\"states.amazonaws.com\"}}]}",
            "override_json": null,
            "override_policy_documents": null,
            "policy_id": null,
            "source_json": null,
            "source_policy_documents": null,
            "statement": [
              {
                "actions": [
                  "sts:AssumeRole"
                ],
                "condition": [],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [
                  {
                    "identifiers": [
                      "states.amazonaws.com"
                    ],
                    "type": "Service"
                  }
                ],
                "resources": [],
                "sid": ""
              }
            ],
            "version": "2012-10-17"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "sfn",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::000000000000:role/aws-rekognition-sfn-dc5ffd40",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"states.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2026-01-25T20:02:01Z",
            "description": "",
            "force_detach_policies": false,
            "id": "aws-rekognition-sfn-dc5ffd40",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "aws-rekognition-sfn-dc5ffd40",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": null,
            "tags_all": {
              "Managed": "terraform",
              "Project": "aws-rekognition"
            },
            "unique_id": "AROAQAAAAAAAJF3UMF34Y"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "data.aws_iam_policy_document.sfn_assume",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "artifacts",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "aws_sfn_state_machine",
      "name": "rekognition",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:states:us-east-1:000000000000:stateMachine:aws-rekognition-dc5ffd40",
            "creation_date": "2026-01-25T20:02:02Z",
            "definition": "{\n    \"StartAt\": \"Map\",\n    \"States\": {\n        \"Map\": {\n            \"Type\": \"Map\",\n            \"ItemProcessor\": {\n                \"ProcessorConfig\": {\n                    \"Mode\": \"INLINE\"\n                },\n                \"StartAt\": \"CheckEventSource\",\n                \"States\": {\n                    \"CheckEventSource\": {\n                        \"Type\": \"Choice\",\n                        \"Choices\": [\n                            {\n                                \"And\": [\n                                    {\n                                        \"Variable\": \"$.eventSource\",\n                                        \"IsPresent\": true\n                                    },\n                                    {\n                                        \"Variable\": \"$.eventSource\",\n                                        \"IsString\": true\n                                    },\n                                    {\n                                        \"Variable\": \"$.eventSource\",\n                                        \"StringEquals\": \"aws:sqs\"\n                                    }\n                                ],\n                                \"Next\": \"CheckBody\"\n                            }\n                        ],\n                        \"Default\": \"SuccessCheckEventSource\"\n                    },\n                    \"CheckBody\": {\n                        \"Type\": \"Choice\",\n                        \"Choices\": [\n                            {\n                                \"And\": [\n                                    {\n                                        \"Variable\": \"$.body\",\n                                        \"IsPresent\": true\n                                    },\n                                    {\n                                        \"Variable\": \"$.body\",\n                                        \"IsString\": true\n                                    }\n                                ],\n                                \"Next\": \"PassBody\"\n                            }\n                        ],\n                        \"Default\": \"SuccessCheckBody\"\n                    },\n                    \"PassBody\": {\n                        \"Type\": \"Pass\",\n                        \"Parameters\": {\n                            \"body.$\": \"States.StringToJson($.body)\"\n                        },\n                        \"Next\": \"CheckBodyRecords\"\n                    },\n                    \"CheckBodyRecords\": {\n                        \"Type\": \"Choice\",\n                        \"Choices\": [\n                            {\n                                \"Variable\": \"$.Records\",\n                                \"IsPresent\": true,\n                                \"Next\": \"MapBodyRecords\"\n                            }\n                        ],\n                        \"Default\": \"SuccessCheckBodyRecords\",\n                        \"InputPath\": \"$.body\"\n                    },\n                    \"MapBodyRecords\": {\n                        \"Type\": \"Map\",\n                        \"ItemProcessor\": {\n                            \"ProcessorConfig\": {\n                                \"Mode\": \"INLINE\"\n                            },\n                            \"StartAt\": \"CheckBodyRecordEventSource\",\n                            \"States\": {\n                                \"CheckBodyRecordEventSource\": {\n                                    \"Type\": \"Choice\",\n                                    \"Choices\": [\n                                        {\n                                            \"And\": [\n                                                {\n                                                    \"Variable\": \"$.eventSource\",\n                                                    \"IsPresent\": true\n                                                },\n                                                {\n                                                    \"Variable\": \"$.eventSource\",\n                                                    \"IsString\": true\n                                                },\n                                                {\n                                                    \"Variable\": \"$.eventSource\",\n                                                    \"StringEquals\": \"aws:s3\"\n                                                }\n                                            ],\n                                            \"Next\": \"CheckBodyRecordEventName\"\n                                        }\n                                    ],\n                                    \"Default\": \"SuccessCheckBodyRecordEventSource\"\n                                },\n                                \"CheckBodyRecordEventName\": {\n                                    \"Type\": \"Choice\",\n                                    \"Choices\": [\n                                        {\n                                            \"And\": [\n                                                {\n                                                    \"Variable\": \"$.eventName\",\n                                                    \"IsPresent\": true\n                                                },\n                                                {\n                                                    \"Variable\": \"$.eventName\",\n                                                    \"IsString\": true\n                                                },\n                                                {\n                                                    \"Or\": [\n                                                        {\n                                                            \"Variable\": \"$.eventName\",\n                                                            \"StringEquals\": \"ObjectCreated:CompleteMultipartUpload\"\n                                                        },\n                                                        {\n                                                            \"Variable\": \"$.eventName\",\n                                                            \"StringEquals\": \"ObjectCreated:Copy\"\n                                                        },\n                                                        {\n                                                            \"Variable\": \"$.eventName\",\n                                                            \"StringEquals\": \"ObjectCreated:Post\"\n                                                        },\n                                                        {\n                                                            \"Variable\": \"$.eventName\",\n                                                            \"StringEquals\": \"ObjectCreated:Put\"\n                                                        }\n                                                    ]\n                                                }\n                                            ],\n                                            \"Next\": \"CheckBodyRecordS3\"\n                                        }\n                                    ],\n                                    \"Default\": \"SuccessCheckBodyRecordEventName\"\n                                },\n                                \"CheckBodyRecordS3\": {\n                                    \"Type\": \"Choice\",\n                                    \"Choices\": [\n                                        {\n                                            \"Variable\": \"$.s3\",\n                                            \"IsPresent\": true,\n                                            \"Next\": \"PassBodyRecordS3\"\n                                        }\n                                    ],\n                                    \"Default\": \"Success\"\n                                },\n                                \"PassBodyRecordS3\": {\n                                    \"Type\": \"Pass\",\n                                    \"InputPath\": \"$.s3\",\n                                    \"Next\": \"ParallelRekognitionStateMachines\"\n                                },\n                                \"ParallelRekognitionStateMachines\": {\n                                    \"Type\": \"Parallel\",\n                                    \"End\": true,\n                                    \"Branches\": [\n                                        {\n                                            \"StartAt\": \"StartExecutionRekognitionDetectFaces\",\n                                            \"States\": {\n                                                \"StartExecutionRekognitionDetectFaces\": {\n                                                    \"Type\": \"Task\",\n                                                    \"Resource\": \"arn:aws:states:::states:startExecution.sync:2\",\n                                                    \"Parameters\": {\n                                                        \"StateMachineArn\": \"${rekognition_detect_faces}\",\n                                                        \"Input\": {\n                                                            \"StatePayload.$\": \"$\",\n                                                            \"TaskToken.$\": \"$$.Task.Token\",\n                                                            \"AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$\": \"$$.Execution.Id\"\n                                                        }\n                                                    },\n                                                    \"Next\": \"PutObjectRekognitionDetectFaces\",\n                                                    \"OutputPath\": \"$.Output\"\n                                                },\n                                                \"PutObjectRekognitionDetectFaces\": {\n                                                    \"Type\": \"Task\",\n                                                    \"Parameters\": {\n                                                        \"Body.$\": \"$\",\n                                                        \"Bucket.$\": \"$.S3.Bucket.Name\",\n                                                        \"Key.$\": \"States.Format('${s3_object_rekognition_detect_faces}{}.json', $.S3.Object.ETag)\"\n                                                    },\n                                                    \"Resource\": \"arn:aws:states:::aws-sdk:s3:putObject\",\n                                                    \"End\": true\n                                                }\n                                            }\n                                        },\n                                        {\n                                            \"StartAt\": \"StartExecutionRekognitionDetectLabels\",\n                                            \"States\": {\n                                                \"StartExecutionRekognitionDetectLabels\": {\n                                                    \"Type\": \"Task\",\n                                                    \"Resource\": \"arn:aws:states:::states:startExecution.sync:2\",\n                                                    \"Parameters\": {\n                                                        \"StateMachineArn\": \"${rekognition_detect_labels}\",\n                                                        \"Input\": {\n                                                            \"StatePayload.$\": \"$\",\n                                                            \"TaskToken.$\": \"$$.Task.Token\",\n                                                            \"AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$\": \"$$.Execution.Id\"\n                                                        }\n                                                    },\n                                                    \"Next\": \"PutObjectRekognitionDetectLabels\",\n                                                    \"OutputPath\": \"$.Output\"\n                                                },\n                                                \"PutObjectRekognitionDetectLabels\": {\n                                                    \"Type\": \"Task\",\n                                                    \"Parameters\": {\n                                                        \"Body.$\": \"$\",\n                                                        \"Bucket.$\": \"$.S3.Bucket.Name\",\n                                                        \"Key.$\": \"States.Format('${s3_object_rekognition_detect_labels}{}.json', $.S3.Object.ETag)\"\n                                                    },\n                                                    \"Resource\": \"arn:aws:states:::aws-sdk:s3:putObject\",\n                                                    \"End\": true\n                                                }\n                                            }\n                                        },\n                                        {\n                                            \"StartAt\": \"StartExecutionRekognitionDetectModerationLabels\",\n                                            \"States\": {\n                                                \"StartExecutionRekognitionDetectModerationLabels\": {\n                                                    \"Type\": \"Task\",\n                                                    \"Resource\": \"arn:aws:states:::states:startExecution.sync:2\",\n                                                    \"Parameters\": {\n                                                        \"StateMachineArn\": \"${rekognition_detect_moderation_labels}\",\n                                                        \"Input\": {\n                                                            \"StatePayload.$\": \"$\",\n                                                            \"TaskToken.$\": \"$$.Task.Token\",\n                                                            \"AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$\": \"$$.Execution.Id\"\n                                                        }\n                                                    },\n                                                    \"Next\": \"PutObjectDetectModerationLabels\",\n                                                    \"OutputPath\": \"$.Output\"\n                                                },\n                                                \"PutObjectDetectModerationLabels\": {\n                                                    \"Type\": \"Task\",\n                                                    \"Parameters\": {\n                                                        \"Body.$\": \"$\",\n                                                        \"Bucket.$\": \"$.S3.Bucket.Name\",\n                                                        \"Key.$\": \"States.Format('${s3_object_rekognition_detect_moderation_labels}{}.json', $.S3.Object.ETag)\"\n                                                    },\n                                                    \"Resource\": \"arn:aws:states:::aws-sdk:s3:putObject\",\n                                                    \"End\": true\n                                                }\n                                            }\n                                        },\n                                        {\n                                            \"StartAt\": \"StartExecutionRekognitionDetectProtectiveEquipment\",\n                                            \"States\": {\n                                                \"StartExecutionRekognitionDetectProtectiveEquipment\": {\n                                                    \"Type\": \"Task\",\n                                                    \"Resource\": \"arn:aws:states:::states:startExecution.sync:2\",\n                                                    \"Parameters\": {\n                                                        \"StateMachineArn\": \"${rekognition_detect_protective_equipment}\",\n                                                        \"Input\": {\n                                                            \"StatePayload.$\": \"$\",\n                                                            \"TaskToken.$\": \"$$.Task.Token\",\n                                                            \"AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$\": \"$$.Execution.Id\"\n                                                        }\n                                                    },\n                                                    \"Next\": \"PutObjectRekognitionDetectProtectiveEquipment\",\n                                                    \"OutputPath\": \"$.Output\"\n                                                },\n                                                \"PutObjectRekognitionDetectProtectiveEquipment\": {\n                                                    \"Type\": \"Task\",\n                                                    \"Parameters\": {\n                                                        \"Body.$\": \"$\",\n                                                        \"Bucket.$\": \"$.S3.Bucket.Name\",\n                                                        \"Key.$\": \"States.Format('${s3_object_rekognition_detect_protective_equipment}{}.json', $.S3.Object.ETag)\"\n                                                    },\n                                                    \"Resource\": \"arn:aws:states:::aws-sdk:s3:putObject\",\n                                                    \"End\": true\n                                                }\n                                            }\n                                        },\n                                        {\n                                            \"StartAt\": \"StartExecutionRekognitionDetectText\",\n                                            \"States\": {\n                                                \"StartExecutionRekognitionDetectText\": {\n                                                    \"Type\": \"Task\",\n                                                    \"Resource\": \"arn:aws:states:::states:startExecution.sync:2\",\n                                                    \"Parameters\": {\n                                                        \"StateMachineArn\": \"${rekognition_detect_text}\",\n                                                        \"Input\": {\n                                                            \"StatePayload.$\": \"$\",\n                                                            \"TaskToken.$\": \"$$.Task.Token\",\n                                                            \"AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$\": \"$$.Execution.Id\"\n                                                        }\n                                                    },\n                                                    \"Next\": \"PutObjectRekognitionDetectText\",\n                                                    \"OutputPath\": \"$.Output\"\n                                                },\n                                                \"PutObjectRekognitionDetectText\": {\n                                                    \"Type\": \"Task\",\n                                                    \"Parameters\": {\n                                                        \"Body.$\": \"$\",\n                                                        \"Bucket.$\": \"$.S3.Bucket.Name\",\n                                                        \"Key.$\": \"States.Format('${s3_object_rekognition_detect_text}{}.json', $.S3.Object.ETag)\"\n                                                    },\n                                                    \"Resource\": \"arn:aws:states:::aws-sdk:s3:putObject\",\n                                                    \"End\": true\n                                                }\n                                            }\n                                        }\n                                    ],\n                                    \"Parameters\": {\n                                        \"S3\": {\n                                            \"Bucket\": {\n                                                \"Name.$\": \"$.bucket.name\"\n                                            },\n                                            \"Object\": {\n                                                \"Key.$\": \"$.object.key\"\n                                            }\n                                        }\n                                    }\n                                },\n                                \"Success\": {\n                                    \"Type\": \"Succeed\"\n                                },\n                                \"SuccessCheckBodyRecordEventName\": {\n                                    \"Type\": \"Succeed\"\n                                },\n                                \"SuccessCheckBodyRecordEventSource\": {\n                                    \"Type\": \"Succeed\"\n                                }\n                            }\n                        },\n                        \"End\": true,\n                        \"ItemsPath\": \"$.Records\"\n                    },\n                    \"SuccessCheckBodyRecords\": {\n                        \"Type\": \"Succeed\"\n                    },\n                    \"SuccessCheckBody\": {\n                        \"Type\": \"Succeed\"\n                    },\n                    \"SuccessCheckEventSource\": {\n                        \"Type\": \"Succeed\"\n                    }\n                }\n            },\n            \"End\": true,\n            \"ItemsPath\": \"$\"\n        }\n    }\n}\n",
            "description": "",
            "encryption_configuration": [],
            "id": "arn:aws:states:us-east-1:000000000000:stateMachine:aws-rekognition-dc5ffd40",
            "logging_configuration": [
              {
                "include_execution_data": false,
                "level": "OFF",
                "log_destination": ""
              }
            ],
            "name": "aws-rekognition-dc5ffd40",
            "name_prefix": "",
            "publish": false,
            "revision_id": "",
            "role_arn": "arn:aws:iam::000000000000:role/aws-rekognition-sfn-dc5ffd40",
            "state_machine_version_arn": "",
            "status": "ACTIVE",
            "tags": null,
            "tags_all": {
              "Managed": "terraform",
              "Project": "aws-rekognition"
            },
            "timeouts": null,
            "tracing_configuration": [],
            "type": "STANDARD",
            "version_description": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "aws_iam_role.sfn",
            "data.aws_iam_policy_document.sfn_assume",
            "random_id.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_id",
      "name": "suffix",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "b64_std": "3F/9QA==",
            "b64_url": "3F_9QA",
            "byte_length": 4,
            "dec": "3697278272",
            "hex": "dc5ffd40",
            "id": "3F_9QA",
            "keepers": null,
            "prefix": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    }
  ],
  "check_results": null
}
