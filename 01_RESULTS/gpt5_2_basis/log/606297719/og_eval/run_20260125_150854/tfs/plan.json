{"format_version":"1.2","terraform_version":"1.13.5","variables":{"agent_cpu":{"value":1024},"agent_desired_count":{"value":1},"agent_extra_pip_packages":{"value":"prefect-aws s3fs"},"agent_image":{"value":"prefecthq/prefect:2-python3.10"},"agent_log_retention_in_days":{"value":30},"agent_memory":{"value":2048},"agent_queue_name":{"value":"test-queue"},"agent_subnets":{"value":[]},"agent_task_role_arn":{"value":null},"name":{"value":"deployment-agent-test"},"prefect_account_id":{"value":"tfs"},"prefect_api_key":{"value":"tfs.txt"},"prefect_workspace_id":{"value":"tfs"},"vpc_id":{"value":"vpc-00000000"}},"planned_values":{"outputs":{"prefect_agent_cluster_name":{"sensitive":false,"type":"string","value":"prefect-agent-deployment-agent-test"},"prefect_agent_execution_role_arn":{"sensitive":false},"prefect_agent_security_group":{"sensitive":false},"prefect_agent_service_id":{"sensitive":false},"prefect_agent_task_role_arn":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_cloudwatch_log_group.prefect_agent_log_group","mode":"managed","type":"aws_cloudwatch_log_group","name":"prefect_agent_log_group","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"kms_key_id":null,"name":"prefect-agent-log-group-deployment-agent-test","retention_in_days":30,"skip_destroy":false,"tags":null},"sensitive_values":{"tags_all":{}}},{"address":"aws_ecs_cluster.prefect_agent_cluster","mode":"managed","type":"aws_ecs_cluster","name":"prefect_agent_cluster","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"configuration":[],"name":"prefect-agent-deployment-agent-test","service_connect_defaults":[],"tags":null},"sensitive_values":{"capacity_providers":[],"configuration":[],"default_capacity_provider_strategy":[],"service_connect_defaults":[],"setting":[],"tags_all":{}}},{"address":"aws_ecs_cluster_capacity_providers.prefect_agent_cluster_capacity_providers","mode":"managed","type":"aws_ecs_cluster_capacity_providers","name":"prefect_agent_cluster_capacity_providers","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"capacity_providers":["FARGATE"],"cluster_name":"prefect-agent-deployment-agent-test","default_capacity_provider_strategy":[]},"sensitive_values":{"capacity_providers":[false],"default_capacity_provider_strategy":[]}},{"address":"aws_ecs_service.prefect_agent_service","mode":"managed","type":"aws_ecs_service","name":"prefect_agent_service","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alarms":[],"capacity_provider_strategy":[],"deployment_circuit_breaker":[],"deployment_controller":[],"deployment_maximum_percent":200,"deployment_minimum_healthy_percent":100,"desired_count":1,"enable_ecs_managed_tags":false,"enable_execute_command":false,"force_new_deployment":null,"health_check_grace_period_seconds":null,"launch_type":"FARGATE","load_balancer":[],"name":"prefect-agent-deployment-agent-test","network_configuration":[{"assign_public_ip":true,"subnets":null}],"ordered_placement_strategy":[],"placement_constraints":[],"propagate_tags":null,"scheduling_strategy":"REPLICA","service_connect_configuration":[],"service_registries":[],"tags":null,"timeouts":null,"wait_for_steady_state":false},"sensitive_values":{"alarms":[],"capacity_provider_strategy":[],"deployment_circuit_breaker":[],"deployment_controller":[],"load_balancer":[],"network_configuration":[{"security_groups":[]}],"ordered_placement_strategy":[],"placement_constraints":[],"service_connect_configuration":[],"service_registries":[],"tags_all":{},"triggers":{}}},{"address":"aws_ecs_task_definition.prefect_agent_task_definition","mode":"managed","type":"aws_ecs_task_definition","name":"prefect_agent_task_definition","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"cpu":"1024","ephemeral_storage":[],"family":"prefect-agent-deployment-agent-test","inference_accelerator":[],"ipc_mode":null,"memory":"2048","network_mode":"awsvpc","pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":["FARGATE"],"runtime_platform":[],"skip_destroy":false,"tags":null,"volume":[]},"sensitive_values":{"ephemeral_storage":[],"inference_accelerator":[],"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"runtime_platform":[],"tags_all":{},"volume":[]}},{"address":"aws_iam_role.prefect_agent_execution_role","mode":"managed","type":"aws_iam_role","name":"prefect_agent_execution_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"inline_policy":[{"name":"ssm-allow-read-prefect-api-key-deployment-agent-test"}],"managed_policy_arns":["arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"],"max_session_duration":3600,"name":"prefect-agent-execution-role-deployment-agent-test","path":"/","permissions_boundary":null,"tags":null},"sensitive_values":{"inline_policy":[{}],"managed_policy_arns":[false],"role_last_used":[],"tags_all":{}}},{"address":"aws_iam_role.prefect_agent_task_role[0]","mode":"managed","type":"aws_iam_role","name":"prefect_agent_task_role","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"inline_policy":[{"name":"prefect-agent-allow-ecs-task-deployment-agent-test","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"ec2:DescribeSubnets\",\"ec2:DescribeVpcs\",\"ecr:BatchCheckLayerAvailability\",\"ecr:BatchGetImage\",\"ecr:GetAuthorizationToken\",\"ecr:GetDownloadUrlForLayer\",\"ecs:DeregisterTaskDefinition\",\"ecs:DescribeTasks\",\"ecs:RegisterTaskDefinition\",\"ecs:RunTask\",\"iam:PassRole\",\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:GetLogEvents\",\"logs:PutLogEvents\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}"}],"max_session_duration":3600,"name":"prefect-agent-task-role-deployment-agent-test","path":"/","permissions_boundary":null,"tags":null},"sensitive_values":{"inline_policy":[{}],"managed_policy_arns":[],"role_last_used":[],"tags_all":{}}},{"address":"aws_s3_bucket.prefect-bucket","mode":"managed","type":"aws_s3_bucket","name":"prefect-bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"bucket-full-of-sunshine-prefect","force_destroy":false,"tags":null,"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags_all":{},"versioning":[],"website":[]}},{"address":"aws_secretsmanager_secret.prefect_api_key","mode":"managed","type":"aws_secretsmanager_secret","name":"prefect_api_key","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"force_overwrite_replica_secret":false,"kms_key_id":null,"name":"prefect-api-key-deployment-agent-test","recovery_window_in_days":30,"tags":null},"sensitive_values":{"replica":[],"rotation_rules":[],"tags_all":{}}},{"address":"aws_secretsmanager_secret_version.prefect_api_key_version","mode":"managed","type":"aws_secretsmanager_secret_version","name":"prefect_api_key_version","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"secret_binary":null,"secret_string":"tfs.txt"},"sensitive_values":{"secret_binary":true,"secret_string":true,"version_stages":[]}},{"address":"aws_security_group.prefect_agent","mode":"managed","type":"aws_security_group","name":"prefect_agent","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"ECS Prefect Agent","name":"prefect-agent-sg-deployment-agent-test","revoke_rules_on_delete":false,"tags":null,"timeouts":null,"vpc_id":"vpc-00000000"},"sensitive_values":{"egress":[],"ingress":[],"tags_all":{}}},{"address":"aws_security_group_rule.https_outbound","mode":"managed","type":"aws_security_group_rule","name":"https_outbound","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":["0.0.0.0/0"],"description":"HTTPS outbound","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","self":false,"timeouts":null,"to_port":443,"type":"egress"},"sensitive_values":{"cidr_blocks":[false]}}]}},"resource_changes":[{"address":"aws_cloudwatch_log_group.prefect_agent_log_group","mode":"managed","type":"aws_cloudwatch_log_group","name":"prefect_agent_log_group","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"kms_key_id":null,"name":"prefect-agent-log-group-deployment-agent-test","retention_in_days":30,"skip_destroy":false,"tags":null},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_ecs_cluster.prefect_agent_cluster","mode":"managed","type":"aws_ecs_cluster","name":"prefect_agent_cluster","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"configuration":[],"name":"prefect-agent-deployment-agent-test","service_connect_defaults":[],"tags":null},"after_unknown":{"arn":true,"capacity_providers":true,"configuration":[],"default_capacity_provider_strategy":true,"id":true,"service_connect_defaults":[],"setting":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"capacity_providers":[],"configuration":[],"default_capacity_provider_strategy":[],"service_connect_defaults":[],"setting":[],"tags_all":{}}}},{"address":"aws_ecs_cluster_capacity_providers.prefect_agent_cluster_capacity_providers","mode":"managed","type":"aws_ecs_cluster_capacity_providers","name":"prefect_agent_cluster_capacity_providers","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"capacity_providers":["FARGATE"],"cluster_name":"prefect-agent-deployment-agent-test","default_capacity_provider_strategy":[]},"after_unknown":{"capacity_providers":[false],"default_capacity_provider_strategy":[],"id":true},"before_sensitive":false,"after_sensitive":{"capacity_providers":[false],"default_capacity_provider_strategy":[]}}},{"address":"aws_ecs_service.prefect_agent_service","mode":"managed","type":"aws_ecs_service","name":"prefect_agent_service","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alarms":[],"capacity_provider_strategy":[],"deployment_circuit_breaker":[],"deployment_controller":[],"deployment_maximum_percent":200,"deployment_minimum_healthy_percent":100,"desired_count":1,"enable_ecs_managed_tags":false,"enable_execute_command":false,"force_new_deployment":null,"health_check_grace_period_seconds":null,"launch_type":"FARGATE","load_balancer":[],"name":"prefect-agent-deployment-agent-test","network_configuration":[{"assign_public_ip":true,"subnets":null}],"ordered_placement_strategy":[],"placement_constraints":[],"propagate_tags":null,"scheduling_strategy":"REPLICA","service_connect_configuration":[],"service_registries":[],"tags":null,"timeouts":null,"wait_for_steady_state":false},"after_unknown":{"alarms":[],"capacity_provider_strategy":[],"cluster":true,"deployment_circuit_breaker":[],"deployment_controller":[],"iam_role":true,"id":true,"load_balancer":[],"network_configuration":[{"security_groups":true}],"ordered_placement_strategy":[],"placement_constraints":[],"platform_version":true,"service_connect_configuration":[],"service_registries":[],"tags_all":true,"task_definition":true,"triggers":true},"before_sensitive":false,"after_sensitive":{"alarms":[],"capacity_provider_strategy":[],"deployment_circuit_breaker":[],"deployment_controller":[],"load_balancer":[],"network_configuration":[{"security_groups":[]}],"ordered_placement_strategy":[],"placement_constraints":[],"service_connect_configuration":[],"service_registries":[],"tags_all":{},"triggers":{}}}},{"address":"aws_ecs_task_definition.prefect_agent_task_definition","mode":"managed","type":"aws_ecs_task_definition","name":"prefect_agent_task_definition","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cpu":"1024","ephemeral_storage":[],"family":"prefect-agent-deployment-agent-test","inference_accelerator":[],"ipc_mode":null,"memory":"2048","network_mode":"awsvpc","pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":["FARGATE"],"runtime_platform":[],"skip_destroy":false,"tags":null,"volume":[]},"after_unknown":{"arn":true,"arn_without_revision":true,"container_definitions":true,"ephemeral_storage":[],"execution_role_arn":true,"id":true,"inference_accelerator":[],"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"revision":true,"runtime_platform":[],"tags_all":true,"task_role_arn":true,"volume":[]},"before_sensitive":false,"after_sensitive":{"ephemeral_storage":[],"inference_accelerator":[],"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"runtime_platform":[],"tags_all":{},"volume":[]}}},{"address":"aws_iam_role.prefect_agent_execution_role","mode":"managed","type":"aws_iam_role","name":"prefect_agent_execution_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"inline_policy":[{"name":"ssm-allow-read-prefect-api-key-deployment-agent-test"}],"managed_policy_arns":["arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"],"max_session_duration":3600,"name":"prefect-agent-execution-role-deployment-agent-test","path":"/","permissions_boundary":null,"tags":null},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":[{"policy":true}],"managed_policy_arns":[false],"name_prefix":true,"role_last_used":true,"tags_all":true,"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[{}],"managed_policy_arns":[false],"role_last_used":[],"tags_all":{}}}},{"address":"aws_iam_role.prefect_agent_task_role[0]","mode":"managed","type":"aws_iam_role","name":"prefect_agent_task_role","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"inline_policy":[{"name":"prefect-agent-allow-ecs-task-deployment-agent-test","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"ec2:DescribeSubnets\",\"ec2:DescribeVpcs\",\"ecr:BatchCheckLayerAvailability\",\"ecr:BatchGetImage\",\"ecr:GetAuthorizationToken\",\"ecr:GetDownloadUrlForLayer\",\"ecs:DeregisterTaskDefinition\",\"ecs:DescribeTasks\",\"ecs:RegisterTaskDefinition\",\"ecs:RunTask\",\"iam:PassRole\",\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:GetLogEvents\",\"logs:PutLogEvents\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}"}],"max_session_duration":3600,"name":"prefect-agent-task-role-deployment-agent-test","path":"/","permissions_boundary":null,"tags":null},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":[{}],"managed_policy_arns":true,"name_prefix":true,"role_last_used":true,"tags_all":true,"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[{}],"managed_policy_arns":[],"role_last_used":[],"tags_all":{}}}},{"address":"aws_s3_bucket.prefect-bucket","mode":"managed","type":"aws_s3_bucket","name":"prefect-bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"bucket-full-of-sunshine-prefect","force_destroy":false,"tags":null,"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"region":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags_all":true,"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags_all":{},"versioning":[],"website":[]}}},{"address":"aws_secretsmanager_secret.prefect_api_key","mode":"managed","type":"aws_secretsmanager_secret","name":"prefect_api_key","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"force_overwrite_replica_secret":false,"kms_key_id":null,"name":"prefect-api-key-deployment-agent-test","recovery_window_in_days":30,"tags":null},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"policy":true,"replica":true,"rotation_enabled":true,"rotation_lambda_arn":true,"rotation_rules":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"replica":[],"rotation_rules":[],"tags_all":{}}}},{"address":"aws_secretsmanager_secret_version.prefect_api_key_version","mode":"managed","type":"aws_secretsmanager_secret_version","name":"prefect_api_key_version","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"secret_binary":null,"secret_string":"tfs.txt"},"after_unknown":{"arn":true,"id":true,"secret_id":true,"version_id":true,"version_stages":true},"before_sensitive":false,"after_sensitive":{"secret_binary":true,"secret_string":true,"version_stages":[]}}},{"address":"aws_security_group.prefect_agent","mode":"managed","type":"aws_security_group","name":"prefect_agent","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"ECS Prefect Agent","name":"prefect-agent-sg-deployment-agent-test","revoke_rules_on_delete":false,"tags":null,"timeouts":null,"vpc_id":"vpc-00000000"},"after_unknown":{"arn":true,"egress":true,"id":true,"ingress":true,"name_prefix":true,"owner_id":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"egress":[],"ingress":[],"tags_all":{}}}},{"address":"aws_security_group_rule.https_outbound","mode":"managed","type":"aws_security_group_rule","name":"https_outbound","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":["0.0.0.0/0"],"description":"HTTPS outbound","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","self":false,"timeouts":null,"to_port":443,"type":"egress"},"after_unknown":{"cidr_blocks":[false],"id":true,"security_group_id":true,"security_group_rule_id":true,"source_security_group_id":true},"before_sensitive":false,"after_sensitive":{"cidr_blocks":[false]}}}],"output_changes":{"prefect_agent_cluster_name":{"actions":["create"],"before":null,"after":"prefect-agent-deployment-agent-test","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"prefect_agent_execution_role_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"prefect_agent_security_group":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"prefect_agent_service_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"prefect_agent_task_role_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.13.5","values":{"outputs":{"prefect_agent_cluster_name":{"sensitive":false,"value":"prefect-agent-deployment-agent-test","type":"string"}},"root_module":{"resources":[{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"US East (N. Virginia)","endpoint":"ec2.us-east-1.amazonaws.com","id":"us-east-1","name":"us-east-1"},"sensitive_values":{}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"~\u003e 4.0","expressions":{"access_key":{"constant_value":"mock"},"endpoints":[{"apigateway":{"constant_value":"http://localhost:4566"},"apigatewayv2":{"constant_value":"http://localhost:4566"},"cloudwatch":{"constant_value":"http://localhost:4566"},"cloudwatchevents":{"constant_value":"http://localhost:4566"},"dynamodb":{"constant_value":"http://localhost:4566"},"ec2":{"constant_value":"http://localhost:4566"},"ecr":{"constant_value":"http://localhost:4566"},"ecrpublic":{"constant_value":"http://localhost:4566"},"ecs":{"constant_value":"http://localhost:4566"},"efs":{"constant_value":"http://localhost:4566"},"iam":{"constant_value":"http://localhost:4566"},"kinesis":{"constant_value":"http://localhost:4566"},"kms":{"constant_value":"http://localhost:4566"},"lambda":{"constant_value":"http://localhost:4566"},"logs":{"constant_value":"http://localhost:4566"},"route53":{"constant_value":"http://localhost:4566"},"s3":{"constant_value":"http://localhost:4566"},"s3control":{"constant_value":"http://localhost:4566"},"secretsmanager":{"constant_value":"http://localhost:4566"},"sns":{"constant_value":"http://localhost:4566"},"sqs":{"constant_value":"http://localhost:4566"},"ssm":{"constant_value":"http://localhost:4566"},"sts":{"constant_value":"http://localhost:4566"}}],"region":{"constant_value":"us-east-1"},"s3_use_path_style":{"constant_value":true},"secret_key":{"constant_value":"mock"},"skip_credentials_validation":{"constant_value":true},"skip_metadata_api_check":{"constant_value":true},"skip_region_validation":{"constant_value":true},"skip_requesting_account_id":{"constant_value":true}}}},"root_module":{"outputs":{"prefect_agent_cluster_name":{"expression":{"references":["aws_ecs_cluster.prefect_agent_cluster.name","aws_ecs_cluster.prefect_agent_cluster"]}},"prefect_agent_execution_role_arn":{"expression":{"references":["aws_iam_role.prefect_agent_execution_role.arn","aws_iam_role.prefect_agent_execution_role"]}},"prefect_agent_security_group":{"expression":{"references":["aws_security_group.prefect_agent.id","aws_security_group.prefect_agent"]}},"prefect_agent_service_id":{"expression":{"references":["aws_ecs_service.prefect_agent_service.id","aws_ecs_service.prefect_agent_service"]}},"prefect_agent_task_role_arn":{"expression":{"references":["var.agent_task_role_arn","aws_iam_role.prefect_agent_task_role[0].arn","aws_iam_role.prefect_agent_task_role[0]","aws_iam_role.prefect_agent_task_role","var.agent_task_role_arn"]}}},"resources":[{"address":"aws_cloudwatch_log_group.prefect_agent_log_group","mode":"managed","type":"aws_cloudwatch_log_group","name":"prefect_agent_log_group","provider_config_key":"aws","expressions":{"name":{"references":["var.name"]},"retention_in_days":{"references":["var.agent_log_retention_in_days"]}},"schema_version":0},{"address":"aws_ecs_cluster.prefect_agent_cluster","mode":"managed","type":"aws_ecs_cluster","name":"prefect_agent_cluster","provider_config_key":"aws","expressions":{"name":{"references":["var.name"]}},"schema_version":0},{"address":"aws_ecs_cluster_capacity_providers.prefect_agent_cluster_capacity_providers","mode":"managed","type":"aws_ecs_cluster_capacity_providers","name":"prefect_agent_cluster_capacity_providers","provider_config_key":"aws","expressions":{"capacity_providers":{"constant_value":["FARGATE"]},"cluster_name":{"references":["aws_ecs_cluster.prefect_agent_cluster.name","aws_ecs_cluster.prefect_agent_cluster"]}},"schema_version":0},{"address":"aws_ecs_service.prefect_agent_service","mode":"managed","type":"aws_ecs_service","name":"prefect_agent_service","provider_config_key":"aws","expressions":{"cluster":{"references":["aws_ecs_cluster.prefect_agent_cluster.id","aws_ecs_cluster.prefect_agent_cluster"]},"desired_count":{"references":["var.agent_desired_count"]},"launch_type":{"constant_value":"FARGATE"},"name":{"references":["var.name"]},"network_configuration":[{"assign_public_ip":{"constant_value":true},"security_groups":{"references":["aws_security_group.prefect_agent.id","aws_security_group.prefect_agent"]},"subnets":{"references":["var.agent_subnets"]}}],"task_definition":{"references":["aws_ecs_task_definition.prefect_agent_task_definition.arn","aws_ecs_task_definition.prefect_agent_task_definition"]}},"schema_version":0},{"address":"aws_ecs_task_definition.prefect_agent_task_definition","mode":"managed","type":"aws_ecs_task_definition","name":"prefect_agent_task_definition","provider_config_key":"aws","expressions":{"container_definitions":{"references":["var.name","var.agent_image","var.agent_queue_name","var.agent_cpu","var.agent_memory","var.prefect_account_id","var.prefect_workspace_id","var.agent_extra_pip_packages","aws_secretsmanager_secret.prefect_api_key.arn","aws_secretsmanager_secret.prefect_api_key","aws_cloudwatch_log_group.prefect_agent_log_group.name","aws_cloudwatch_log_group.prefect_agent_log_group","data.aws_region.current.name","data.aws_region.current","var.name"]},"cpu":{"references":["var.agent_cpu"]},"execution_role_arn":{"references":["aws_iam_role.prefect_agent_execution_role.arn","aws_iam_role.prefect_agent_execution_role"]},"family":{"references":["var.name"]},"memory":{"references":["var.agent_memory"]},"network_mode":{"constant_value":"awsvpc"},"requires_compatibilities":{"constant_value":["FARGATE"]},"task_role_arn":{"references":["var.agent_task_role_arn","aws_iam_role.prefect_agent_task_role[0].arn","aws_iam_role.prefect_agent_task_role[0]","aws_iam_role.prefect_agent_task_role","var.agent_task_role_arn"]}},"schema_version":1},{"address":"aws_iam_role.prefect_agent_execution_role","mode":"managed","type":"aws_iam_role","name":"prefect_agent_execution_role","provider_config_key":"aws","expressions":{"assume_role_policy":{},"inline_policy":[{"name":{"references":["var.name"]},"policy":{"references":["aws_secretsmanager_secret.prefect_api_key.arn","aws_secretsmanager_secret.prefect_api_key"]}}],"managed_policy_arns":{"constant_value":["arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"]},"name":{"references":["var.name"]}},"schema_version":0},{"address":"aws_iam_role.prefect_agent_task_role","mode":"managed","type":"aws_iam_role","name":"prefect_agent_task_role","provider_config_key":"aws","expressions":{"assume_role_policy":{},"inline_policy":[{"name":{"references":["var.name"]},"policy":{}}],"name":{"references":["var.name"]}},"schema_version":0,"count_expression":{"references":["var.agent_task_role_arn"]}},{"address":"aws_s3_bucket.prefect-bucket","mode":"managed","type":"aws_s3_bucket","name":"prefect-bucket","provider_config_key":"aws","expressions":{"bucket":{"constant_value":"bucket-full-of-sunshine-prefect"}},"schema_version":0},{"address":"aws_secretsmanager_secret.prefect_api_key","mode":"managed","type":"aws_secretsmanager_secret","name":"prefect_api_key","provider_config_key":"aws","expressions":{"name":{"references":["var.name"]}},"schema_version":0},{"address":"aws_secretsmanager_secret_version.prefect_api_key_version","mode":"managed","type":"aws_secretsmanager_secret_version","name":"prefect_api_key_version","provider_config_key":"aws","expressions":{"secret_id":{"references":["aws_secretsmanager_secret.prefect_api_key.id","aws_secretsmanager_secret.prefect_api_key"]},"secret_string":{"references":["var.prefect_api_key"]}},"schema_version":0},{"address":"aws_security_group.prefect_agent","mode":"managed","type":"aws_security_group","name":"prefect_agent","provider_config_key":"aws","expressions":{"description":{"constant_value":"ECS Prefect Agent"},"name":{"references":["var.name"]},"vpc_id":{"references":["var.vpc_id"]}},"schema_version":1},{"address":"aws_security_group_rule.https_outbound","mode":"managed","type":"aws_security_group_rule","name":"https_outbound","provider_config_key":"aws","expressions":{"cidr_blocks":{"constant_value":["0.0.0.0/0"]},"description":{"constant_value":"HTTPS outbound"},"from_port":{"constant_value":443},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.prefect_agent.id","aws_security_group.prefect_agent"]},"to_port":{"constant_value":443},"type":{"constant_value":"egress"}},"schema_version":2},{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_config_key":"aws","schema_version":0}],"variables":{"agent_cpu":{"default":1024,"description":"CPU units to allocate to the agent"},"agent_desired_count":{"default":1,"description":"Number of agents to run"},"agent_extra_pip_packages":{"default":"prefect-aws s3fs","description":"Packages to install on the agent assuming image is based on prefecthq/prefect"},"agent_image":{"default":"prefecthq/prefect:2-python3.10","description":"Container image for the agent. This could be the name of an image in a public repo or an ECR ARN"},"agent_log_retention_in_days":{"default":30,"description":"Number of days to retain agent logs for"},"agent_memory":{"default":2048,"description":"Memory units to allocate to the agent"},"agent_queue_name":{"default":"test-queue","description":"Prefect queue that the agent should listen to"},"agent_subnets":{"description":"Subnets to place the agent in"},"agent_task_role_arn":{"default":null,"description":"Optional task role ARN to pass to the agent. If not defined, a task role will be created"},"name":{"default":"deployment-agent-test","description":"Unique name for this agent deployment"},"prefect_account_id":{"description":"Prefect cloud account ID"},"prefect_api_key":{"description":"Prefect cloud API key","sensitive":true},"prefect_workspace_id":{"description":"Prefect cloud workspace ID"},"vpc_id":{"description":"VPC ID in which to create all resources"}}}},"relevant_attributes":[{"resource":"aws_ecs_task_definition.prefect_agent_task_definition","attribute":["arn"]},{"resource":"aws_ecs_cluster.prefect_agent_cluster","attribute":["name"]},{"resource":"aws_secretsmanager_secret.prefect_api_key","attribute":["id"]},{"resource":"aws_ecs_cluster.prefect_agent_cluster","attribute":["id"]},{"resource":"aws_iam_role.prefect_agent_execution_role","attribute":["arn"]},{"resource":"aws_security_group.prefect_agent","attribute":["id"]},{"resource":"aws_ecs_service.prefect_agent_service","attribute":["id"]},{"resource":"data.aws_region.current","attribute":["name"]},{"resource":"aws_cloudwatch_log_group.prefect_agent_log_group","attribute":["name"]},{"resource":"aws_secretsmanager_secret.prefect_api_key","attribute":["arn"]},{"resource":"aws_iam_role.prefect_agent_task_role[0]","attribute":["arn"]}],"timestamp":"2026-01-25T14:09:21Z","applyable":true,"complete":true,"errored":false}
